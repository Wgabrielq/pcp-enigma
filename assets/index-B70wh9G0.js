var ss=Object.defineProperty;var ts=(s,a,c)=>a in s?ss(s,a,{enumerable:!0,configurable:!0,writable:!0,value:c}):s[a]=c;var Be=(s,a,c)=>ts(s,typeof a!="symbol"?a+"":a,c);import{r as f,a as as,R as ls}from"./vendor-wGySg1uH.js";import{u as Y,w as rs}from"./xlsx-DrgRuPKf.js";import{L as ns,a as is,C as cs,S as ds,P as Ie,T as qe,U as We,b as Ue,H as os,c as be,F as xs,d as ms,X as Te,e as Ve,A as je,G as hs,f as us,D as bs,g as Re,h as pe,i as ps,j as gs,k as Ce,l as fs,m as Ge,R as Ze,B as Le,n as js,o as fe,p as Ns,q as ie,r as Se,s as He,t as Je,u as vs,v as Ne,w as ys,x as ws,y as Cs,z as Ss,E as ks,I as Ps,J as Oe,K as Es,M as Ds,N as As,O as ze,Q as Is,V as Fe,W as Ke,Y as Ls,Z as Os,_ as zs,$ as Ms}from"./icons-CWOtsxXT.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const d of i.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function c(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=c(n);fetch(n.href,i)}})();var Qe={exports:{}},ke={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ts=f,Bs=Symbol.for("react.element"),Rs=Symbol.for("react.fragment"),Fs=Object.prototype.hasOwnProperty,Ks=Ts.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_s={key:!0,ref:!0,__self:!0,__source:!0};function Ye(s,a,c){var r,n={},i=null,d=null;c!==void 0&&(i=""+c),a.key!==void 0&&(i=""+a.key),a.ref!==void 0&&(d=a.ref);for(r in a)Fs.call(a,r)&&!_s.hasOwnProperty(r)&&(n[r]=a[r]);if(s&&s.defaultProps)for(r in a=s.defaultProps,a)n[r]===void 0&&(n[r]=a[r]);return{$$typeof:Bs,type:s,key:i,ref:d,props:n,_owner:Ks.current}}ke.Fragment=Rs;ke.jsx=Ye;ke.jsxs=Ye;Qe.exports=ke;var e=Qe.exports,Me={},_e=as;Me.createRoot=_e.createRoot,Me.hydrateRoot=_e.hydrateRoot;var E=(s=>(s.BOPP="BOPP",s.BOPP_MATE="BOPP MATE",s.BOPP_METALIZADO="BOPP METALIZADO",s.BOPP_DT="BOPP DT",s.BOPP_PERLADO="BOPP PERLADO",s.BOPP_BLANCO="BOPP BLANCO",s.PET="PET",s.PET_DT="PET DT",s.PET_PVDC="PET PVDC",s.PET_METALIZADO="PET METALIZADO",s.PE="PE",s.PE_BCO="PE BCO",s.CPP="CPP",s.BOPA="BOPA",s.PAPER="PAPEL",s.FOIL="ALUMINIO",s))(E||{});const de={BOPP:.91,"BOPP MATE":.91,"BOPP METALIZADO":.91,"BOPP DT":.91,"BOPP PERLADO":.7,"BOPP BLANCO":.95,PET:1.4,"PET DT":1.4,"PET PVDC":1.45,"PET METALIZADO":1.4,PE:.92,"PE BCO":1,CPP:.9,BOPA:1.15,PAPEL:1,ALUMINIO:2.7};var re=(s=>(s.UNITS="Unidades",s.KILOS="Kilos",s.METERS="Metros",s))(re||{});const $e=["POLO FILMS","VITOPEL","TERPHANE","MULTIPACK","RBS"];class $s{constructor(a){Be(this,"config");this.config=a}async soapRequest(a,c){const r=`
      <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:zet="ZetaSoftware">
         <soapenv:Header/>
         <soapenv:Body>
            ${c}
         </soapenv:Body>
      </soapenv:Envelope>
    `;try{const n=await fetch(this.config.apiUrl,{method:"POST",headers:{"Content-Type":"text/xml; charset=utf-8",SOAPAction:`ZetaSoftwareaction/${a}`},body:r.trim()});if(!n.ok)throw new Error(`Error HTTP Zeta SOAP: ${n.status} ${n.statusText}`);const i=await n.text(),j=new DOMParser().parseFromString(i,"text/xml"),g=j.getElementsByTagName("soapenv:Fault")[0];if(g)throw new Error("SOAP Fault: "+g.textContent);return j}catch(n){throw console.error("Error en SOAP Request:",n),n}}async getClients(){return console.log("Zeta Sync: Omitiendo Clientes (WSDL limitado a Stock)"),[]}async getSuppliers(){return console.log("Zeta Sync: Omitiendo Proveedores (WSDL limitado a Stock)"),[]}async getMaterials(){console.log("Iniciando Sincronización SOAP StockActualV3...");const a=`
      <zet:SOAPStockActualV3.QUERY>
         <zet:Queryin>
            <zet:Connection>
               <zet:DesarrolladorCodigo>${this.config.desarrolladorCodigo}</zet:DesarrolladorCodigo>
               <zet:DesarrolladorClave>${this.config.desarrolladorClave}</zet:DesarrolladorClave>
               <zet:EmpresaCodigo>${this.config.empresaCodigo}</zet:EmpresaCodigo>
               <zet:EmpresaClave>${this.config.empresaClave}</zet:EmpresaClave>
               <zet:UsuarioCodigo>${this.config.usuarioCodigo}</zet:UsuarioCodigo>
               <zet:UsuarioClave>${this.config.usuarioClave}</zet:UsuarioClave>
               <zet:RolCodigo>${this.config.rolCodigo}</zet:RolCodigo>
            </zet:Connection>
            <zet:Data>
               <zet:Page>1</zet:Page>
               <zet:Filters>
                   <zet:VencimientoDesde xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                   <zet:VencimientoHasta xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                   <zet:DepositoCodigo>0</zet:DepositoCodigo>
                   <zet:LocalCodigo>0</zet:LocalCodigo>
                   <zet:CantidadDesde>0</zet:CantidadDesde>
                   <zet:CantidadHasta>999999</zet:CantidadHasta>
               </zet:Filters>
            </zet:Data>
         </zet:Queryin>
      </zet:SOAPStockActualV3.QUERY>
    `,n=(await this.soapRequest("apis.ASOAPSTOCKACTUALV3.QUERY",a)).getElementsByTagName("Item"),i=[];console.log(`Zeta SOAP: Recibidos ${n.length} items brutos.`);for(let d=0;d<n.length;d++){const j=n[d],g=p=>{var o;return((o=j.getElementsByTagName(p)[0])==null?void 0:o.textContent)||""},t=g("ArticuloCodigo"),y=g("ArticuloNombre"),u=g("StockActual"),C=parseFloat(u)||0,b=y.toUpperCase();if($e.some(p=>b.includes(p))){const p=y.toUpperCase();let o=E.BOPP,S=0,L=0;p.includes("PET")?o=E.PET:p.includes("PEBD")||p.includes("POLIETILENO")?o=E.PE:p.includes("BOPA")||p.includes("NYLON")?o=E.BOPA:p.includes("CPP")?o=E.CPP:p.includes("PAPEL")?o=E.PAPER:p.includes("MATE")?o=E.BOPP_MATE:p.includes("METAL")&&(o=E.BOPP_METALIZADO);const O=p.match(/(\d+([.,]\d+)?)\s*(MIC|MC|MY|MICRAS)/);O&&(S=parseFloat(O[1].replace(",",".")));const _=p.match(/(\d+)\s*(MM|CM)/);if(_){let w=parseInt(_[1]);_[2]==="CM"&&(w*=10),L=w}let N="Zeta Import";const x=$e.find(w=>p.includes(w));x&&(N=x),i.push({id:`zeta-m-${t}`,internalCode:t,name:y,supplier:N,type:o,thickness:S||20,density:de[o]||.91,width:L||0,currentStockKg:C,externalId:t})}}return console.log(`Zeta SOAP: ${i.length} materiales procesados tras filtro.`),i}}const qs=[],Ws=[],Us=[],Vs=[],ve={fixedStartupMeters:500,reprintMeters:300,lamination1Meters:300,lamination2Meters:300,variableScrapPercent:.05,materialDensities:de,zetaConfig:{enabled:!1,apiUrl:"https://api.zetasoftware.com/z.apis.asoapstockactualv3",desarrolladorCodigo:"",desarrolladorClave:"",empresaCodigo:"",empresaClave:"",usuarioCodigo:"",usuarioClave:"",rolCodigo:"0"}},oe=(s,a)=>{try{const c=localStorage.getItem(s);if(!c)return a;if(s==="flexo_config"){const r=JSON.parse(c),n=a,i={...n.zetaConfig||{},...r.zetaConfig||{}},d={...n.materialDensities||{},...r.materialDensities||{}};return{...n,...r,zetaConfig:i,materialDensities:d}}return JSON.parse(c)}catch(c){return console.error(`Error loading ${s}`,c),a}},H=(s,a)=>{try{localStorage.setItem(s,JSON.stringify(a))}catch(c){console.error(`Error saving ${s}`,c)}};let ye=null;const we=s=>s.map(a=>{const c=a.layer1&&a.layer1.type?a.layer1:{type:E.BOPP,thickness:20,width:(a.webWidth||0)+20},r=a.layer2&&a.layer2.type?a.layer2:void 0,n=a.layer3&&a.layer3.type?a.layer3:void 0;return{...a,layer1:c,layer2:r,layer3:n}});let G=oe("flexo_clients",qs),J=oe("flexo_suppliers",Ws),B=oe("flexo_materials",Us),Q=we(oe("flexo_products",Vs)),X=oe("flexo_config",ve),q=oe("flexo_orders",[]);const K=async()=>{if(H("flexo_clients",G),H("flexo_suppliers",J),H("flexo_materials",B),H("flexo_products",Q),H("flexo_orders",q),H("flexo_config",X),ye)try{const s={clients:G,suppliers:J,materials:B,products:Q,orders:q,config:X,lastModified:new Date().toISOString()},a=await ye.createWritable();await a.write(JSON.stringify(s,null,2)),await a.close(),console.log("Auto-saved to Drive/Disk")}catch(s){console.error("Failed to auto-save to disk:",s)}},Gs=async()=>{if(typeof window.showOpenFilePicker!="function")return alert(`Tu navegador no soporta la sincronización automática (File System API). Esta función requiere Chrome, Edge o Opera en escritorio.

Para móviles o navegadores no soportados, usa la importación manual en Configuración.`),!1;try{const[s]=await window.showOpenFilePicker({types:[{description:"JSON Database",accept:{"application/json":[".json"]}}],multiple:!1});ye=s;const c=await(await ye.getFile()).text(),r=JSON.parse(c);return!r.clients||!r.materials?(alert("El archivo seleccionado no es una base de datos válida de PCP Enigma."),!1):(G=r.clients||[],J=r.suppliers||[],B=r.materials||[],Q=we(r.products||[]),q=r.orders||[],X={...ve,...r.config||{}},K(),!0)}catch(s){return s.name==="AbortError"?!1:s.name==="SecurityError"||s.message&&s.message.includes("Cross origin")?(alert(`⚠️ Restricción de Entorno Detectada

Estás ejecutando la App en un entorno restringido (iframe) que bloquea el acceso directo al disco duro.

SOLUCIÓN:
1. Ejecuta el proyecto localmente o despliégalo en GitHub Pages.
2. Mientras tanto, usa la opción 'Configuración > Importar/Restaurar' para cargar tus datos manualmente.`),!1):(console.error("Error connecting DB:",s),alert("Error al conectar: "+s.message),!1)}},Zs=async()=>{if(!X.zetaConfig||!X.zetaConfig.enabled)return{success:!1,message:"Integración Zeta no configurada o deshabilitada."};const s=new $s(X.zetaConfig);let a={clients:0,suppliers:0,materials:0};try{return(await s.getMaterials()).forEach(r=>{const n=B.findIndex(i=>i.externalId&&i.externalId===r.externalId||i.internalCode===r.internalCode);if(n>=0){const i=B[n];B[n]={...i,currentStockKg:r.currentStockKg,externalId:r.externalId,thickness:r.thickness>0?r.thickness:i.thickness,width:r.width>0?r.width:i.width,type:r.type!==E.BOPP?r.type:i.type}}else B.push(r),a.materials++}),K(),{success:!0,message:`Sincronización Exitosa:
Inventario actualizado.
+${a.materials} Artículos nuevos detectados.`}}catch(c){return{success:!1,message:"Error de conexión con Zeta SOAP: "+c.message}}},ce=()=>[...G],he=()=>[...J],ge=()=>[...B],ue=()=>[...Q],xe=()=>({...X}),ne=()=>[...q].sort((s,a)=>(s.queueIndex||0)-(a.queueIndex||0)),Hs=s=>{const a=Q.findIndex(c=>c.id===s.id);a>=0?Q[a]=s:Q.push(s),K()},Js=s=>{Q=Q.filter(a=>a.id!==s),K()},Qs=s=>{const a=G.findIndex(c=>c.id===s.id);a>=0?G[a]=s:G.push(s),K()},Ys=s=>{G=G.filter(a=>a.id!==s),K()},Xs=s=>{const a=J.findIndex(c=>c.id===s.id);a>=0?J[a]=s:J.push(s),K()},et=s=>{J=J.filter(a=>a.id!==s),K()},st=s=>{const a=B.findIndex(c=>c.id===s.id);a>=0?B[a]=s:B.push(s),K()},tt=s=>{B=B.filter(a=>a.id!==s),K()},at=s=>{if(s.queueIndex===void 0){const c=q.reduce((r,n)=>Math.max(r,n.queueIndex||0),0);s.queueIndex=c+1}const a=q.findIndex(c=>c.id===s.id);a>=0?q[a]=s:q.push(s),K()},lt=(s,a)=>{const c=q.find(r=>r.id===s);c&&(c.status=a,K())},rt=(s,a)=>{const c=q.find(r=>r.id===s);c&&(c.currentStage=a,K())},nt=s=>{s.forEach((a,c)=>{const r=q.find(n=>n.id===a.id);r&&(r.queueIndex=c)}),K()},it=s=>{q=q.filter(a=>a.id!==s),K()},ct=(s,a)=>{const c=B.findIndex(r=>r.id===s);return c>=0?(B[c].currentStockKg=Math.max(0,B[c].currentStockKg-a),K(),!0):!1},dt=s=>{X={...X,...s},K()},ot=()=>{const s=Y.book_new(),a=q.map(g=>({Codigo:g.orderCode,Fecha:g.date,Cliente:g.clientName,Producto:g.productName,Estado:g.status,"Etapa Actual":g.currentStage||"Inicio",Pedido:`${g.quantityRequested} ${g.unit}`,"Metros Brutos":g.calculationSnapshot.grossLinearMeters,"Peso Total (Kg)":g.calculationSnapshot.totalWeightKg,Etapas:g.requiredStages.join(", ")})),c=Y.json_to_sheet(a);Y.book_append_sheet(s,c,"Historial Producción");const r=Y.json_to_sheet(G);Y.book_append_sheet(s,r,"Clientes");const n=Y.json_to_sheet(J);Y.book_append_sheet(s,n,"Proveedores");const i=Y.json_to_sheet(B);Y.book_append_sheet(s,i,"Inventario");const d=Q.map(g=>{var y,u,C;const t=((y=G.find(b=>b.id===g.clientId))==null?void 0:y.name)||"N/A";return{SKU:g.sku,Producto:g.name,Cliente:t,Formato:g.format,"Ancho Impresión":g.webWidth,"Capa 1 Tipo":g.layer1.type,"Capa 1 Mic":g.layer1.thickness,"Capa 2 Tipo":((u=g.layer2)==null?void 0:u.type)||"-","Capa 3 Tipo":((C=g.layer3)==null?void 0:C.type)||"-","% Merma Ficha":g.specificScrapPercent?g.specificScrapPercent*100:"Default"}}),j=Y.json_to_sheet(d);Y.book_append_sheet(s,j,"Fichas Técnicas"),rs(s,"PCP_Enigma_DB.xlsx")},xt=()=>{const s={clients:G,suppliers:J,materials:B,products:Q,orders:q,config:X,exportedAt:new Date().toISOString()},a="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(s,null,2)),c=document.createElement("a");c.setAttribute("href",a),c.setAttribute("download",`pcp_backup_${new Date().toISOString().split("T")[0]}.json`),document.body.appendChild(c),c.click(),c.remove()},mt=async s=>new Promise((a,c)=>{const r=new FileReader;r.onload=n=>{var i;try{const d=JSON.parse((i=n.target)==null?void 0:i.result);if(!d.clients||!d.materials||!d.products){alert("Archivo inválido: Estructura de datos incorrecta."),a(!1);return}confirm("ADVERTENCIA: Esto borrará los datos actuales y cargará los del archivo. ¿Continuar?")?(H("flexo_clients",d.clients),H("flexo_suppliers",d.suppliers||[]),H("flexo_materials",d.materials),H("flexo_products",we(d.products)),H("flexo_orders",d.orders),H("flexo_config",{...ve,...d.config||{}}),G=d.clients,J=d.suppliers||[],B=d.materials,Q=we(d.products),q=d.orders,X={...ve,...d.config||{}},a(!0)):a(!1)}catch(d){console.error(d),alert("Error leyendo el archivo JSON."),a(!1)}},r.readAsText(s)}),ht=({activeTab:s,setActiveTab:a})=>{const[c,r]=f.useState(!1),n=async()=>{const d=await Gs();r(d),d&&alert("Conectado con éxito. Los cambios se guardarán automáticamente en el archivo.")},i=[{id:"dashboard",label:"Dashboard",icon:ns},{id:"queue",label:"Fila de Producción",icon:is},{id:"calculator",label:"Calculadora Prod.",icon:cs},{id:"products",label:"Fichas Técnicas",icon:ds},{id:"materials",label:"Inventario",icon:Ie},{id:"suppliers",label:"Proveedores",icon:qe},{id:"clients",label:"Clientes",icon:We}];return e.jsxs("aside",{className:"w-64 bg-slate-900 text-white h-screen fixed left-0 top-0 flex flex-col shadow-xl z-50",children:[e.jsxs("div",{className:"p-6 border-b border-slate-700",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight text-brand-500",children:"PCP"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Enigma v2.1"})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:i.map(d=>{const j=d.icon;return e.jsxs("button",{onClick:()=>a(d.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors duration-200 ${s===d.id?"bg-brand-600 text-white shadow-lg":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[e.jsx(j,{size:20}),e.jsx("span",{className:"font-medium",children:d.label})]},d.id)})}),e.jsxs("div",{className:"p-4 bg-slate-800 mx-4 mb-4 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Estado Conexión"}),c?e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 shadow-[0_0_5px_#22c55e]"}):e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-500"})]}),e.jsx("button",{onClick:n,className:`w-full text-xs font-bold py-2 px-2 rounded flex items-center justify-center transition-all ${c?"bg-green-900/30 text-green-400 border border-green-800 cursor-default":"bg-brand-700 hover:bg-brand-600 text-white shadow-md"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx(Ue,{size:12,className:"mr-1.5"})," BD Sincronizada"]}):e.jsxs(e.Fragment,{children:[e.jsx(os,{size:12,className:"mr-1.5"})," Conectar BD"]})})]}),e.jsx("div",{className:"p-4 border-t border-slate-700",children:e.jsxs("button",{onClick:()=>a("settings"),className:`flex items-center space-x-3 px-4 py-2 w-full transition-colors ${s==="settings"?"text-brand-400 font-bold":"text-slate-400 hover:text-white"}`,children:[e.jsx(be,{size:18}),e.jsx("span",{className:"text-sm",children:"Configuración"})]})})]})},te=(s,a,c)=>{var j;const n=(c.width&&c.width>0?c.width:s+20)/1e3,d=((j=xe().materialDensities)==null?void 0:j[c.type])||de[c.type]||.91;return n*a*c.thickness*d/1e3},ut=(s,a)=>{var i;const c=a.width/1e3,r=xe(),n=a.density||((i=r.materialDensities)==null?void 0:i[a.type])||de[a.type]||.91;return c*s*a.thickness*n/1e3},bt=(s,a)=>{var d;const c=a.width/1e3,r=xe(),n=a.density||((d=r.materialDensities)==null?void 0:d[a.type])||de[a.type]||.91,i=c*a.thickness*n;return i===0?0:s*1e3/i},pt=(s,a,c,r,n,i)=>{const d=xe(),j=r.specificScrapPercent!==void 0?r.specificScrapPercent:d.variableScrapPercent,g=r.tracks>0?r.tracks:1;let t=0;if(c===re.METERS)t=s/g;else if(c===re.UNITS)t=s*r.cutoff/(g*1e3);else if(c===re.KILOS){let le=te(r.webWidth,1,r.layer1);r.layer2&&(le+=te(r.webWidth,1,r.layer2)),r.layer3&&(le+=te(r.webWidth,1,r.layer3));const z=r.webWidth/1e3,me=z*1*r.inkCoverage/1e3;let ee=1;r.layer2&&ee++,r.layer3&&ee++;const Pe=ee>1?(ee-1)*(z*1*r.adhesiveCoverage)/1e3:0,Ee=le+me+Pe;t=s/Ee}const y=(i==null?void 0:i.startup)!==void 0?i.startup:d.fixedStartupMeters,u=(r.layer1.type===E.BOPP_DT||r.layer1.type===E.PET_DT)&&d.reprintMeters||0,C=(i==null?void 0:i.reprint)!==void 0?i.reprint:u,b=r.layer2&&d.lamination1Meters||0,v=r.layer3&&d.lamination2Meters||0,p=(i==null?void 0:i.lamination)!==void 0?i.lamination:b+v,o=Math.ceil(t*j),S=(i==null?void 0:i.variable)!==void 0?i.variable:o,L=y+C+p+S,O=Math.ceil(t+L),_=t*(a/100),N=Math.ceil(O+_),x=te(r.webWidth,O,r.layer1),w=r.layer2?te(r.webWidth,O,r.layer2):0,U=r.layer3?te(r.webWidth,O,r.layer3):0,ae=te(r.webWidth,N,r.layer1),l=r.layer2?te(r.webWidth,N,r.layer2):0,$=r.layer3?te(r.webWidth,N,r.layer3):0,h=le=>{const z=r.webWidth/1e3*le,me=z*r.inkCoverage/1e3;let ee=0;return r.layer2&&(ee+=z*r.adhesiveCoverage/1e3),r.layer3&&(ee+=z*r.adhesiveCoverage/1e3),{ink:me,adhesive:ee}},R=h(O),Z=h(N);return{requiredLinearMeters:Math.ceil(t),grossLinearMeters:O,maxLinearMetersWithTolerance:N,scrapMeters:L,scrapBreakdown:{startup:y,reprint:C,lamination:p,variable:S},layer1Kg:Number(x.toFixed(2)),layer2Kg:Number(w.toFixed(2)),layer3Kg:Number(U.toFixed(2)),inkKg:Number(R.ink.toFixed(2)),adhesiveKg:Number(R.adhesive.toFixed(2)),maxLayer1Kg:Number(ae.toFixed(2)),maxLayer2Kg:Number(l.toFixed(2)),maxLayer3Kg:Number($.toFixed(2)),maxInkKg:Number(Z.ink.toFixed(2)),maxAdhesiveKg:Number(Z.adhesive.toFixed(2)),totalWeightKg:Number((x+w+U+R.ink+R.adhesive).toFixed(2))}},gt=()=>{const s=ce(),a=ue(),c=ge(),[r,n]=f.useState(""),[i,d]=f.useState(""),[j,g]=f.useState(0),[t,y]=f.useState(10),[u,C]=f.useState(!1),[b,v]=f.useState({success:!1}),[p,o]=f.useState(re.UNITS),[S,L]=f.useState(void 0),[O,_]=f.useState(!1),[N,x]=f.useState({startup:0,reprint:0,lamination:0,variable:0}),[w,U]=f.useState({layer1:[],layer2:[],layer3:[]}),ae=f.useMemo(()=>a.filter(m=>m.clientId===r),[r,a]),l=f.useMemo(()=>a.find(m=>m.id===i),[i,a]);f.useEffect(()=>{U({layer1:[],layer2:[],layer3:[]}),C(!1),L(void 0)},[i]);const $=(m,A)=>{const T=m.width||A;return c.filter(M=>M.type===m.type&&M.width>=T&&M.currentStockKg>0).map(M=>{const k=Math.abs(M.thickness-m.thickness),F=M.width-T,V=k/m.thickness,P=k===0,W=[];P||(W.push(`Espesor difiere en ${k}μ`),V>.2&&W.push("¡FUERA DE TOLERANCIA DE ESPESOR!")),F>0&&W.push(`+${F}mm de ancho`);let se=0;return P||(se+=1e3+k*100),se+=F,V>.3&&(se+=1e4),{material:M,isExactThickness:P,thicknessDiff:k,widthDiff:F,score:se,notes:W}}).sort((M,k)=>M.score-k.score)};f.useEffect(()=>{if(l){const m=(A,T)=>{if(!T)return;const D=$(T,l.webWidth);D.length>0&&w[A].length===0&&U(I=>({...I,[A]:[D[0].material.id]}))};m("layer1",l.layer1),m("layer2",l.layer2),m("layer3",l.layer3)}},[l,j]);let h=null,R=null;if(l&&j>0)try{h=pt(j,t,p,l,c,S)}catch(m){R=m.message}const Z=(m,A)=>{const T=w[m]||[],D=[];let I=A,M=0;for(const k of T){const F=c.find(se=>se.id===k);if(!F)continue;const V=bt(F.currentStockKg,F),P=Math.min(I,V),W=ut(P,F);D.push({material:F,allocatedMeters:P,allocatedKg:W,isPartial:P<I&&P>0,isFullCoverage:P>=I}),I-=P,M+=W,I<=.01&&(I=0)}return{breakdown:D,remainingMeters:I,totalRealKg:M,isStockSufficient:I<=.1}},z=(()=>{const m={breakdown:[],remainingMeters:0,totalRealKg:0,isStockSufficient:!0};if(!h)return{layer1:!1,layer2:!0,layer3:!0,l1Data:m,l2Data:m,l3Data:m};const A=u?h.maxLinearMetersWithTolerance:h.grossLinearMeters,T=Z("layer1",A),D=l!=null&&l.layer2?Z("layer2",A):m,I=l!=null&&l.layer3?Z("layer3",A):m;return{layer1:T.isStockSufficient,layer2:D.isStockSufficient,layer3:I.isStockSufficient,l1Data:T,l2Data:D,l3Data:I}})(),me=()=>{h&&(x({...h.scrapBreakdown}),_(!0))},ee=()=>{L(N),_(!1)},Pe=(m,A)=>{U(T=>{const D=T[m]||[];return D.includes(A)?{...T,[m]:D.filter(I=>I!==A)}:{...T,[m]:[...D,A]}})},Ee=()=>{var k;if(!h||!l)return;if(!z.layer1){alert("Falta stock en Capa 1. Seleccione más bobinas.");return}if(!z.layer2){alert("Falta stock en Capa 2. Seleccione más bobinas.");return}if(!z.layer3){alert("Falta stock en Capa 3. Seleccione más bobinas.");return}const m=[],A=new Set,T=(F,V)=>{F.breakdown.forEach((P,W)=>{P.allocatedKg>0&&(ct(P.material.id,P.allocatedKg),A.add(P.material.name),m.push({layer:V+(W>0?` (Bobina ${W+1})`:""),materialName:P.material.name,internalCode:P.material.internalCode,width:P.material.width,requiredKg:Number(P.allocatedKg.toFixed(2)),isSubstitute:W>0,originalMaterialId:W>0?F.breakdown[0].material.id:void 0}))})};T(z.l1Data,"Capa 1 (Imp)"),z.l2Data&&T(z.l2Data,"Capa 2 (Lam)"),z.l3Data&&T(z.l3Data,"Capa 3 (Sell)");const D=["Impresión"];(l.layer1.type===E.BOPP_DT||l.layer1.type===E.PET_DT)&&D.push("Reimpresión"),l.layer2&&D.push("Laminación"),l.layer3&&D.push("Trilaminado"),D.push("Refilado"),l.format==="BOLSA"&&D.push("Confección (Bolsera)");const I=`OP-${1e3+ne().length+1}`,M={id:`ord-${Date.now()}`,orderCode:I,productId:l.id,productName:l.name,clientId:r,clientName:((k=s.find(F=>F.id===r))==null?void 0:k.name)||"Desconocido",date:new Date().toISOString().split("T")[0],quantityRequested:j,unit:p,tolerancePercent:t,calculationSnapshot:h,technicalDetails:{format:l.format,webWidth:l.webWidth,cylinder:l.cylinder,cutoff:l.cutoff,tracks:l.tracks,layers:Array.from(A),windingDirection:l.windingDirection},materialRequirements:m,requiredStages:D,status:"Pendiente",currentStage:void 0};at(M),v({success:!0,code:I}),setTimeout(()=>{v({success:!1}),g(0),L(void 0)},4e3)},De=({layerKey:m,spec:A,theoreticalKg:T,metersRequired:D})=>{if(!l)return null;const I=$(A,l.webWidth),M=Z(m,D);return e.jsxs("div",{className:"mb-6 bg-white border border-slate-200 rounded-lg p-4 shadow-sm animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 uppercase text-sm",children:m==="layer1"?"Capa 1 (Impresión)":m==="layer2"?"Capa 2 (Laminación)":"Capa 3 (Sellante)"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Req: ",A.type," ",A.thickness,"μ | Ancho Ideal: ",A.width||l.webWidth,"mm"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`text-xl font-bold ${M.totalRealKg>T*1.05?"text-amber-600":"text-slate-800"}`,children:[M.totalRealKg.toLocaleString(void 0,{maximumFractionDigits:1})," Kg"]}),e.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:"(Real Asignado)"})]})]}),e.jsxs("div",{className:"space-y-2 max-h-72 overflow-y-auto pr-1",children:[I.length===0&&e.jsx("p",{className:"text-xs text-red-500 italic",children:"No hay inventario compatible para este tipo."}),I.map((k,F)=>{const V=w[m].includes(k.material.id),P=M.breakdown.find(es=>es.material.id===k.material.id),W=P?P.allocatedKg:0,se=P?P.allocatedMeters/D*100:0;return e.jsxs("div",{onClick:()=>Pe(m,k.material.id),className:`p-2 rounded border cursor-pointer transition-all flex justify-between items-center relative overflow-hidden
                                ${V?"bg-emerald-50 border-emerald-500 ring-1 ring-emerald-500 shadow-sm":"bg-slate-50 border-slate-200 hover:border-brand-300"}`,children:[V&&P&&e.jsx("div",{className:"absolute left-0 bottom-0 h-1 bg-emerald-400 opacity-50",style:{width:`${se}%`}}),e.jsxs("div",{className:"flex-1 z-10",children:[e.jsxs("div",{className:"font-bold text-sm text-slate-800 flex items-center",children:[F===0&&!V&&e.jsx(ps,{size:12,className:"text-amber-500 mr-1"}),k.material.name,e.jsxs("span",{className:"ml-2 font-mono text-xs text-slate-500",children:["[",k.material.internalCode,"]"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[e.jsxs("div",{className:"text-xs text-slate-600 space-x-2 flex items-center",children:[e.jsxs("span",{className:"bg-slate-200 px-1 rounded",children:[k.material.width,"mm"]}),e.jsxs("span",{className:"bg-slate-200 px-1 rounded",children:[k.material.thickness,"μ"]})]}),e.jsx("div",{className:"text-xs text-right",children:e.jsxs("div",{className:k.material.currentStockKg<100?"text-red-500 font-bold":"text-emerald-600 font-bold",children:["Stock: ",k.material.currentStockKg," Kg"]})})]}),V&&e.jsxs("div",{className:"mt-2 pt-1 border-t border-emerald-200 flex justify-between items-center text-xs font-bold text-emerald-800",children:[e.jsxs("span",{children:["Aportará: ",W.toFixed(1)," Kg"]}),e.jsxs("span",{children:[se.toFixed(0),"% del pedido"]})]}),k.notes.length>0&&!V&&e.jsx("div",{className:"text-[10px] text-amber-600 font-bold mt-1 border-t border-slate-200 pt-1",children:k.notes.join(" | ")})]}),e.jsx("div",{className:"ml-3 z-10 flex flex-col items-center",children:V?e.jsx(Ue,{size:22,className:"text-emerald-600 fill-emerald-50"}):e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-300"})})]},k.material.id)})]}),!M.isStockSufficient&&e.jsxs("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded text-xs flex items-center justify-between animate-pulse",children:[e.jsxs("span",{className:"font-bold text-red-700 flex items-center",children:[e.jsx(gs,{size:14,className:"mr-1"}),"Faltan cubrir: ",M.remainingMeters.toFixed(0)," metros"]}),e.jsx("span",{className:"text-red-600",children:"Seleccione otra bobina de la lista"})]}),M.isStockSufficient&&w[m].length>0&&e.jsxs("div",{className:"mt-2 text-xs text-emerald-700 font-bold flex items-center justify-end",children:[e.jsx(Re,{size:14,className:"mr-1"})," Cobertura Completa"]})]})};return b.success?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-12 text-center animate-fade-in",children:[e.jsx("div",{className:"bg-green-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(xs,{size:40,className:"text-green-600"})}),e.jsxs("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:["¡Orden ",b.code," Generada!"]}),e.jsx("p",{className:"text-green-700 mb-4",children:"Se ha creado la hoja de ruta, guardado el historial y descontado el material."}),e.jsx("button",{onClick:()=>v({success:!1}),className:"mt-6 text-green-800 underline font-bold",children:"Volver a calcular"})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in relative",children:[O&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm border border-slate-200 animate-scale-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsxs("h3",{className:"font-bold text-slate-800 flex items-center",children:[e.jsx(ms,{size:18,className:"mr-2 text-brand-600"})," Ajuste Manual de Mermas"]}),e.jsx("button",{onClick:()=>_(!1),className:"text-slate-400 hover:text-slate-600",children:e.jsx(Te,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Ajuste Impresión (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none font-bold text-slate-800",value:N.startup,onChange:m=>x({...N,startup:Number(m.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Reimpresión (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-purple-500 outline-none font-bold text-slate-800",value:N.reprint,onChange:m=>x({...N,reprint:Number(m.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Laminación (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none font-bold text-slate-800",value:N.lamination,onChange:m=>x({...N,lamination:Number(m.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Variable (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-amber-500 outline-none font-bold text-slate-800",value:N.variable,onChange:m=>x({...N,variable:Number(m.target.value)})})]})]}),e.jsx("button",{onClick:ee,className:"w-full mt-6 bg-brand-600 text-white py-2 rounded-lg font-bold hover:bg-brand-700",children:"Aplicar Cambios"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e.jsx(Ve,{className:"mr-2 text-brand-600"}),"Calculadora de Producción"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Cliente"}),e.jsxs("select",{className:"w-full rounded-lg border-slate-300 border p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none",value:r,onChange:m=>{n(m.target.value),d("")},children:[e.jsx("option",{value:"",children:"Seleccionar..."}),s.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Producto (SKU)"}),e.jsxs("select",{className:"w-full rounded-lg border-slate-300 border p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none",value:i,onChange:m=>d(m.target.value),disabled:!r,children:[e.jsx("option",{value:"",children:"Seleccionar Ficha..."}),ae.map(m=>e.jsxs("option",{value:m.id,children:[m.sku," - ",m.name," (",m.format,")"]},m.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Cantidad Pedida"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"number",className:"w-full rounded-l-lg border-slate-300 border-y border-l p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none",value:j||"",onChange:m=>g(Number(m.target.value)),placeholder:"0"}),e.jsxs("select",{className:"bg-slate-100 rounded-r-lg border-slate-300 border p-2.5 focus:outline-none text-sm",value:p,onChange:m=>o(m.target.value),children:[e.jsx("option",{value:re.UNITS,children:"Ud."}),e.jsx("option",{value:re.KILOS,children:"Kg"}),e.jsx("option",{value:re.METERS,children:"m"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Tolerancia (+)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",className:"w-full rounded-lg border-slate-300 border p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none pr-8",value:t,onChange:m=>y(Number(m.target.value))}),e.jsx("span",{className:"absolute right-3 top-2.5 text-slate-400 font-bold",children:"%"})]})]})]}),R&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 text-red-700 rounded-lg flex items-center text-sm font-medium",children:[e.jsx(je,{className:"mr-2",size:18})," ",R]})]}),h&&l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-slate-900 text-white rounded-xl shadow-lg p-6",children:[e.jsxs("h3",{className:"text-sm font-bold uppercase text-slate-400 mb-4 flex items-center",children:[e.jsx(hs,{size:16,className:"mr-2"})," Metros a Producir (Bruto)"]}),e.jsxs("div",{className:"text-4xl font-bold mb-2 text-brand-400",children:[h.grossLinearMeters.toLocaleString()," m"]}),e.jsxs("div",{className:"mb-4 group cursor-pointer p-2 rounded-lg hover:bg-slate-800 transition-all hover:scale-[1.02] border border-transparent hover:border-slate-600 relative",onClick:me,title:"Click para editar metros de merma manualmente",children:[e.jsx("div",{className:"absolute top-2 right-2 text-slate-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(us,{size:14})}),e.jsxs("div",{className:"flex h-2 rounded-full overflow-hidden mb-2 bg-slate-700",children:[e.jsx("div",{style:{width:`${h.scrapBreakdown.startup/h.grossLinearMeters*100}%`},className:"bg-slate-400",title:"Ajuste Impresión"}),e.jsx("div",{style:{width:`${h.scrapBreakdown.reprint/h.grossLinearMeters*100}%`},className:"bg-purple-500",title:"Reprint"}),e.jsx("div",{style:{width:`${h.scrapBreakdown.lamination/h.grossLinearMeters*100}%`},className:"bg-blue-500",title:"Laminación"}),e.jsx("div",{style:{width:`${h.scrapBreakdown.variable/h.grossLinearMeters*100}%`},className:"bg-amber-500",title:"Variable"}),e.jsx("div",{className:"flex-1 bg-emerald-500 opacity-20"})]}),e.jsxs("div",{className:"text-[10px] text-slate-300 grid grid-cols-2 gap-x-2 gap-y-1 group-hover:text-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-400 mr-1.5"})," Ajuste Imp: ",h.scrapBreakdown.startup,"m"]}),h.scrapBreakdown.reprint>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500 mr-1.5"})," Reprint: ",h.scrapBreakdown.reprint,"m"]}),h.scrapBreakdown.lamination>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-1.5"})," Laminación: ",h.scrapBreakdown.lamination,"m"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 mr-1.5"})," Variable: ",h.scrapBreakdown.variable,"m"]})]}),e.jsxs("div",{className:"text-right text-xs font-bold text-slate-400 mt-2 border-t border-slate-700 pt-1 group-hover:text-brand-300",children:["Total Merma: ",h.scrapMeters,"m ",S&&"(Manual)"]})]}),e.jsxs("div",{className:"border-t border-slate-700 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"block text-xs text-slate-500 uppercase",children:["Máximo (+",t,"%)"]}),e.jsxs("span",{className:"block text-lg font-bold",children:[h.maxLinearMetersWithTolerance.toLocaleString()," m"]})]}),e.jsxs("div",{className:"flex items-center bg-slate-800 p-2 rounded border border-slate-600",children:[e.jsx("input",{type:"checkbox",id:"useTolerance",checked:u,onChange:m=>C(m.target.checked),className:"w-4 h-4 text-brand-600 rounded bg-slate-700 border-slate-500 focus:ring-brand-500"}),e.jsx("label",{htmlFor:"useTolerance",className:"ml-2 text-xs font-bold text-slate-300 cursor-pointer select-none",children:"Usar Máx."})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-2 rounded",children:[e.jsx("span",{className:"block text-xs text-slate-500 uppercase",children:"Pedido Neto"}),e.jsxs("span",{className:"block text-md font-bold text-emerald-400",children:[h.requiredLinearMeters.toLocaleString()," m"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center uppercase text-sm",children:[e.jsx(bs,{size:16,className:"mr-2"})," Insumos Estimados ",u&&"(Max)"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[e.jsx("span",{className:"text-slate-600",children:"Tintas Total"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[u?h.maxInkKg:h.inkKg," Kg"]})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[e.jsx("span",{className:"text-slate-600",children:"Adhesivos"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[u?h.maxAdhesiveKg:h.adhesiveKg," Kg"]})]}),e.jsxs("div",{className:"flex justify-between pt-2",children:[e.jsx("span",{className:"text-brand-600 font-bold",children:"Peso Total Orden"}),e.jsxs("span",{className:"font-bold text-xl text-brand-700",children:[((z.l1Data.totalRealKg||h.layer1Kg)+(l.layer2?z.l2Data.totalRealKg||h.layer2Kg:0)+(l.layer3?z.l3Data.totalRealKg||h.layer3Kg:0)+(u?h.maxInkKg:h.inkKg)+(u?h.maxAdhesiveKg:h.adhesiveKg)).toLocaleString()," Kg"]})]})]})]}),e.jsxs("button",{onClick:Ee,disabled:!z.layer1||!z.layer2||!z.layer3,className:"w-full py-4 bg-brand-600 hover:bg-brand-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-xl font-bold text-lg shadow-lg transition-all flex justify-center items-center",children:[e.jsx(Re,{size:24,className:"mr-2"})," Confirmar Producción"]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-slate-100 rounded-xl p-6 h-full",children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4 flex items-center uppercase text-sm",children:[e.jsx(pe,{size:16,className:"mr-2"})," Asignación de Materiales"]}),e.jsxs("p",{className:"text-xs text-slate-500 mb-6",children:["Seleccione las bobinas del inventario. Puede seleccionar ",e.jsx("strong",{children:"varias bobinas"})," si una no es suficiente (Lógica de cascada).",e.jsx("br",{}),e.jsx("span",{className:"text-brand-600 font-bold",children:"Nota:"})," Se muestran solo materiales compatibles."]}),e.jsx(De,{layerKey:"layer1",spec:l.layer1,theoreticalKg:u?h.maxLayer1Kg:h.layer1Kg,metersRequired:u?h.maxLinearMetersWithTolerance:h.grossLinearMeters}),l.layer2&&e.jsx(De,{layerKey:"layer2",spec:l.layer2,theoreticalKg:u?h.maxLayer2Kg:h.layer2Kg,metersRequired:u?h.maxLinearMetersWithTolerance:h.grossLinearMeters}),l.layer3&&e.jsx(De,{layerKey:"layer3",spec:l.layer3,theoreticalKg:u?h.maxLayer3Kg:h.layer3Kg,metersRequired:u?h.maxLinearMetersWithTolerance:h.grossLinearMeters})]})})]})]})},ft=()=>{var x,w,U,ae;ge();const s=ce(),[a,c]=f.useState("list"),[r,n]=f.useState(ue()),[i,d]=f.useState(""),j={type:E.BOPP,thickness:20,width:0},g={format:"BOBINA",tracks:1,inkCoverage:3,adhesiveCoverage:1.8,specificScrapPercent:.05,windingDirection:"A1",layer1:{...j}},[t,y]=f.useState(g),[u,C]=f.useState(!1);f.useEffect(()=>{n(ue())},[a]);const b=l=>{y(l),c("form")},v=l=>{confirm("¿Estás seguro de eliminar esta ficha técnica? Se borrará del historial.")&&(Js(l),n(ue()))},p=l=>{if(l.preventDefault(),t.name&&t.clientId&&t.layer1){const $={...t,id:t.id||`p${Date.now()}`};Hs($),C(!0),setTimeout(()=>{C(!1),c("list")},1500)}},o=(l,$)=>{y(h=>({...h,[l]:$}))},S=(l,$,h)=>{y(R=>{const Z=R[l]||{...j};return{...R,[l]:{...Z,[$]:h}}})},L=(l,$)=>{y(h=>{if($)return{...h,[l]:{...j}};{const R={...h};return delete R[l],R}})},O=()=>{a==="list"?(y(g),c("form")):c("list")},_=[...["A","B","C","D","E","F","G"].flatMap(l=>[1,2,3,4,5,6].map($=>`${l}${$}`))],N=r.filter(l=>l.name.toLowerCase().includes(i.toLowerCase())||l.sku.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:a==="list"?"Fichas Técnicas":t.id?"Editar Ficha":"Nueva Ficha Técnica"}),e.jsx("p",{className:"text-sm text-slate-500",children:a==="list"?"Gestiona las recetas de producción":"Define estructura ideal y parámetros"})]}),e.jsx("button",{onClick:O,className:`px-4 py-2 rounded-lg font-medium text-sm flex items-center transition-colors ${a==="list"?"bg-brand-600 text-white hover:bg-brand-700 shadow-md":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:a==="list"?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{size:18,className:"mr-2"})," Nueva Ficha"]}):e.jsxs(e.Fragment,{children:[e.jsx(fs,{size:18,className:"mr-2"})," Ver Listado"]})})]}),a==="list"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-100",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Ge,{className:"absolute left-3 top-2.5 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",className:"pl-10 pr-4 py-2 w-full border rounded-lg focus:ring-2 focus:ring-brand-500 outline-none",value:i,onChange:l=>d(l.target.value)})]})}),e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 font-semibold",children:"SKU / Producto"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Estructura"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Dimensiones"}),e.jsx("th",{className:"px-6 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[N.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-slate-400",children:"No hay productos registrados."})}),N.map(l=>{var h,R,Z;const $=((h=s.find(le=>le.id===l.clientId))==null?void 0:h.name)||"N/A";return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-slate-800",children:l.name}),e.jsx("div",{className:"text-xs text-slate-500 font-mono",children:l.sku})]}),e.jsx("td",{className:"px-6 py-4 text-slate-600",children:$}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"font-bold text-brand-700",children:[((R=l.layer1)==null?void 0:R.type)||"N/A"," ",((Z=l.layer1)==null?void 0:Z.thickness)||0,"μ"]}),l.layer2&&e.jsxs("div",{className:"text-slate-600",children:["+ ",l.layer2.type," ",l.layer2.thickness,"μ"]}),l.layer3&&e.jsxs("div",{className:"text-slate-600",children:["+ ",l.layer3.type," ",l.layer3.thickness,"μ"]})]})}),e.jsxs("td",{className:"px-6 py-4 text-slate-600 text-xs space-y-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ze,{size:12,className:"mr-1"})," Ancho Imp: ",l.webWidth,"mm"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{size:12,className:"mr-1"})," Pistas: ",l.tracks]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{size:12,className:"mr-1"})," Paso: ",l.cutoff,"mm"]})]}),e.jsxs("td",{className:"px-6 py-4 text-right space-x-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>b(l),className:"text-brand-600 hover:bg-brand-50 p-1.5 rounded tooltip",title:"Editar",children:e.jsx(js,{size:18})}),e.jsx("button",{onClick:()=>v(l.id),className:"text-red-500 hover:bg-red-50 p-1.5 rounded tooltip",title:"Eliminar",children:e.jsx(fe,{size:18})})]})]},l.id)})]})]})]}),a==="form"&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 max-w-5xl mx-auto p-8 animate-fade-in",children:e.jsxs("form",{onSubmit:p,className:"space-y-8",children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-slate-400 mb-4",children:"1. Información Comercial"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Cliente"}),e.jsxs("select",{className:"input-field",required:!0,value:t.clientId,onChange:l=>o("clientId",l.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar..."}),s.map(l=>e.jsx("option",{value:l.id,children:l.name},l.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"SKU / Código"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Ej. BOL-500G",value:t.sku||"",onChange:l=>o("sku",l.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Nombre del Producto"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Ej. Bolsa Arroz 500g Premium",required:!0,value:t.name||"",onChange:l=>o("name",l.target.value)})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-slate-400 mb-4",children:"2. Formato y Dimensiones"}),e.jsxs("div",{className:"flex space-x-4 mb-6",children:[e.jsxs("button",{type:"button",onClick:()=>o("format","BOBINA"),className:`flex items-center px-6 py-3 rounded-lg border-2 transition-all ${t.format==="BOBINA"?"border-brand-500 bg-brand-50 text-brand-700":"border-slate-200 text-slate-500 hover:border-slate-300"}`,children:[e.jsx(Ns,{className:"mr-2",size:20})," Bobina (Reel)"]}),e.jsxs("button",{type:"button",onClick:()=>o("format","BOLSA"),className:`flex items-center px-6 py-3 rounded-lg border-2 transition-all ${t.format==="BOLSA"?"border-brand-500 bg-brand-50 text-brand-700":"border-slate-200 text-slate-500 hover:border-slate-300"}`,children:[e.jsx(Le,{className:"mr-2",size:20})," Bolsa (Bag)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 bg-slate-50 p-6 rounded-lg border border-slate-200",children:[t.format==="BOBINA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-brand-600",children:"Ancho Final Bobina (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:t.finalReelWidth||"",onChange:l=>o("finalReelWidth",Number(l.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-brand-600",children:"Paso / Cutoff (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:t.cutoff||"",onChange:l=>o("cutoff",Number(l.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Sentido Bobinado"}),e.jsx("select",{className:"input-field",value:t.windingDirection,onChange:l=>o("windingDirection",l.target.value),children:_.map(l=>e.jsx("option",{value:l,children:l},l))})]})]}),t.format==="BOLSA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-brand-600",children:"Ancho Bolsa / Paso (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:t.bagWidth||"",onChange:l=>{o("bagWidth",Number(l.target.value)),o("cutoff",Number(l.target.value))}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-slate-600",children:"Alto / Largo (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:t.bagHeight||"",onChange:l=>{o("bagHeight",Number(l.target.value))}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Fuelle (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"0",value:t.gusset||"",onChange:l=>o("gusset",Number(l.target.value))})]})]}),e.jsxs("div",{className:"border-l border-slate-300 pl-6 md:col-span-1 col-span-2",children:[e.jsx("label",{className:"label-text text-slate-900 font-bold",children:"Ingeniería"}),e.jsxs("div",{className:"space-y-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Pistas (Montaje)"}),e.jsx("input",{type:"number",className:"input-field py-1",min:"1",required:!0,value:t.tracks||1,onChange:l=>o("tracks",Number(l.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Desarrollo Cilindro (mm)"}),e.jsx("input",{type:"number",className:"input-field py-1",required:!0,value:t.cylinder||"",onChange:l=>o("cylinder",Number(l.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-brand-600 font-bold",children:"Ancho Impreso (mm)"}),e.jsx("input",{type:"number",className:"input-field py-1 border-brand-300 bg-white",required:!0,value:t.webWidth||"",onChange:l=>o("webWidth",Number(l.target.value))})]})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-slate-400 mb-4",children:"3. Estructura y Receta Ideal"}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Define el material ideal. La calculadora buscará el stock que mejor se ajuste."}),e.jsxs("div",{className:"space-y-6 p-6 bg-slate-50 rounded-xl border border-slate-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-start",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"label-text text-brand-700 font-bold",children:"Capa 1 (Impresión)"}),e.jsx("select",{className:"input-field font-bold",value:((x=t.layer1)==null?void 0:x.type)||E.BOPP,onChange:l=>S("layer1","type",l.target.value),children:Object.values(E).map(l=>e.jsx("option",{value:l,children:l},l))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Espesor (μm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"20",required:!0,value:((w=t.layer1)==null?void 0:w.thickness)||"",onChange:l=>S("layer1","thickness",Number(l.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Ancho Ideal (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:((t.webWidth||0)+20).toString(),value:((U=t.layer1)==null?void 0:U.width)||"",onChange:l=>S("layer1","width",Number(l.target.value))}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"Vacío = Ancho Impreso + 20mm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Tinta (g/m²)"}),e.jsx("input",{type:"number",step:"0.1",className:"input-field",value:t.inkCoverage,onChange:l=>o("inkCoverage",Number(l.target.value))})]}),t.webWidth&&((ae=t.layer1)==null?void 0:ae.width)&&t.layer1.width<t.webWidth&&e.jsxs("div",{className:"md:col-span-4 bg-red-50 text-red-700 p-2 rounded text-xs flex items-center",children:[e.jsx(je,{size:14,className:"mr-2"}),"El ancho del material (",t.layer1.width,"mm) es MENOR al ancho impreso (",t.webWidth,"mm)."]})]}),e.jsxs("div",{className:"relative border-t border-slate-200 pt-4 mt-2",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"hasLayer2",className:"mr-2",checked:!!t.layer2,onChange:l=>L("layer2",l.target.checked)}),e.jsx("label",{htmlFor:"hasLayer2",className:"text-sm font-bold text-slate-700 select-none cursor-pointer",children:"Capa 2 (Laminación)"})]}),t.layer2&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-start animate-fade-in",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx("select",{className:"input-field",value:t.layer2.type,onChange:l=>S("layer2","type",l.target.value),children:Object.values(E).map(l=>e.jsx("option",{value:l,children:l},l))})}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Espesor (μm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:t.layer2.thickness,onChange:l=>S("layer2","thickness",Number(l.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Ancho Ideal (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:((t.webWidth||0)+20).toString(),value:t.layer2.width||"",onChange:l=>S("layer2","width",Number(l.target.value))}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"Vacío = Ancho Impreso + 20mm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Adhesivo (g/m²)"}),e.jsx("input",{type:"number",step:"0.1",className:"input-field",value:t.adhesiveCoverage,onChange:l=>o("adhesiveCoverage",Number(l.target.value))})]}),t.webWidth&&t.layer2.width&&t.layer2.width<t.webWidth&&e.jsxs("div",{className:"md:col-span-4 bg-red-50 text-red-700 p-2 rounded text-xs flex items-center",children:[e.jsx(je,{size:14,className:"mr-2"}),"El ancho del material (",t.layer2.width,"mm) es MENOR al ancho impreso (",t.webWidth,"mm)."]})]})]}),e.jsxs("div",{className:"relative border-t border-slate-200 pt-4 mt-2",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"hasLayer3",className:"mr-2",checked:!!t.layer3,onChange:l=>L("layer3",l.target.checked)}),e.jsx("label",{htmlFor:"hasLayer3",className:"text-sm font-bold text-slate-700 select-none cursor-pointer",children:"Capa 3 (Trilaminado)"})]}),t.layer3&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-start animate-fade-in",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx("select",{className:"input-field",value:t.layer3.type,onChange:l=>S("layer3","type",l.target.value),children:Object.values(E).map(l=>e.jsx("option",{value:l,children:l},l))})}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Espesor (μm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:t.layer3.thickness,onChange:l=>S("layer3","thickness",Number(l.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Ancho Ideal (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:((t.webWidth||0)+20).toString(),value:t.layer3.width||"",onChange:l=>S("layer3","width",Number(l.target.value))}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"Vacío = Ancho Impreso + 20mm"})]}),t.webWidth&&t.layer3.width&&t.layer3.width<t.webWidth&&e.jsxs("div",{className:"md:col-span-4 bg-red-50 text-red-700 p-2 rounded text-xs flex items-center",children:[e.jsx(je,{size:14,className:"mr-2"}),"El ancho del material (",t.layer3.width,"mm) es MENOR al ancho impreso (",t.webWidth,"mm)."]})]})]})]})]}),e.jsxs("div",{className:"pt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>c("list"),className:"px-6 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-100",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"flex items-center bg-brand-600 hover:bg-brand-700 text-white px-8 py-3 rounded-lg font-bold shadow-lg transition-all hover:scale-105",children:[e.jsx(ie,{className:"mr-2"})," Guardar Ficha Técnica"]})]}),u&&e.jsx("div",{className:"p-4 bg-green-50 text-green-700 rounded-lg text-center font-medium border border-green-200 animate-bounce",children:"¡Ficha técnica guardada exitosamente!"})]})}),e.jsx("style",{children:`
        .label-text { display: block; font-size: 0.875rem; font-weight: 500; color: #475569; margin-bottom: 0.25rem; }
        .input-field { width: 100%; border-radius: 0.5rem; border: 1px solid #cbd5e1; padding: 0.625rem; outline: none; transition: border-color 0.2s; }
        .input-field:focus { border-color: #0ea5e9; ring: 2px; ring-color: #0ea5e9; }
      `})]})},jt=()=>{const[s,a]=f.useState(ce()),[c,r]=f.useState(!1),[n,i]=f.useState({}),d=()=>a(ce()),j=t=>{t.preventDefault(),n.name&&(Qs({id:n.id||`c${Date.now()}`,name:n.name,contact:n.contact||"",email:n.email||"",phone:n.phone||""}),r(!1),i({}),d())},g=t=>{confirm("¿Estás seguro de eliminar este cliente?")&&(Ys(t),d())};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(We,{className:"mr-2 text-brand-600"})," Gestión de Clientes"]}),e.jsxs("button",{onClick:()=>{i({}),r(!0)},className:"bg-brand-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-brand-700 transition-colors",children:[e.jsx(Ce,{size:18,className:"mr-1"})," Nuevo Cliente"]})]}),c&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-brand-200 mb-6",children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4",children:[n.id?"Editar":"Crear"," Cliente"]}),e.jsxs("form",{onSubmit:j,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Razón Social"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.name||"",onChange:t=>i({...n,name:t.target.value}),required:!0,placeholder:"Ej. Alimentos SAS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Contacto"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.contact||"",onChange:t=>i({...n,contact:t.target.value}),placeholder:"Nombre del encargado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Email"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.email||"",onChange:t=>i({...n,email:t.target.value}),placeholder:"contacto@cliente.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Teléfono"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.phone||"",onChange:t=>i({...n,phone:t.target.value}),placeholder:"+57 ..."})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-6 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 flex items-center",children:[e.jsx(ie,{size:18,className:"mr-2"})," Guardar"]})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Nombre"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Contacto"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Email"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Teléfono"}),e.jsx("th",{className:"px-6 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-slate-400",children:"No hay clientes registrados"})}),s.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-3 font-medium text-slate-800",children:t.name}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:t.contact}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:t.email||"-"}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:t.phone||"-"}),e.jsxs("td",{className:"px-6 py-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>{i(t),r(!0)},className:"text-brand-600 hover:text-brand-800 font-medium",children:"Editar"}),e.jsx("button",{onClick:()=>g(t.id),className:"text-red-500 hover:text-red-700",children:e.jsx(fe,{size:18})})]})]},t.id))]})]})})]})},Nt=()=>{const[s,a]=f.useState(ge()),[c,r]=f.useState(he()),[n,i]=f.useState(!1),[d,j]=f.useState({}),[g,t]=f.useState(""),y=()=>{a(ge()),r(he())};f.useEffect(()=>{n&&r(he())},[n]);const u=o=>{o.preventDefault(),d.name&&d.internalCode&&(st({id:d.id||`m${Date.now()}`,internalCode:d.internalCode,name:d.name,supplier:d.supplier,type:d.type||E.BOPP,thickness:Number(d.thickness)||0,density:Number(d.density)||0,width:Number(d.width)||0,currentStockKg:Number(d.currentStockKg)||0,costPerKg:Number(d.costPerKg)||0}),i(!1),j({}),y())},C=o=>{confirm("¿Eliminar material? Esto podría afectar recetas existentes.")&&(tt(o),y())},b=o=>{var O;const L=((O=xe().materialDensities)==null?void 0:O[o])||de[o];j({...d,type:o,density:L})},v=s.filter(o=>o.name.toLowerCase().includes(g.toLowerCase())||o.internalCode.toLowerCase().includes(g.toLowerCase())),p=["BOPP Transparente","BOPP Mate","BOPP Metalizado","BOPP Blanco","BOPP Perlado","PET Transparente","PET Metalizado","PET DT","PET PVDC","PEBD Transparente","PEBD Blanco","CPP Transparente","CPP Metalizado","BOPP DT","BOPA (Nylon)"];return e.jsxs("div",{className:"space-y-6 animate-fade-in relative",children:[e.jsx("datalist",{id:"material-names",children:p.map(o=>e.jsx("option",{value:o},o))}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(Ie,{className:"mr-2 text-brand-600"})," Gestión de Inventario"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Administra bobinas, anchos y existencias"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-2.5 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Buscar código o nombre...",className:"pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-brand-500 outline-none w-64",value:g,onChange:o=>t(o.target.value)})]}),e.jsxs("button",{onClick:()=>{j({type:E.BOPP,density:.91}),i(!0)},className:"bg-brand-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-brand-700 transition-colors shadow-md",children:[e.jsx(Ce,{size:18,className:"mr-1"})," Ingresar Material"]})]})]}),n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl border border-brand-200 w-full max-w-4xl max-h-[90vh] overflow-y-auto animate-fade-in relative",children:[e.jsx("button",{onClick:()=>i(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:e.jsx(Te,{size:24})}),e.jsxs("h3",{className:"font-bold text-slate-700 mb-6 text-xl border-b pb-2 flex items-center",children:[e.jsx(Ie,{className:"mr-2 text-brand-600"}),d.id?"Editar":"Ingresar"," Bobina al Inventario"]}),e.jsxs("form",{onSubmit:u,className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Código Interno"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none font-mono bg-slate-50",value:d.internalCode||"",onChange:o=>j({...d,internalCode:o.target.value}),required:!0,placeholder:"Ej. MP-1023",autoFocus:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Descripción"}),e.jsx("input",{list:"material-names",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.name||"",onChange:o=>j({...d,name:o.target.value}),required:!0,placeholder:"Ej. BOPP Metalizado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Proveedor"}),e.jsxs("div",{className:"relative",children:[e.jsx(Se,{className:"absolute left-2 top-2 text-slate-400",size:16}),e.jsxs("select",{className:"w-full border p-2 pl-8 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.supplier||"",onChange:o=>j({...d,supplier:o.target.value}),children:[e.jsx("option",{value:"",children:"Seleccionar Proveedor..."}),c.map(o=>e.jsx("option",{value:o.name,children:o.name},o.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Tipo"}),e.jsx("select",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.type,onChange:o=>b(o.target.value),children:Object.values(E).map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Espesor (μm)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.thickness||"",onChange:o=>j({...d,thickness:Number(o.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Densidad (g/cm³)"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none bg-slate-50",value:d.density||"",onChange:o=>j({...d,density:Number(o.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-brand-600 mb-1",children:"Ancho Bobina (mm)"}),e.jsx("input",{type:"number",className:"w-full border-2 border-brand-100 p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.width||"",onChange:o=>j({...d,width:Number(o.target.value)}),required:!0,placeholder:"Ancho real"})]}),e.jsxs("div",{className:"bg-emerald-50 p-2 rounded border border-emerald-100 md:col-start-4",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-emerald-700 mb-1",children:"Stock Actual (Kg)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full border border-emerald-300 p-2 rounded focus:ring-2 focus:ring-emerald-500 outline-none text-emerald-800 font-bold",value:d.currentStockKg||"",onChange:o=>j({...d,currentStockKg:Number(o.target.value)}),required:!0,placeholder:"0.00"})]}),e.jsxs("div",{className:"md:col-span-4 flex justify-end space-x-3 mt-4 pt-4 border-t border-slate-100",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-6 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 flex items-center shadow-lg",children:[e.jsx(ie,{size:18,className:"mr-2"})," Guardar en Inventario"]})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Código"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Material"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Prov."}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ancho"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Micras"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:"Stock (Kg)"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[v.map(o=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-slate-500 text-xs",children:o.internalCode}),e.jsxs("td",{className:"px-4 py-3 font-medium text-slate-800",children:[o.name,e.jsxs("span",{className:"block text-xs text-slate-400",children:[o.type," | Dens: ",o.density]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-600 text-xs",children:o.supplier||"-"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700 font-medium",children:[o.width," mm"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-600",children:[o.thickness," μ"]}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("span",{className:`font-bold px-2 py-1 rounded ${o.currentStockKg<100?"bg-red-100 text-red-700":"bg-emerald-50 text-emerald-700"}`,children:[o.currentStockKg.toLocaleString()," Kg"]})}),e.jsxs("td",{className:"px-4 py-3 text-right space-x-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>{j(o),i(!0)},className:"text-brand-600 hover:text-brand-800 font-medium p-1 hover:bg-brand-50 rounded",children:"Editar"}),e.jsx("button",{onClick:()=>C(o.id),className:"text-red-500 hover:text-red-700 p-1 hover:bg-red-50 rounded",children:e.jsx(fe,{size:16})})]})]},o.id)),v.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-slate-400",children:"No se encontraron materiales con ese criterio."})})]})]})})]})},vt=()=>{const[s,a]=f.useState(he()),[c,r]=f.useState(!1),[n,i]=f.useState({}),d=()=>a(he()),j=t=>{t.preventDefault(),n.name&&(Xs({id:n.id||`s${Date.now()}`,name:n.name,contact:n.contact||"",email:n.email||"",phone:n.phone||"",origin:n.origin||"Nacional"}),r(!1),i({}),d())},g=t=>{confirm("¿Estás seguro de eliminar este proveedor?")&&(et(t),d())};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(qe,{className:"mr-2 text-brand-600"})," Gestión de Proveedores"]}),e.jsxs("button",{onClick:()=>{i({}),r(!0)},className:"bg-brand-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-brand-700 transition-colors",children:[e.jsx(Ce,{size:18,className:"mr-1"})," Nuevo Proveedor"]})]}),c&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-brand-200 mb-6",children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4",children:[n.id?"Editar":"Crear"," Proveedor"]}),e.jsxs("form",{onSubmit:j,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Razón Social"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.name||"",onChange:t=>i({...n,name:t.target.value}),required:!0,placeholder:"Ej. Oben Holding"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Origen"}),e.jsxs("select",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.origin||"Nacional",onChange:t=>i({...n,origin:t.target.value}),children:[e.jsx("option",{value:"Nacional",children:"Nacional"}),e.jsx("option",{value:"Importado",children:"Importado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Contacto"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.contact||"",onChange:t=>i({...n,contact:t.target.value}),placeholder:"Nombre del encargado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Email"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.email||"",onChange:t=>i({...n,email:t.target.value}),placeholder:"ventas@proveedor.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Teléfono"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:n.phone||"",onChange:t=>i({...n,phone:t.target.value}),placeholder:"+57 ..."})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>r(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-6 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 flex items-center",children:[e.jsx(ie,{size:18,className:"mr-2"})," Guardar"]})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Nombre"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Origen"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Contacto"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Teléfono"}),e.jsx("th",{className:"px-6 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[s.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-slate-400",children:"No hay proveedores registrados"})}),s.map(t=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-3 font-medium text-slate-800",children:t.name}),e.jsx("td",{className:"px-6 py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${t.origin==="Importado"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:t.origin})}),e.jsxs("td",{className:"px-6 py-3 text-slate-600",children:[e.jsx("div",{children:t.contact}),e.jsx("div",{className:"text-xs text-slate-400",children:t.email})]}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:t.phone||"-"}),e.jsxs("td",{className:"px-6 py-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>{i(t),r(!0)},className:"text-brand-600 hover:text-brand-800 font-medium",children:"Editar"}),e.jsx("button",{onClick:()=>g(t.id),className:"text-red-500 hover:text-red-700",children:e.jsx(fe,{size:18})})]})]},t.id))]})]})})]})},yt=()=>{const[s,a]=f.useState("Impresión"),[c,r]=f.useState([]),[n,i]=f.useState(!1),[d,j]=f.useState(null),g=["Impresión","Reimpresión","Laminación","Trilaminado","Refilado","Confección (Bolsera)"];f.useEffect(()=>{const v=ne().filter(p=>p.status==="En Producción"&&(p.currentStage===s||!p.currentStage&&s==="Impresión"));r(v)},[s]);const t=(b,v)=>{j(v),b.dataTransfer.effectAllowed="move";const p=document.createElement("div");p.textContent="Moviendo...",p.style.background="#fff",p.style.padding="10px",p.style.border="1px solid #ccc",document.body.appendChild(p),b.dataTransfer.setDragImage(p,0,0),setTimeout(()=>document.body.removeChild(p),0)},y=(b,v)=>{if(b.preventDefault(),d===null||d===v)return;const p=[...c],o=p[d];p.splice(d,1),p.splice(v,0,o),r(p),j(v)},u=()=>{j(null),nt(c)},C=()=>{i(!0),setTimeout(()=>{const b=document.getElementById("queue-printable-area");if(!b)return;const v=document.createElement("div");v.style.position="fixed",v.style.top="0",v.style.left="0",v.style.width="100vw",v.style.zIndex="999999",v.style.background="#ffffff";const p=b.cloneNode(!0);p.classList.remove("hidden"),p.style.width="100%",v.appendChild(p),document.body.appendChild(v);const o={margin:10,filename:`Planilla_${s}_${new Date().toISOString().split("T")[0]}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"landscape"}};window.html2pdf().set(o).from(p).save().then(()=>{document.body.removeChild(v),i(!1)})},100)};return e.jsxs("div",{className:"h-full flex flex-col animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(Se,{className:"mr-2 text-brand-600"}),"Fila de Producción"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Organiza y prioriza las órdenes en curso"})]}),e.jsxs("button",{onClick:C,disabled:n,className:"bg-slate-800 text-white px-4 py-2 rounded-lg flex items-center hover:bg-slate-700 transition-colors",children:[n?e.jsx(He,{size:18,className:"mr-2 animate-spin"}):e.jsx(Ve,{size:18,className:"mr-2"}),"Descargar Planilla (PDF)"]})]}),e.jsx("div",{className:"flex space-x-1 mb-6 overflow-x-auto pb-2",children:g.map(b=>e.jsx("button",{onClick:()=>a(b),className:`px-5 py-2.5 rounded-lg font-bold text-sm transition-all whitespace-nowrap
                    ${s===b?"bg-brand-600 text-white shadow-md":"bg-white text-slate-600 border border-slate-200 hover:bg-slate-50"}`,children:b},b))}),e.jsx("div",{className:"flex-1 bg-slate-100 rounded-xl p-6 border border-slate-200 overflow-y-auto min-h-[500px]",children:c.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-400",children:[e.jsx(Je,{size:48,className:"mb-4 opacity-50"}),e.jsxs("p",{className:"font-medium",children:["No hay órdenes en la etapa de ",s]}),e.jsx("p",{className:"text-sm",children:'Ve al Dashboard y marca órdenes como "En Producción" en esta etapa.'})]}):e.jsx("div",{className:"space-y-3 max-w-4xl mx-auto",children:c.map((b,v)=>e.jsxs("div",{draggable:!0,onDragStart:p=>t(p,v),onDragOver:p=>y(p,v),onDragEnd:u,className:`bg-white rounded-lg p-4 shadow-sm border border-slate-200 flex items-center group hover:shadow-md transition-all
                            ${d===v?"opacity-50 scale-95":"opacity-100"}`,children:[e.jsxs("div",{className:"mr-4 cursor-grab active:cursor-grabbing text-slate-400 hover:text-brand-500",children:[e.jsx(vs,{size:24}),e.jsx("span",{className:"text-xs font-bold text-center block mt-1 w-6",children:v+1})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"bg-slate-100 text-slate-600 text-[10px] font-bold px-1.5 py-0.5 rounded mr-2",children:b.orderCode}),e.jsx("span",{className:"text-brand-700 font-bold text-lg",children:b.productName})]}),e.jsx("div",{className:"text-sm text-slate-500 flex items-center",children:e.jsx("span",{className:"font-bold text-slate-700 mr-2",children:b.clientName})})]}),e.jsxs("div",{className:"flex flex-col justify-center text-sm border-l border-slate-100 pl-4",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Pedido"}),e.jsxs("span",{className:"font-bold text-slate-800 text-lg",children:[b.quantityRequested.toLocaleString()," ",b.unit==="Unidades"?"Ud":"Kg"]}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Total: ",b.calculationSnapshot.totalWeightKg.toLocaleString()," Kg"]})]}),e.jsxs("div",{className:"flex flex-col justify-center text-sm border-l border-slate-100 pl-4",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Técnico"}),e.jsxs("span",{className:"text-slate-700 font-mono",children:["Ancho: ",e.jsx("strong",{children:b.technicalDetails.webWidth})," mm"]}),e.jsxs("span",{className:"text-slate-700 font-mono",children:["Cilindro: ",e.jsx("strong",{children:b.technicalDetails.cylinder})," mm"]})]})]}),e.jsxs("div",{className:"ml-4 pl-4 border-l border-slate-200 text-right",children:[e.jsxs("div",{className:"bg-emerald-50 text-emerald-700 border border-emerald-200 px-3 py-1.5 rounded-lg flex items-center text-xs font-bold whitespace-nowrap",children:[e.jsx(Ne,{size:14,className:"mr-1.5"}),"En ",b.currentStage||"Proceso"]}),e.jsxs("div",{className:"mt-1 text-[10px] text-slate-400 flex items-center justify-end",children:[e.jsx(ys,{size:10,className:"mr-1"})," ",b.date]})]})]},b.id))})}),e.jsxs("div",{id:"queue-printable-area",className:"hidden bg-white p-8",children:[e.jsxs("div",{className:"border-b-2 border-black pb-4 mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold uppercase",children:"PCP Multipack"}),e.jsxs("p",{className:"text-lg text-gray-600",children:["Planilla de Programación: ",e.jsx("span",{className:"font-bold text-black uppercase",children:s})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold",children:"Fecha Impresión:"}),e.jsx("p",{className:"font-mono",children:new Date().toLocaleString()})]})]}),e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 border-y-2 border-black text-sm uppercase",children:[e.jsx("th",{className:"p-3 w-12 text-center",children:"#"}),e.jsx("th",{className:"p-3",children:"OP"}),e.jsx("th",{className:"p-3",children:"Cliente / Producto"}),e.jsx("th",{className:"p-3 text-right",children:"Cantidad"}),e.jsx("th",{className:"p-3 text-center",children:"Ancho"}),e.jsx("th",{className:"p-3 text-center",children:"Desarrollo"}),e.jsx("th",{className:"p-3 text-center",children:"Estado"}),e.jsx("th",{className:"p-3 w-32",children:"Observaciones"})]})}),e.jsx("tbody",{children:c.map((b,v)=>e.jsxs("tr",{className:"border-b border-gray-300 text-sm",children:[e.jsx("td",{className:"p-3 text-center font-bold text-lg",children:v+1}),e.jsx("td",{className:"p-3 font-mono font-bold",children:b.orderCode}),e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-bold text-black text-base",children:b.productName}),e.jsx("div",{className:"text-gray-600 text-xs",children:b.clientName})]}),e.jsxs("td",{className:"p-3 text-right font-bold",children:[b.quantityRequested.toLocaleString()," ",b.unit==="Unidades"?"Ud":"Kg"]}),e.jsxs("td",{className:"p-3 text-center",children:[b.technicalDetails.webWidth," mm"]}),e.jsxs("td",{className:"p-3 text-center",children:[b.technicalDetails.cylinder," mm"]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:"bg-gray-100 border border-gray-300 px-2 py-1 rounded text-xs font-bold uppercase",children:b.currentStage})}),e.jsx("td",{className:"p-3 border-l border-gray-200"})]},b.id))})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t-2 border-black flex justify-between text-xs uppercase font-bold text-gray-500",children:[e.jsx("div",{children:"Supervisor de Turno"}),e.jsx("div",{children:"Firma Recibido"})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-[10px] text-gray-400",children:"Software enigma.com.uy"})})]})]})},wt=()=>{var C,b,v,p,o,S,L,O,_,N;const[s,a]=f.useState(xe()),[c,r]=f.useState(!1),[n,i]=f.useState(!1),d=f.useRef(null),j=x=>{x.preventDefault(),dt(s),r(!0),setTimeout(()=>r(!1),2e3)},g=async x=>{x.target.files&&x.target.files[0]&&(await mt(x.target.files[0])&&(alert("Base de datos restaurada correctamente. La página se recargará."),window.location.reload()),d.current&&(d.current.value=""))},t=async()=>{i(!0);const x=await Zs();i(!1),x.success?alert(x.message):alert("Error: "+x.message)},y=(x,w)=>{a({...s,zetaConfig:{...s.zetaConfig,[x]:w}})},u=(x,w)=>{a({...s,materialDensities:{...s.materialDensities,[x]:w}})};return e.jsxs("div",{className:"max-w-2xl mx-auto animate-fade-in space-y-8 pb-10",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8",children:[e.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"bg-slate-100 p-3 rounded-full mr-4",children:e.jsx(be,{className:"text-slate-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Parámetros de Producción"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Variables globales para el cálculo de merma y metraje"})]})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste Impresión"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Metros fijos perdidos en arranque de impresión."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:s.fixedStartupMeters,onChange:x=>a({...s,fixedStartupMeters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste Reprint (DT)"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Extra si el material es tipo DT (Reimpresión)."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:s.reprintMeters||0,onChange:x=>a({...s,reprintMeters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste 1° Laminado"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Extra si la ficha tiene Capa 2."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:s.lamination1Meters||0,onChange:x=>a({...s,lamination1Meters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste 2° Laminado"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Extra si la ficha tiene Capa 3."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:s.lamination2Meters||0,onChange:x=>a({...s,lamination2Meters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"% Merma Variable (Proceso)"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Porcentaje de seguridad sobre el metraje neto (ej. 0.05 = 5%)."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",step:"0.01",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none max-w-xs",value:s.variableScrapPercent,onChange:x=>a({...s,variableScrapPercent:Number(x.target.value)})}),e.jsx("span",{className:"ml-3 text-slate-600 font-medium",children:"factor (0.1 = 10%)"})]})]}),e.jsxs("div",{className:"pt-4 flex items-center justify-between",children:[c?e.jsx("span",{className:"text-green-600 font-medium text-sm animate-pulse",children:"¡Guardado correctamente!"}):e.jsx("span",{}),e.jsxs("button",{type:"submit",className:"bg-brand-600 text-white px-6 py-2 rounded-lg hover:bg-brand-700 transition-colors flex items-center",children:[e.jsx(ie,{className:"mr-2",size:18})," Guardar Cambios"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8",children:[e.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-full mr-4",children:e.jsx(ws,{className:"text-orange-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Densidades de Materiales (g/cm³)"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Valores globales utilizados para cálculos teóricos"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.values(E).map(x=>{var w;return e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"text-xs font-bold text-slate-600 uppercase mb-1",children:x}),e.jsx("input",{type:"number",step:"0.01",className:"border border-slate-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-orange-500 outline-none",value:((w=s.materialDensities)==null?void 0:w[x])||0,onChange:U=>u(x,Number(U.target.value))})]},x)})}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:j,className:"bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center",children:[e.jsx(ie,{className:"mr-2",size:18})," Actualizar Densidades"]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8",children:[e.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"bg-indigo-100 p-3 rounded-full mr-4",children:e.jsx(Cs,{className:"text-indigo-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Integración ERP (ZetaSoftware SOAP)"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Sincroniza inventario (StockActualV3)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"checkbox",id:"zetaEnabled",checked:((C=s.zetaConfig)==null?void 0:C.enabled)||!1,onChange:x=>a({...s,zetaConfig:{...s.zetaConfig,enabled:x.target.checked}}),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"zetaEnabled",className:"ml-2 block text-sm font-bold text-slate-700",children:"Habilitar Integración SOAP"})]}),((b=s.zetaConfig)==null?void 0:b.enabled)&&e.jsxs("div",{className:"space-y-6 p-5 bg-indigo-50 rounded-lg border border-indigo-100 animate-fade-in",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 text-blue-900 p-4 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ss,{className:"shrink-0 mr-3 text-blue-600",size:20}),e.jsxs("div",{className:"text-xs",children:[e.jsx("p",{className:"font-bold text-sm mb-1 text-blue-800",children:"¿De dónde saco estos datos?"}),e.jsxs("p",{className:"mb-2",children:["Estos valores son credenciales de seguridad que ",e.jsx("strong",{children:"NO"})," encontrarás en el menú normal de Zeta. Debes solicitarlas a ",e.jsx("strong",{children:"Soporte Técnico de ZetaSoftware"}),":"]}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1 text-blue-700",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Desarrollador:"})," Código y clave para permitir acceso a la API (Integration Key)."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Empresa:"})," Código y clave únicos que identifican tu base de datos en la nube."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Usuario:"}),' Recomendamos crear un usuario llamado "API" en Zeta y usar su ID numérico y contraseña.']})]})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-700 mb-1",children:"URL Endpoint WSDL"}),e.jsx("input",{type:"text",className:"w-full border p-2 rounded text-sm bg-white text-slate-500",placeholder:"https://api.zetasoftware.com/z.apis.asoapstockactualv3",value:((v=s.zetaConfig)==null?void 0:v.apiUrl)||"",onChange:x=>y("apiUrl",x.target.value)}),e.jsx("p",{className:"text-[10px] text-indigo-400 mt-1",children:"Dirección del servicio web (Normalmente no cambia)."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2 border-t border-indigo-200 pt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-indigo-900 mb-2 flex items-center",children:[e.jsx(ks,{size:14,className:"mr-1"})," 1. Credenciales de Integrador"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-600 mb-1",children:"Código Desarrollador"}),e.jsx("input",{type:"text",className:"w-full border p-2 rounded text-sm bg-white",placeholder:"Solicitar a soporte",value:((p=s.zetaConfig)==null?void 0:p.desarrolladorCodigo)||"",onChange:x=>y("desarrolladorCodigo",x.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-600 mb-1",children:"Clave Desarrollador"}),e.jsx("input",{type:"password",className:"w-full border p-2 rounded text-sm bg-white",placeholder:"••••••",value:((o=s.zetaConfig)==null?void 0:o.desarrolladorClave)||"",onChange:x=>y("desarrolladorClave",x.target.value)})]})]})]}),e.jsxs("div",{className:"col-span-2 border-t border-indigo-200 pt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-indigo-900 mb-2 flex items-center",children:[e.jsx(Ps,{size:14,className:"mr-1"})," 2. Credenciales de Empresa"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-600 mb-1",children:"Código Empresa"}),e.jsx("input",{type:"text",className:"w-full border p-2 rounded text-sm bg-white",placeholder:"Ej. EMP_001",value:((S=s.zetaConfig)==null?void 0:S.empresaCodigo)||"",onChange:x=>y("empresaCodigo",x.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-600 mb-1",children:"Clave Empresa"}),e.jsx("input",{type:"password",className:"w-full border p-2 rounded text-sm bg-white",placeholder:"••••••",value:((L=s.zetaConfig)==null?void 0:L.empresaClave)||"",onChange:x=>y("empresaClave",x.target.value)})]})]})]}),e.jsxs("div",{className:"col-span-2 border-t border-indigo-200 pt-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-indigo-900 mb-2 flex items-center",children:[e.jsx(Oe,{size:14,className:"mr-1"})," 3. Usuario Web (API User)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-600 mb-1",children:"Código Usuario (ID)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded text-sm bg-white",placeholder:"Ej. 10",value:((O=s.zetaConfig)==null?void 0:O.usuarioCodigo)||"",onChange:x=>y("usuarioCodigo",x.target.value)}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Es el ID numérico del usuario, no el nombre."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-600 mb-1",children:"Clave Usuario"}),e.jsx("input",{type:"password",className:"w-full border p-2 rounded text-sm bg-white",placeholder:"••••••",value:((_=s.zetaConfig)==null?void 0:_.usuarioClave)||"",onChange:x=>y("usuarioClave",x.target.value)}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"La contraseña con la que entra a Zeta."})]})]})]})]}),e.jsx("div",{className:"border-t border-indigo-200 pt-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-indigo-700 mr-2",children:"Rol Código:"}),e.jsx("input",{type:"number",className:"w-24 border p-2 rounded text-sm bg-white",value:((N=s.zetaConfig)==null?void 0:N.rolCodigo)||"0",onChange:x=>y("rolCodigo",x.target.value)}),e.jsxs("span",{className:"ml-2 text-[10px] text-slate-500 flex items-center",children:[e.jsx(Es,{size:10,className:"mr-1"})," 0 = Rol por defecto."]})]})}),e.jsxs("div",{className:"pt-4",children:[e.jsxs("button",{type:"button",onClick:t,disabled:n,className:"w-full bg-indigo-600 text-white px-4 py-3 rounded-lg hover:bg-indigo-700 transition-colors flex items-center justify-center font-bold shadow-lg",children:[e.jsx(Ds,{className:`mr-2 ${n?"animate-spin":""}`,size:20}),n?"Conectando con ZetaSoftware...":"Probar Conexión y Sincronizar"]}),e.jsx("p",{className:"text-xs text-indigo-500 mt-3 text-center font-medium",children:"Se descargarán solo artículos de: POLO FILMS, VITOPEL, TERPHANE, MULTIPACK, RBS."})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8",children:[e.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"bg-emerald-100 p-3 rounded-full mr-4",children:e.jsx(As,{className:"text-emerald-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Base de Datos (Respaldo)"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Guarda y carga tu información manualmente"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border border-slate-100",children:[e.jsxs("div",{className:"text-slate-600 text-sm max-w-xs",children:[e.jsx("strong",{children:"Reporte Excel (.xlsx)"}),e.jsx("br",{}),"Tablas de Clientes, Materiales y Fichas legibles para humanos."]}),e.jsxs("button",{onClick:ot,className:"bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors flex items-center shadow",children:[e.jsx(ze,{className:"mr-2",size:18})," Excel"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"text-blue-800 text-sm mb-3 font-bold flex items-center",children:[e.jsx(Is,{className:"mr-2",size:16})," 1. Guardar (Backup)"]}),e.jsx("p",{className:"text-xs text-blue-600 mb-3",children:"Descarga el archivo JSON. Guárdalo en tu Google Drive para llevarlo a otra PC."}),e.jsxs("button",{onClick:xt,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center shadow text-sm",children:[e.jsx(ze,{className:"mr-2",size:16})," Descargar DB"]})]}),e.jsxs("div",{className:"p-4 bg-amber-50 rounded-lg border border-amber-100",children:[e.jsxs("div",{className:"text-amber-800 text-sm mb-3 font-bold flex items-center",children:[e.jsx(Fe,{className:"mr-2",size:16})," 2. Restaurar (Importar)"]}),e.jsx("p",{className:"text-xs text-amber-600 mb-3",children:"Carga el archivo JSON desde tu PC o Drive para recuperar tus datos."}),e.jsx("input",{type:"file",accept:".json",ref:d,className:"hidden",onChange:g}),e.jsxs("button",{onClick:()=>{var x;return(x=d.current)==null?void 0:x.click()},className:"w-full bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors flex items-center justify-center shadow text-sm",children:[e.jsx(Fe,{className:"mr-2",size:16})," Cargar DB"]})]})]})]})]})]})},Ae=({order:s,onSelect:a,onStatusChange:c,onDelete:r})=>{const n={Pendiente:"border-l-4 border-l-amber-400","En Producción":"border-l-4 border-l-blue-500",Terminado:"border-l-4 border-l-emerald-500 opacity-75"};return e.jsxs("div",{onClick:()=>a(s),className:`bg-white rounded-lg shadow-sm p-4 mb-4 border border-slate-200 ${n[s.status]||"border-l-4 border-l-slate-400"} hover:shadow-md hover:scale-[1.01] transition-all cursor-pointer relative`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1 pr-2",children:[e.jsxs("span",{className:"text-xs font-bold text-slate-400 block",children:[s.orderCode," | ",s.date]}),e.jsx("h4",{className:"font-bold text-slate-800 text-base leading-tight mb-1",children:s.clientName}),e.jsx("p",{className:"text-sm text-slate-600 leading-snug",children:s.productName})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsxs("span",{className:"block font-bold text-slate-800",children:[s.quantityRequested.toLocaleString()," ",s.unit==="Unidades"?"Ud":s.unit==="Metros"?"m":"Kg"]}),e.jsx("span",{className:"text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-500",children:s.technicalDetails.format})]})]}),s.status==="En Producción"&&s.currentStage&&e.jsxs("div",{className:"my-2 text-xs font-bold text-blue-700 bg-blue-50 px-2 py-1 rounded border border-blue-100 flex items-center",children:[e.jsx(Se,{size:12,className:"mr-1.5"}),"Etapa: ",s.currentStage]}),e.jsxs("div",{className:"bg-slate-50 rounded p-2 my-3 text-xs space-y-1 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center text-slate-600",children:[e.jsx(Ze,{size:12,className:"mr-1.5"}),e.jsxs("span",{children:["Ancho: ",e.jsxs("strong",{children:[s.technicalDetails.webWidth,"mm"]})," | Cutoff: ",e.jsxs("strong",{children:[s.technicalDetails.cutoff,"mm"]})]})]}),e.jsxs("div",{className:"flex items-center text-slate-600",children:[e.jsx(pe,{size:12,className:"mr-1.5"}),e.jsx("span",{children:s.technicalDetails.layers.join(" + ")})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-3 pt-2 border-t border-slate-100",children:[e.jsxs("div",{className:"text-xs text-brand-600 font-medium",children:["Req: ",s.calculationSnapshot.grossLinearMeters.toLocaleString(),"m"]}),e.jsxs("div",{className:"flex space-x-1",children:[s.status==="Pendiente"&&e.jsx("button",{onClick:i=>c(s.id,"En Producción",i),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded tooltip",title:"Iniciar",children:e.jsx(be,{size:16})}),s.status==="En Producción"&&e.jsx("button",{onClick:i=>c(s.id,"Terminado",i),className:"p-1.5 text-emerald-600 hover:bg-emerald-50 rounded tooltip",title:"Finalizar",children:e.jsx(Ne,{size:16})}),e.jsx("button",{onClick:i=>r(s.id,i),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded",children:e.jsx(fe,{size:16})})]})]})]})},Ct=()=>{const[s,a]=f.useState([]),[c,r]=f.useState({active:0,materials:0,clients:0}),[n,i]=f.useState(null);f.useEffect(()=>{const t=ne();a(t),r({active:t.filter(y=>y.status!=="Terminado").length,materials:ge().length,clients:ce().length})},[]);const d=(t,y,u)=>{u.stopPropagation(),lt(t,y);const C=ne();a(C),n&&n.id===t&&i(C.find(b=>b.id===t)||null)},j=(t,y)=>{y.stopPropagation(),confirm("¿Eliminar historial de orden?")&&(it(t),a(ne()),(n==null?void 0:n.id)===t&&i(null))},g=({order:t,onClose:y})=>{const[u,C]=f.useState(!1),[b,v]=f.useState(t.currentStage),p=ce(),o=ue(),S=t.clientId?p.find(N=>N.id===t.clientId):null,L=o.find(N=>N.id===t.productId);if(!t)return null;const O=N=>{if(u)return;v(N),rt(t.id,N);const x=ne();a(x)},_=()=>{C(!0),setTimeout(()=>{const N=document.getElementById("printable-order-content");if(!N){C(!1);return}const x=document.createElement("div");x.style.position="fixed",x.style.top="0",x.style.left="0",x.style.width="100vw",x.style.height="auto",x.style.minHeight="100vh",x.style.zIndex="999999",x.style.background="#ffffff",x.style.display="flex",x.style.justifyContent="center",x.style.padding="20px";const w=N.cloneNode(!0);w.style.maxHeight="none",w.style.boxShadow="none",w.style.width="100%",w.style.maxWidth="1000px",w.style.overflow="visible",x.appendChild(w),document.body.appendChild(x),window.scrollTo(0,0);const U={margin:[10,10,10,10],filename:`Orden_${t.orderCode}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,logging:!1,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}};window.html2pdf&&window.html2pdf().set(U).from(w).save().then(()=>{document.body.removeChild(x),C(!1)}).catch(ae=>{console.error(ae),document.body.removeChild(x),C(!1),alert("Error generando PDF")})},200)};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fade-in",children:e.jsxs("div",{id:"printable-order-content",className:`bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto relative ${u?"border-none p-8":""}`,children:[e.jsxs("div",{className:`justify-between items-center border-b-2 border-black pb-4 mb-6 ${u?"flex":"hidden"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Se,{size:48,className:"mr-4 text-black"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold uppercase tracking-wide text-black",children:"PCP"}),e.jsx("p",{className:"text-base font-medium text-gray-600",children:"Orden de Producción / Hoja de Ruta"})]})]}),e.jsxs("div",{className:"text-right text-black",children:[e.jsx("div",{className:"text-4xl font-bold font-mono mb-1",children:t.orderCode}),e.jsxs("div",{className:"text-sm font-medium",children:["Fecha: ",t.date]}),e.jsxs("div",{className:"flex items-center justify-end mt-2",children:[e.jsx(Os,{size:24,className:"mr-1"}),e.jsx("span",{className:"text-xs tracking-[0.2em]",children:"||| |||| || |||||"})]})]})]}),e.jsxs("div",{className:`bg-slate-900 text-white p-6 flex justify-between items-start sticky top-0 z-10 ${u?"hidden":"flex"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h2",{className:"text-2xl font-bold",children:t.orderCode}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider
                  ${t.status==="Pendiente"?"bg-amber-400 text-amber-900":t.status==="En Producción"?"bg-blue-500 text-white":"bg-emerald-500 text-white"}`,children:t.status})]}),e.jsx("p",{className:"text-slate-400 mt-1 font-medium",children:t.productName})]}),e.jsx("button",{onClick:y,className:"text-slate-400 hover:text-white p-1 bg-slate-800 rounded hover:bg-slate-700 transition-colors",children:e.jsx(Te,{size:24})})]}),e.jsxs("div",{className:`p-6 space-y-6 ${u?"text-black":""}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 avoid-break",children:[e.jsxs("div",{className:`bg-slate-50 p-5 rounded-lg border border-slate-200 ${u?"bg-white border-2 border-black":""}`,children:[e.jsxs("div",{className:"flex items-center mb-3 border-b border-slate-200 pb-2",children:[e.jsx(Oe,{size:18,className:"mr-2 text-slate-500"}),e.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500",children:"Datos del Cliente"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900 leading-tight",children:t.clientName}),e.jsxs("p",{className:"text-xs text-slate-500",children:["ID: ",t.clientId]})]}),S?e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mt-2",children:[e.jsxs("div",{className:"flex items-center text-slate-700",children:[e.jsx(Oe,{size:14,className:"mr-1.5 text-slate-400"})," ",S.contact]}),e.jsxs("div",{className:"flex items-center text-slate-700",children:[e.jsx(zs,{size:14,className:"mr-1.5 text-slate-400"})," ",S.phone||"N/A"]}),e.jsxs("div",{className:"col-span-2 flex items-center text-slate-700",children:[e.jsx(Ms,{size:14,className:"mr-1.5 text-slate-400"})," ",S.email||"N/A"]})]}):e.jsx("p",{className:"text-sm text-slate-400 italic",children:"Información detallada no disponible"})]})]}),e.jsxs("div",{className:`bg-slate-50 p-5 rounded-lg border border-slate-200 ${u?"bg-white border-2 border-black":""}`,children:[e.jsxs("div",{className:"flex items-center mb-3 border-b border-slate-200 pb-2",children:[e.jsx(Le,{size:18,className:"mr-2 text-slate-500"}),e.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500",children:"Ficha Técnica"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900 leading-tight",children:t.productName}),e.jsxs("p",{className:"text-sm font-mono font-bold text-brand-700 mt-1",children:["SKU: ",(L==null?void 0:L.sku)||"N/A"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mt-2",children:[e.jsxs("div",{className:"bg-white px-2 py-1 rounded border border-slate-100",children:[e.jsx("span",{className:"text-xs text-slate-400 block",children:"Formato"}),e.jsx("span",{className:"font-bold text-slate-800",children:t.technicalDetails.format})]}),e.jsxs("div",{className:"bg-white px-2 py-1 rounded border border-slate-100",children:[e.jsx("span",{className:"text-xs text-slate-400 block",children:"Pedido"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[t.quantityRequested," ",t.unit]})]}),e.jsxs("div",{className:`bg-blue-50 px-2 py-1 rounded border border-blue-100 text-center ${u?"bg-gray-100 border border-black":""}`,children:[e.jsx("span",{className:`text-xs text-blue-600 block font-bold uppercase ${u?"text-black":""}`,children:"Metros Producción"}),e.jsxs("span",{className:"font-bold text-lg text-blue-800",children:[t.calculationSnapshot.grossLinearMeters.toLocaleString()," m"]})]}),e.jsxs("div",{className:`bg-emerald-50 px-2 py-1 rounded border border-emerald-100 text-center ${u?"bg-gray-100 border border-black":""}`,children:[e.jsx("span",{className:`text-xs text-emerald-600 block font-bold uppercase ${u?"text-black":""}`,children:"Peso Total"}),e.jsxs("span",{className:"font-bold text-lg text-emerald-800",children:[t.calculationSnapshot.totalWeightKg.toLocaleString()," Kg"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 avoid-break",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase border-b-2 border-slate-200 pb-2 mb-4 flex items-center",children:[e.jsx(be,{size:16,className:"mr-2"})," Especificaciones de Máquina"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Pistas / Montaje"}),e.jsx("span",{className:"font-bold text-slate-800",children:t.technicalDetails.tracks})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Desarrollo (Cilindro)"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[t.technicalDetails.cylinder," mm"]})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Paso (Cutoff)"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[t.technicalDetails.cutoff," mm"]})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Ancho Bobina Impresión"}),e.jsxs("span",{className:"font-bold text-brand-600 text-black text-lg",children:[t.technicalDetails.webWidth," mm"]})]}),t.technicalDetails.windingDirection&&e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Sentido Bobinado"}),e.jsx("span",{className:"font-bold text-slate-800",children:t.technicalDetails.windingDirection})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase border-b-2 border-slate-200 pb-2 mb-4 flex items-center",children:[e.jsx(Ke,{size:16,className:"mr-2"})," Ruta de Proceso",e.jsx("span",{className:`ml-2 text-xs font-normal lowercase text-slate-400 ${u?"hidden":"inline"}`,children:"(Click para marcar etapa)"})]}),e.jsx("div",{className:"space-y-2",children:t.requiredStages.map((N,x)=>e.jsxs("div",{onClick:()=>O(N),className:`flex items-center justify-between p-3 rounded cursor-pointer transition-all ${b===N?"bg-brand-600 text-white shadow-md transform scale-[1.02]":"bg-slate-50 hover:bg-slate-100 text-slate-700"} ${u?"bg-white border border-black py-2 mb-2 text-black":""}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-6 w-6 rounded-full flex items-center justify-center text-xs font-bold mr-3 
                                   ${u?"bg-black text-white border border-black":b===N?"bg-white text-brand-600":"bg-brand-100 text-brand-600"}`,children:x+1}),e.jsx("span",{className:`font-bold uppercase text-xs ${b===N?"text-white":"text-slate-700"} ${u?"text-black":""}`,children:N})]}),u&&e.jsx("div",{className:"h-4 w-4 border border-black"}),b===N&&!u&&e.jsx(Ne,{size:16,className:"text-white"})]},x))})]})]}),e.jsxs("div",{className:"avoid-break",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase border-b-2 border-slate-200 pb-2 mb-4 flex items-center",children:[e.jsx(pe,{size:16,className:"mr-2"})," Lista de Materiales (Picking List)"]}),t.materialRequirements&&t.materialRequirements.length>0?e.jsx("div",{className:`border rounded-lg overflow-hidden ${u?"border-2 border-black":"border-slate-200"}`,children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:`bg-slate-100 text-slate-600 uppercase text-xs ${u?"bg-gray-100 text-black border-b-2 border-black":""}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Uso"}),e.jsx("th",{className:"px-4 py-2",children:"Código"}),e.jsx("th",{className:"px-4 py-2",children:"Descripción Material"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Ancho"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Cantidad"}),u&&e.jsx("th",{className:"px-4 py-2 text-center w-16",children:"OK"})]})}),e.jsxs("tbody",{className:`divide-y ${u?"divide-black":"divide-slate-100"}`,children:[t.materialRequirements.map((N,x)=>{const w=N.isSubstitute;return e.jsxs("tr",{className:w?u?"bg-white":"bg-amber-50":"",children:[e.jsxs("td",{className:"px-4 py-2 font-bold text-slate-700",children:[N.layer,w&&e.jsx("span",{className:`ml-2 text-[10px] bg-amber-200 text-amber-800 px-1.5 py-0.5 rounded uppercase ${u?"border border-black bg-white text-black":""}`,children:"Sustituto"})]}),e.jsx("td",{className:"px-4 py-2 font-mono text-brand-600 font-bold text-black",children:N.internalCode}),e.jsx("td",{className:"px-4 py-2",children:N.materialName}),e.jsxs("td",{className:"px-4 py-2 text-center font-bold",children:[N.width," mm"]}),e.jsxs("td",{className:"px-4 py-2 text-right font-bold",children:[N.requiredKg.toLocaleString()," Kg"]}),u&&e.jsx("td",{className:"border-l border-black"})]},x)}),e.jsxs("tr",{className:`bg-slate-50 ${u?"bg-white border-t-2 border-black":""}`,children:[e.jsx("td",{colSpan:4,className:"px-4 py-2 text-right font-bold text-slate-500 uppercase text-xs text-black",children:"Total Sustratos"}),e.jsxs("td",{className:"px-4 py-2 text-right font-bold",children:[(t.calculationSnapshot.layer1Kg+t.calculationSnapshot.layer2Kg+t.calculationSnapshot.layer3Kg).toLocaleString()," Kg"]}),u&&e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-4 py-2 text-right font-bold text-slate-500 uppercase text-xs text-black",children:"Insumos (Tinta/Adh)"}),e.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:[(t.calculationSnapshot.inkKg+t.calculationSnapshot.adhesiveKg).toLocaleString()," Kg"]}),u&&e.jsx("td",{})]})]})]})}):e.jsx("div",{className:"bg-amber-50 p-4 text-amber-800 rounded-lg text-sm",children:e.jsx("p",{children:"Datos detallados no disponibles para esta orden histórica."})})]}),e.jsxs("div",{className:`mt-6 pt-4 border-t-2 border-black ${u?"block":"hidden"}`,children:[e.jsx("h3",{className:"text-lg font-bold uppercase mb-6 text-center border-b border-black pb-2",children:"Control de Calidad en Planta"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"border-2 border-black p-4 avoid-break mb-4",children:[e.jsx("h4",{className:"font-bold uppercase bg-gray-100 border-b border-black p-2 text-sm mb-3",children:"1. Impresión (Prensa)"}),e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Operador / Turno:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Viscosidad Inicial:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})," ",e.jsx("span",{className:"w-32 font-bold ml-4",children:"Velocidad (m/min):"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Registro Color"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Tono vs Muestra"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Adherencia (Test)"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Limpieza"]})]}),e.jsx("div",{className:"border border-dashed border-gray-400 p-2 mt-2 h-16 text-gray-500",children:"Observaciones..."})]})]}),t.technicalDetails.layers.length>1&&e.jsxs("div",{className:"border-2 border-black p-4 avoid-break mb-4",children:[e.jsx("h4",{className:"font-bold uppercase bg-gray-100 border-b border-black p-2 text-sm mb-3",children:"2. Laminación / Solvente"}),e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Operador:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Gramaje (g/m²):"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})," ",e.jsx("span",{className:"w-32 font-bold ml-4",children:"Temperatura de Calandras:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Apariencia"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Ancho Adhesivo"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Tensiones"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Sin Burbujas"]})]})]})]}),e.jsxs("div",{className:"border-2 border-black p-4 avoid-break mb-4",children:[e.jsxs("h4",{className:"font-bold uppercase bg-gray-100 border-b border-black p-2 text-sm mb-3",children:["3. ",t.technicalDetails.format==="BOLSA"?"Bolsera (Confección)":"Refilado (Corte)"]}),e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Operador:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Cajas/Bobinas:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})," ",e.jsx("span",{className:"w-32 font-bold ml-4",children:"Cant. Rechazada:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Medidas OK"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," ",t.technicalDetails.format==="BOLSA"?"Resistencia de sellos":"Corte Limpio"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Aspecto visual"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Embalaje"]})]})]})]}),e.jsxs("div",{className:"border-2 border-black p-4 bg-gray-50 avoid-break flex justify-between items-center",children:[e.jsxs("div",{className:"w-2/3",children:[e.jsx("h4",{className:"font-bold uppercase mb-2 text-sm",children:"Liberación Final de Calidad"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Certifico que este lote cumple con las especificaciones de la ficha técnica."})]}),e.jsxs("div",{className:"w-1/3 border-l-2 border-black pl-4 text-center",children:[e.jsx("div",{className:"h-16 border-b border-black mb-1"}),e.jsx("div",{className:"text-[10px] uppercase font-bold",children:"Firma Supervisor / Calidad"})]})]})]})]})]}),e.jsxs("div",{className:`bg-slate-50 p-4 border-t border-slate-200 flex justify-end space-x-3 ${u?"hidden":"flex"}`,children:[e.jsx("button",{onClick:y,className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded-lg font-medium",children:"Cerrar"}),e.jsx("button",{type:"button",onClick:_,disabled:u,className:"px-4 py-2 bg-brand-600 text-white hover:bg-brand-700 rounded-lg font-medium flex items-center shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:u?e.jsxs(e.Fragment,{children:[e.jsx(He,{size:18,className:"mr-2 animate-spin"})," Generando PDF..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:18,className:"mr-2"})," Guardar Hoja de Ruta (PDF)"]})})]})]})})};return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Órdenes Activas"}),e.jsx("p",{className:"text-2xl font-bold text-brand-600",children:c.active})]}),e.jsx("div",{className:"bg-brand-50 p-2 rounded-full",children:e.jsx(Ke,{className:"text-brand-500"})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Materiales"}),e.jsx("p",{className:"text-2xl font-bold text-slate-800",children:c.materials})]}),e.jsx("div",{className:"bg-slate-50 p-2 rounded-full",children:e.jsx(pe,{className:"text-slate-500"})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Clientes"}),e.jsx("p",{className:"text-2xl font-bold text-slate-800",children:c.clients})]}),e.jsx("div",{className:"bg-slate-50 p-2 rounded-full",children:e.jsx(Ls,{className:"text-slate-500"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[e.jsxs("div",{className:"bg-slate-100 rounded-xl p-4 h-min min-h-[500px]",children:[e.jsxs("h3",{className:"font-bold text-slate-600 mb-4 flex items-center",children:[e.jsx(Je,{size:18,className:"mr-2"})," Pendientes",e.jsx("span",{className:"ml-2 bg-slate-200 text-slate-600 px-2 py-0.5 rounded-full text-xs",children:s.filter(t=>t.status==="Pendiente").length})]}),s.filter(t=>t.status==="Pendiente").length===0&&e.jsx("p",{className:"text-sm text-slate-400 text-center mt-10",children:"No hay órdenes pendientes"}),s.filter(t=>t.status==="Pendiente").map(t=>e.jsx(Ae,{order:t,onSelect:i,onStatusChange:d,onDelete:j},t.id))]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 h-min min-h-[500px]",children:[e.jsxs("h3",{className:"font-bold text-blue-800 mb-4 flex items-center",children:[e.jsx(be,{size:18,className:"mr-2"})," En Producción",e.jsx("span",{className:"ml-2 bg-blue-200 text-blue-800 px-2 py-0.5 rounded-full text-xs",children:s.filter(t=>t.status==="En Producción").length})]}),s.filter(t=>t.status==="En Producción").length===0&&e.jsx("p",{className:"text-sm text-blue-300 text-center mt-10",children:"Máquinas detenidas"}),s.filter(t=>t.status==="En Producción").map(t=>e.jsx(Ae,{order:t,onSelect:i,onStatusChange:d,onDelete:j},t.id))]}),e.jsxs("div",{className:"bg-emerald-50 rounded-xl p-4 h-min min-h-[500px]",children:[e.jsxs("h3",{className:"font-bold text-emerald-800 mb-4 flex items-center",children:[e.jsx(Ne,{size:18,className:"mr-2"})," Historial Reciente"]}),s.filter(t=>t.status==="Terminado").length===0&&e.jsx("p",{className:"text-sm text-emerald-300 text-center mt-10",children:"Sin historial"}),s.filter(t=>t.status==="Terminado").slice(0,5).map(t=>e.jsx(Ae,{order:t,onSelect:i,onStatusChange:d,onDelete:j},t.id)),s.filter(t=>t.status==="Terminado").length>5&&e.jsx("div",{className:"text-center mt-4",children:e.jsx("p",{className:"text-xs text-emerald-600 italic",children:"Mostrando 5 más recientes"})})]})]}),n&&e.jsx(g,{order:n,onClose:()=>i(null)})]})},St=()=>{const[s,a]=f.useState("dashboard");return e.jsxs("div",{className:"flex min-h-screen bg-slate-50 font-sans",children:[e.jsx(ht,{activeTab:s,setActiveTab:a}),e.jsx("main",{className:"flex-1 ml-64 p-8 overflow-y-auto h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("header",{className:"mb-8 flex justify-between items-center",children:e.jsx("h1",{className:"text-3xl font-bold text-slate-800 capitalize",children:s==="settings"?"Configuración":s==="queue"?"Programación":s.replace("-"," ")})}),s==="dashboard"&&e.jsx(Ct,{}),s==="queue"&&e.jsx(yt,{}),s==="calculator"&&e.jsx(gt,{}),s==="products"&&e.jsx(ft,{}),s==="materials"&&e.jsx(Nt,{}),s==="suppliers"&&e.jsx(vt,{}),s==="clients"&&e.jsx(jt,{}),s==="settings"&&e.jsx(wt,{})]})})]})},Xe=document.getElementById("root");if(!Xe)throw new Error("Could not find root element to mount to");const kt=Me.createRoot(Xe);kt.render(e.jsx(ls.StrictMode,{children:e.jsx(St,{})}));
