import{r as f,a as is,R as ds}from"./vendor-wGySg1uH.js";import{u as Y,w as cs}from"./xlsx-DrgRuPKf.js";import{L as os,a as ms,C as xs,S as hs,P as Ke,T as Ge,U as Ve,b as Je,H as us,c as pe,F as bs,d as ps,X as Fe,e as He,A as ve,G as fs,f as gs,D as js,g as Ns,h as fe,i as vs,j as ys,k as Se,l as ws,m as Qe,R as Ze,B as Be,n as Cs,o as je,p as ks,q as Ne,r as Pe,s as Ye,t as Xe,u as Ss,v as ye,w as Ps,x as Es,y as Re,z as Ds,E as qe,I as $e,J as Is,K as Os,M as We,N as Ls,O as As}from"./icons-sCqpl9_y.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const c of i)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function n(i){const c={};return i.integrity&&(c.integrity=i.integrity),i.referrerPolicy&&(c.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?c.credentials="include":i.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(i){if(i.ep)return;i.ep=!0;const c=n(i);fetch(i.href,c)}})();var es={exports:{}},Ee={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ts=f,Ms=Symbol.for("react.element"),Ks=Symbol.for("react.fragment"),Bs=Object.prototype.hasOwnProperty,Rs=Ts.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zs={key:!0,ref:!0,__self:!0,__source:!0};function ss(t,a,n){var l,i={},c=null,d=null;n!==void 0&&(c=""+n),a.key!==void 0&&(c=""+a.key),a.ref!==void 0&&(d=a.ref);for(l in a)Bs.call(a,l)&&!zs.hasOwnProperty(l)&&(i[l]=a[l]);if(t&&t.defaultProps)for(l in a=t.defaultProps,a)i[l]===void 0&&(i[l]=a[l]);return{$$typeof:Ms,type:t,key:c,ref:d,props:i,_owner:Rs.current}}Ee.Fragment=Ks;Ee.jsx=ss;Ee.jsxs=ss;es.exports=Ee;var e=es.exports,ze={},Ue=is;ze.createRoot=Ue.createRoot,ze.hydrateRoot=Ue.hydrateRoot;var z=(t=>(t.BOPP="BOPP",t.BOPP_MATE="BOPP MATE",t.BOPP_METALIZADO="BOPP METALIZADO",t.BOPP_DT="BOPP DT",t.BOPP_PERLADO="BOPP PERLADO",t.BOPP_BLANCO="BOPP BLANCO",t.PET="PET",t.PET_DT="PET DT",t.PET_PVDC="PET PVDC",t.PET_METALIZADO="PET METALIZADO",t.PE="PE",t.PE_BCO="PE BCO",t.CPP="CPP",t.BOPA="BOPA",t.PAPER="PAPEL",t.FOIL="ALUMINIO",t))(z||{});const De={BOPP:.91,"BOPP MATE":.91,"BOPP METALIZADO":.91,"BOPP DT":.91,"BOPP PERLADO":.7,"BOPP BLANCO":.95,PET:1.4,"PET DT":1.4,"PET PVDC":1.45,"PET METALIZADO":1.4,PE:.92,"PE BCO":1,CPP:.9,BOPA:1.15,PAPEL:1,ALUMINIO:2.7};var le=(t=>(t.UNITS="Unidades",t.KILOS="Kilos",t.METERS="Metros",t))(le||{});const Fs=[],_s=[],qs=[],$s=[],we={fixedStartupMeters:500,reprintMeters:300,lamination1Meters:300,lamination2Meters:300,variableScrapPercent:.05},oe=(t,a)=>{try{const n=localStorage.getItem(t);if(!n)return a;if(t==="flexo_config"){const l=JSON.parse(n);return{...a,...l}}return JSON.parse(n)}catch(n){return console.error(`Error loading ${t}`,n),a}},U=(t,a)=>{try{localStorage.setItem(t,JSON.stringify(a))}catch(n){console.error(`Error saving ${t}`,n)}};let Ce=null;const ke=t=>t.map(a=>{const n=a.layer1&&a.layer1.type?a.layer1:{type:z.BOPP,thickness:20,width:(a.webWidth||0)+20},l=a.layer2&&a.layer2.type?a.layer2:void 0,i=a.layer3&&a.layer3.type?a.layer3:void 0;return{...a,layer1:n,layer2:l,layer3:i}});let q=oe("flexo_clients",Fs),G=oe("flexo_suppliers",_s),B=oe("flexo_materials",qs),V=ke(oe("flexo_products",$s)),re=oe("flexo_config",we),T=oe("flexo_orders",[]);const M=async()=>{if(U("flexo_clients",q),U("flexo_suppliers",G),U("flexo_materials",B),U("flexo_products",V),U("flexo_orders",T),U("flexo_config",re),Ce)try{const t={clients:q,suppliers:G,materials:B,products:V,orders:T,config:re,lastModified:new Date().toISOString()},a=await Ce.createWritable();await a.write(JSON.stringify(t,null,2)),await a.close(),console.log("Auto-saved to Drive/Disk")}catch(t){console.error("Failed to auto-save to disk:",t)}},Ws=async()=>{if(typeof window.showOpenFilePicker!="function")return alert(`Tu navegador no soporta la sincronización automática (File System API). Esta función requiere Chrome, Edge o Opera en escritorio.

Para móviles o navegadores no soportados, usa la importación manual en Configuración.`),!1;try{const[t]=await window.showOpenFilePicker({types:[{description:"JSON Database",accept:{"application/json":[".json"]}}],multiple:!1});Ce=t;const n=await(await Ce.getFile()).text(),l=JSON.parse(n);return!l.clients||!l.materials?(alert("El archivo seleccionado no es una base de datos válida de PCP Enigma."),!1):(q=l.clients||[],G=l.suppliers||[],B=l.materials||[],V=ke(l.products||[]),T=l.orders||[],re={...we,...l.config||{}},M(),!0)}catch(t){return t.name==="AbortError"?!1:t.name==="SecurityError"||t.message&&t.message.includes("Cross origin")?(alert(`⚠️ Restricción de Entorno Detectada

Estás ejecutando la App en un entorno restringido (iframe) que bloquea el acceso directo al disco duro.

SOLUCIÓN:
1. Ejecuta el proyecto localmente o despliégalo en GitHub Pages.
2. Mientras tanto, usa la opción 'Configuración > Importar/Restaurar' para cargar tus datos manualmente.`),!1):(console.error("Error connecting DB:",t),alert("Error al conectar: "+t.message),!1)}},ce=()=>[...q],ue=()=>[...G],ge=()=>[...B],be=()=>[...V],ts=()=>({...re}),de=()=>[...T].sort((t,a)=>(t.queueIndex||0)-(a.queueIndex||0)),Us=t=>{const a=V.findIndex(n=>n.id===t.id);a>=0?V[a]=t:V.push(t),M()},Gs=t=>{V=V.filter(a=>a.id!==t),M()},Vs=t=>{const a=q.findIndex(n=>n.id===t.id);a>=0?q[a]=t:q.push(t),M()},Js=t=>{q=q.filter(a=>a.id!==t),M()},Hs=t=>{const a=G.findIndex(n=>n.id===t.id);a>=0?G[a]=t:G.push(t),M()},Qs=t=>{G=G.filter(a=>a.id!==t),M()},Zs=t=>{const a=B.findIndex(n=>n.id===t.id);a>=0?B[a]=t:B.push(t),M()},Ys=t=>{B=B.filter(a=>a.id!==t),M()},Xs=t=>{if(t.queueIndex===void 0){const n=T.reduce((l,i)=>Math.max(l,i.queueIndex||0),0);t.queueIndex=n+1}const a=T.findIndex(n=>n.id===t.id);a>=0?T[a]=t:T.push(t),M()},et=(t,a)=>{const n=T.find(l=>l.id===t);n&&(n.status=a,M())},st=(t,a)=>{const n=T.find(l=>l.id===t);n&&(n.currentStage=a,M())},tt=t=>{t.forEach((a,n)=>{const l=T.find(i=>i.id===a.id);l&&(l.queueIndex=n)}),M()},at=t=>{T=T.filter(a=>a.id!==t),M()},Ae=(t,a)=>{const n=B.findIndex(l=>l.id===t);return n>=0?(B[n].currentStockKg=Math.max(0,B[n].currentStockKg-a),M(),!0):!1},lt=t=>{re={...re,...t},M()},rt=()=>{const t=Y.book_new(),a=T.map(g=>({Codigo:g.orderCode,Fecha:g.date,Cliente:g.clientName,Producto:g.productName,Estado:g.status,"Etapa Actual":g.currentStage||"Inicio",Pedido:`${g.quantityRequested} ${g.unit}`,"Metros Brutos":g.calculationSnapshot.grossLinearMeters,"Peso Total (Kg)":g.calculationSnapshot.totalWeightKg,Etapas:g.requiredStages.join(", ")})),n=Y.json_to_sheet(a);Y.book_append_sheet(t,n,"Historial Producción");const l=Y.json_to_sheet(q);Y.book_append_sheet(t,l,"Clientes");const i=Y.json_to_sheet(G);Y.book_append_sheet(t,i,"Proveedores");const c=Y.json_to_sheet(B);Y.book_append_sheet(t,c,"Inventario");const d=V.map(g=>{var C,h,P;const s=((C=q.find(p=>p.id===g.clientId))==null?void 0:C.name)||"N/A";return{SKU:g.sku,Producto:g.name,Cliente:s,Formato:g.format,"Ancho Impresión":g.webWidth,"Capa 1 Tipo":g.layer1.type,"Capa 1 Mic":g.layer1.thickness,"Capa 2 Tipo":((h=g.layer2)==null?void 0:h.type)||"-","Capa 3 Tipo":((P=g.layer3)==null?void 0:P.type)||"-","% Merma Ficha":g.specificScrapPercent?g.specificScrapPercent*100:"Default"}}),x=Y.json_to_sheet(d);Y.book_append_sheet(t,x,"Fichas Técnicas"),cs(t,"PCP_Enigma_DB.xlsx")},nt=()=>{const t={clients:q,suppliers:G,materials:B,products:V,orders:T,config:re,exportedAt:new Date().toISOString()},a="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t,null,2)),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",`pcp_backup_${new Date().toISOString().split("T")[0]}.json`),document.body.appendChild(n),n.click(),n.remove()},it=async t=>new Promise((a,n)=>{const l=new FileReader;l.onload=i=>{var c;try{const d=JSON.parse((c=i.target)==null?void 0:c.result);if(!d.clients||!d.materials||!d.products){alert("Archivo inválido: Estructura de datos incorrecta."),a(!1);return}confirm("ADVERTENCIA: Esto borrará los datos actuales y cargará los del archivo. ¿Continuar?")?(U("flexo_clients",d.clients),U("flexo_suppliers",d.suppliers||[]),U("flexo_materials",d.materials),U("flexo_products",ke(d.products)),U("flexo_orders",d.orders),U("flexo_config",{...we,...d.config||{}}),q=d.clients,G=d.suppliers||[],B=d.materials,V=ke(d.products),T=d.orders,re={...we,...d.config||{}},a(!0)):a(!1)}catch(d){console.error(d),alert("Error leyendo el archivo JSON."),a(!1)}},l.readAsText(t)}),dt=({activeTab:t,setActiveTab:a})=>{const[n,l]=f.useState(!1),i=async()=>{const d=await Ws();l(d),d&&alert("Conectado con éxito. Los cambios se guardarán automáticamente en el archivo.")},c=[{id:"dashboard",label:"Dashboard",icon:os},{id:"queue",label:"Fila de Producción",icon:ms},{id:"calculator",label:"Calculadora Prod.",icon:xs},{id:"products",label:"Fichas Técnicas",icon:hs},{id:"materials",label:"Inventario",icon:Ke},{id:"suppliers",label:"Proveedores",icon:Ge},{id:"clients",label:"Clientes",icon:Ve}];return e.jsxs("aside",{className:"w-64 bg-slate-900 text-white h-screen fixed left-0 top-0 flex flex-col shadow-xl z-50",children:[e.jsxs("div",{className:"p-6 border-b border-slate-700",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight text-brand-500",children:"PCP"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Enigma v2.1"})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:c.map(d=>{const x=d.icon;return e.jsxs("button",{onClick:()=>a(d.id),className:`w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors duration-200 ${t===d.id?"bg-brand-600 text-white shadow-lg":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[e.jsx(x,{size:20}),e.jsx("span",{className:"font-medium",children:d.label})]},d.id)})}),e.jsxs("div",{className:"p-4 bg-slate-800 mx-4 mb-4 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Estado Conexión"}),n?e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500 shadow-[0_0_5px_#22c55e]"}):e.jsx("div",{className:"h-2 w-2 rounded-full bg-slate-500"})]}),e.jsx("button",{onClick:i,className:`w-full text-xs font-bold py-2 px-2 rounded flex items-center justify-center transition-all ${n?"bg-green-900/30 text-green-400 border border-green-800 cursor-default":"bg-brand-700 hover:bg-brand-600 text-white shadow-md"}`,children:n?e.jsxs(e.Fragment,{children:[e.jsx(Je,{size:12,className:"mr-1.5"})," BD Sincronizada"]}):e.jsxs(e.Fragment,{children:[e.jsx(us,{size:12,className:"mr-1.5"})," Conectar BD"]})})]}),e.jsx("div",{className:"p-4 border-t border-slate-700",children:e.jsxs("button",{onClick:()=>a("settings"),className:`flex items-center space-x-3 px-4 py-2 w-full transition-colors ${t==="settings"?"text-brand-400 font-bold":"text-slate-400 hover:text-white"}`,children:[e.jsx(pe,{size:18}),e.jsx("span",{className:"text-sm",children:"Configuración"})]})})]})},ae=(t,a,n)=>{const i=(n.width&&n.width>0?n.width:t+20)/1e3,c=De[n.type]||.91;return i*a*n.thickness*c/1e3},Te=(t,a)=>{const n=a.width/1e3,l=a.density||De[a.type]||.91;return n*t*a.thickness*l/1e3},ct=(t,a)=>{const n=a.width/1e3,l=a.density||De[a.type]||.91,i=n*a.thickness*l;return i===0?0:t*1e3/i},ot=(t,a,n,l,i,c)=>{const d=ts(),x=l.specificScrapPercent!==void 0?l.specificScrapPercent:d.variableScrapPercent,g=l.tracks>0?l.tracks:1;let s=0;if(n===le.METERS)s=t/g;else if(n===le.UNITS)s=t*l.cutoff/(g*1e3);else if(n===le.KILOS){let H=ae(l.webWidth,1,l.layer1);l.layer2&&(H+=ae(l.webWidth,1,l.layer2)),l.layer3&&(H+=ae(l.webWidth,1,l.layer3));const L=l.webWidth/1e3,me=L*1*l.inkCoverage/1e3;let X=1;l.layer2&&X++,l.layer3&&X++;const Ie=X>1?(X-1)*(L*1*l.adhesiveCoverage)/1e3:0,xe=H+me+Ie;s=t/xe}const C=(c==null?void 0:c.startup)!==void 0?c.startup:d.fixedStartupMeters,h=(l.layer1.type===z.BOPP_DT||l.layer1.type===z.PET_DT)&&d.reprintMeters||0,P=(c==null?void 0:c.reprint)!==void 0?c.reprint:h,p=l.layer2&&d.lamination1Meters||0,v=l.layer3&&d.lamination2Meters||0,N=(c==null?void 0:c.lamination)!==void 0?c.lamination:p+v,o=Math.ceil(s*x),E=(c==null?void 0:c.variable)!==void 0?c.variable:o,F=C+P+N+E,$=Math.ceil(s+F),se=s*(a/100),j=Math.ceil($+se),y=ae(l.webWidth,$,l.layer1),k=l.layer2?ae(l.webWidth,$,l.layer2):0,J=l.layer3?ae(l.webWidth,$,l.layer3):0,te=ae(l.webWidth,j,l.layer1),r=l.layer2?ae(l.webWidth,j,l.layer2):0,K=l.layer3?ae(l.webWidth,j,l.layer3):0,b=H=>{const L=l.webWidth/1e3*H,me=L*l.inkCoverage/1e3;let X=0;return l.layer2&&(X+=L*l.adhesiveCoverage/1e3),l.layer3&&(X+=L*l.adhesiveCoverage/1e3),{ink:me,adhesive:X}},O=b($),u=b(j);return{requiredLinearMeters:Math.ceil(s),grossLinearMeters:$,maxLinearMetersWithTolerance:j,scrapMeters:F,scrapBreakdown:{startup:C,reprint:P,lamination:N,variable:E},layer1Kg:Number(y.toFixed(2)),layer2Kg:Number(k.toFixed(2)),layer3Kg:Number(J.toFixed(2)),inkKg:Number(O.ink.toFixed(2)),adhesiveKg:Number(O.adhesive.toFixed(2)),maxLayer1Kg:Number(te.toFixed(2)),maxLayer2Kg:Number(r.toFixed(2)),maxLayer3Kg:Number(K.toFixed(2)),maxInkKg:Number(u.ink.toFixed(2)),maxAdhesiveKg:Number(u.adhesive.toFixed(2)),totalWeightKg:Number((y+k+J+O.ink+O.adhesive).toFixed(2))}},mt=()=>{const t=ce(),a=be(),n=ge(),[l,i]=f.useState(""),[c,d]=f.useState(""),[x,g]=f.useState(0),[s,C]=f.useState(10),[h,P]=f.useState(!1),[p,v]=f.useState({success:!1}),[N,o]=f.useState(le.UNITS),[E,F]=f.useState(void 0),[$,se]=f.useState(!1),[j,y]=f.useState({startup:0,reprint:0,lamination:0,variable:0}),[k,J]=f.useState({}),[te,r]=f.useState({}),K=f.useMemo(()=>a.filter(m=>m.clientId===l),[l,a]),b=f.useMemo(()=>a.find(m=>m.id===c),[c,a]);f.useEffect(()=>{J({}),r({}),P(!1),F(void 0)},[c]);const O=(m,R)=>{const I=m.width||R;return n.filter(S=>S.type===m.type&&S.width>=I&&S.currentStockKg>0).map(S=>{const D=Math.abs(S.thickness-m.thickness),Z=S.width-I,ne=D/m.thickness,w=D===0,W=[];w||(W.push(`Espesor difiere en ${D}μ`),ne>.2&&W.push("¡FUERA DE TOLERANCIA DE ESPESOR!")),Z>0&&W.push(`+${Z}mm de ancho`);let ee=0;return w||(ee+=1e3+D*100),ee+=Z,ne>.3&&(ee+=1e4),{material:S,isExactThickness:w,thicknessDiff:D,widthDiff:Z,score:ee,notes:W}}).sort((S,D)=>S.score-D.score)};f.useEffect(()=>{if(b){const m=(R,I)=>{if(!I)return;const Q=O(I,b.webWidth);Q.length>0&&!k[R]&&J(_=>({..._,[R]:Q[0].material.id}))};m("layer1",b.layer1),m("layer2",b.layer2),m("layer3",b.layer3)}},[b,x]);let u=null,H=null,L={layer1:{stockOk:!0,missingKg:0,requiredRealKg:0},layer2:{stockOk:!0,missingKg:0,requiredRealKg:0},layer3:{stockOk:!0,missingKg:0,requiredRealKg:0}};if(b&&x>0)try{u=ot(x,s,N,b,n,E);const m=(R,I)=>{const Q=h?u.maxLinearMetersWithTolerance:u.grossLinearMeters,_=k[R];if(!_)return{stockOk:!1,missingKg:I,requiredRealKg:I};const S=n.find(Z=>Z.id===_);if(!S)return{stockOk:!1,missingKg:I,requiredRealKg:I};const D=Te(Q,S);return S.currentStockKg<D?{stockOk:!1,missingKg:D-S.currentStockKg,requiredRealKg:D}:{stockOk:!0,missingKg:0,requiredRealKg:D}};L.layer1=m("layer1",u.layer1Kg),b.layer2&&(L.layer2=m("layer2",u.layer2Kg)),b.layer3&&(L.layer3=m("layer3",u.layer3Kg))}catch(m){H=m.message}const me=()=>{u&&(y({...u.scrapBreakdown}),se(!0))},X=()=>{F(j),se(!1)},Ie=()=>{var ne;if(!u||!b)return;if(!k.layer1){alert("Debe seleccionar un material para la Capa 1");return}if(b.layer2&&!k.layer2){alert("Debe seleccionar un material para la Capa 2");return}if(b.layer3&&!k.layer3){alert("Debe seleccionar un material para la Capa 3");return}const m=[],R=[],I=(w,W,ee)=>{if(W<=0)return;const ls=k[w],A=n.find(he=>he.id===ls);if(!A)return;R.push(A.name);const Oe=Te(W,A),rs=te[w],ie=n.find(he=>he.id===rs);if(A.currentStockKg<Oe&&ie){const he=ct(A.currentStockKg,A),ns=W-he,Le=Math.max(0,A.currentStockKg),_e=Te(ns,ie);Le>0&&(Ae(A.id,Le),m.push({layer:ee,materialName:A.name,internalCode:A.internalCode,width:A.width,requiredKg:Number(Le.toFixed(2))})),Ae(ie.id,_e),m.push({layer:`${ee} (COMPLEMENTO)`,materialName:ie.name,internalCode:ie.internalCode,width:ie.width,requiredKg:Number(_e.toFixed(2)),isSubstitute:!0,originalMaterialId:A.id})}else Ae(A.id,Oe),m.push({layer:ee,materialName:A.name,internalCode:A.internalCode,width:A.width,requiredKg:Number(Oe.toFixed(2))})},_=h?u.maxLinearMetersWithTolerance:u.grossLinearMeters;I("layer1",_,"Capa 1 (Imp)"),b.layer2&&I("layer2",_,"Capa 2 (Lam)"),b.layer3&&I("layer3",_,"Capa 3 (Sell)");const S=["Impresión"];(b.layer1.type===z.BOPP_DT||b.layer1.type===z.PET_DT)&&S.push("Reimpresión"),b.layer2&&S.push("Laminación"),b.layer3&&S.push("Trilaminado"),S.push("Refilado"),b.format==="BOLSA"&&S.push("Confección (Bolsera)");const D=`OP-${1e3+de().length+1}`,Z={id:`ord-${Date.now()}`,orderCode:D,productId:b.id,productName:b.name,clientId:l,clientName:((ne=t.find(w=>w.id===l))==null?void 0:ne.name)||"Desconocido",date:new Date().toISOString().split("T")[0],quantityRequested:x,unit:N,tolerancePercent:s,calculationSnapshot:u,technicalDetails:{format:b.format,webWidth:b.webWidth,cylinder:b.cylinder,cutoff:b.cutoff,tracks:b.tracks,layers:R,windingDirection:b.windingDirection},materialRequirements:m,requiredStages:S,status:"Pendiente",currentStage:void 0};Xs(Z),v({success:!0,code:D}),setTimeout(()=>{v({success:!1}),g(0),F(void 0)},4e3)},xe=({layerKey:m,spec:R,theoreticalKg:I,analysis:Q})=>{if(!b)return null;const _=O(R,b.webWidth),S=k[m],D=n.find(w=>w.id===S),Z=D?Q.requiredRealKg:I,ne=D&&Q.requiredRealKg>I*1.05;return e.jsxs("div",{className:"mb-6 bg-white border border-slate-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 uppercase text-sm",children:m==="layer1"?"Capa 1 (Impresión)":m==="layer2"?"Capa 2 (Laminación)":"Capa 3 (Sellante)"}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Req: ",R.type," ",R.thickness,"μ | Ancho Ideal: ",R.width||b.webWidth,"mm"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`text-xl font-bold ${ne?"text-amber-600":"text-slate-800"}`,children:[Z.toLocaleString()," Kg"]}),e.jsx("div",{className:"text-[10px] text-slate-400 font-medium",children:D?"(Cálculo Real)":"(Estimado Teórico)"})]})]}),e.jsxs("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-1",children:[_.length===0&&e.jsx("p",{className:"text-xs text-red-500 italic",children:"No hay inventario compatible para este tipo."}),_.map((w,W)=>e.jsxs("div",{onClick:()=>J(ee=>({...ee,[m]:w.material.id})),className:`p-2 rounded border cursor-pointer transition-all flex justify-between items-center
                            ${S===w.material.id?"bg-brand-50 border-brand-500 ring-1 ring-brand-500":"bg-slate-50 border-slate-200 hover:border-brand-300"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-sm text-slate-800 flex items-center",children:[W===0&&e.jsx(vs,{size:12,className:"text-amber-500 mr-1"}),w.material.name,e.jsxs("span",{className:"ml-2 font-mono text-xs text-slate-500",children:["[",w.material.internalCode,"]"]})]}),e.jsxs("div",{className:"text-xs text-slate-600 flex space-x-2",children:[e.jsxs("span",{children:[w.material.width,"mm"]}),e.jsxs("span",{children:[w.material.thickness,"μ"]}),e.jsxs("span",{className:w.material.currentStockKg<Z?"text-red-500 font-bold":"text-emerald-600 font-bold",children:["Stock: ",w.material.currentStockKg," Kg"]})]}),w.notes.length>0&&e.jsx("div",{className:"text-[10px] text-amber-600 font-bold mt-1",children:w.notes.join(" | ")})]}),S===w.material.id&&e.jsx(Je,{size:18,className:"text-brand-600"})]},w.material.id))]}),D&&!Q.stockOk&&e.jsxs("div",{className:"mt-3 p-2 bg-red-50 border border-red-200 rounded text-xs",children:[e.jsxs("p",{className:"font-bold text-red-700 flex items-center mb-2",children:[e.jsx(ys,{size:14,className:"mr-1"})," Falta Stock: ",Q.missingKg.toLocaleString()," Kg"]}),e.jsx("p",{className:"mb-2",children:"Seleccione una bobina adicional para completar:"}),e.jsxs("select",{className:"w-full border p-1 rounded",onChange:w=>r(W=>({...W,[m]:w.target.value})),value:te[m]||"",children:[e.jsx("option",{value:"",children:"-- Seleccionar Sustituto --"}),_.filter(w=>w.material.id!==S).map(w=>e.jsxs("option",{value:w.material.id,children:[w.material.name," (",w.material.width,"mm) - Stock: ",w.material.currentStockKg]},w.material.id))]})]})]})};return p.success?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-12 text-center animate-fade-in",children:[e.jsx("div",{className:"bg-green-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(bs,{size:40,className:"text-green-600"})}),e.jsxs("h2",{className:"text-2xl font-bold text-green-800 mb-2",children:["¡Orden ",p.code," Generada!"]}),e.jsx("p",{className:"text-green-700 mb-4",children:"Se ha creado la hoja de ruta, guardado el historial y descontado el material."}),e.jsx("button",{onClick:()=>v({success:!1}),className:"mt-6 text-green-800 underline font-bold",children:"Volver a calcular"})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in relative",children:[$&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl w-full max-w-sm border border-slate-200 animate-scale-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsxs("h3",{className:"font-bold text-slate-800 flex items-center",children:[e.jsx(ps,{size:18,className:"mr-2 text-brand-600"})," Ajuste Manual de Mermas"]}),e.jsx("button",{onClick:()=>se(!1),className:"text-slate-400 hover:text-slate-600",children:e.jsx(Fe,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Ajuste Impresión (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none font-bold text-slate-800",value:j.startup,onChange:m=>y({...j,startup:Number(m.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Reimpresión (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-purple-500 outline-none font-bold text-slate-800",value:j.reprint,onChange:m=>y({...j,reprint:Number(m.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Laminación (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-blue-500 outline-none font-bold text-slate-800",value:j.lamination,onChange:m=>y({...j,lamination:Number(m.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500",children:"Variable (m)"}),e.jsx("input",{type:"number",className:"w-full border p-2 rounded focus:ring-2 focus:ring-amber-500 outline-none font-bold text-slate-800",value:j.variable,onChange:m=>y({...j,variable:Number(m.target.value)})})]})]}),e.jsx("button",{onClick:X,className:"w-full mt-6 bg-brand-600 text-white py-2 rounded-lg font-bold hover:bg-brand-700",children:"Aplicar Cambios"})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 mb-4 flex items-center",children:[e.jsx(He,{className:"mr-2 text-brand-600"}),"Calculadora de Producción"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Cliente"}),e.jsxs("select",{className:"w-full rounded-lg border-slate-300 border p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none",value:l,onChange:m=>{i(m.target.value),d("")},children:[e.jsx("option",{value:"",children:"Seleccionar..."}),t.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Producto (SKU)"}),e.jsxs("select",{className:"w-full rounded-lg border-slate-300 border p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none",value:c,onChange:m=>d(m.target.value),disabled:!l,children:[e.jsx("option",{value:"",children:"Seleccionar Ficha..."}),K.map(m=>e.jsxs("option",{value:m.id,children:[m.sku," - ",m.name," (",m.format,")"]},m.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Cantidad Pedida"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"number",className:"w-full rounded-l-lg border-slate-300 border-y border-l p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none",value:x||"",onChange:m=>g(Number(m.target.value)),placeholder:"0"}),e.jsxs("select",{className:"bg-slate-100 rounded-r-lg border-slate-300 border p-2.5 focus:outline-none text-sm",value:N,onChange:m=>o(m.target.value),children:[e.jsx("option",{value:le.UNITS,children:"Ud."}),e.jsx("option",{value:le.KILOS,children:"Kg"}),e.jsx("option",{value:le.METERS,children:"m"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"Tolerancia (+)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",className:"w-full rounded-lg border-slate-300 border p-2.5 focus:ring-2 focus:ring-brand-500 focus:outline-none pr-8",value:s,onChange:m=>C(Number(m.target.value))}),e.jsx("span",{className:"absolute right-3 top-2.5 text-slate-400 font-bold",children:"%"})]})]})]}),H&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 text-red-700 rounded-lg flex items-center text-sm font-medium",children:[e.jsx(ve,{className:"mr-2",size:18})," ",H]})]}),u&&b&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-slate-900 text-white rounded-xl shadow-lg p-6",children:[e.jsxs("h3",{className:"text-sm font-bold uppercase text-slate-400 mb-4 flex items-center",children:[e.jsx(fs,{size:16,className:"mr-2"})," Metros a Producir (Bruto)"]}),e.jsxs("div",{className:"text-4xl font-bold mb-2 text-brand-400",children:[u.grossLinearMeters.toLocaleString()," m"]}),e.jsxs("div",{className:"mb-4 group cursor-pointer p-2 rounded-lg hover:bg-slate-800 transition-all hover:scale-[1.02] border border-transparent hover:border-slate-600 relative",onClick:me,title:"Click para editar metros de merma manualmente",children:[e.jsx("div",{className:"absolute top-2 right-2 text-slate-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(gs,{size:14})}),e.jsxs("div",{className:"flex h-2 rounded-full overflow-hidden mb-2 bg-slate-700",children:[e.jsx("div",{style:{width:`${u.scrapBreakdown.startup/u.grossLinearMeters*100}%`},className:"bg-slate-400",title:"Ajuste Impresión"}),e.jsx("div",{style:{width:`${u.scrapBreakdown.reprint/u.grossLinearMeters*100}%`},className:"bg-purple-500",title:"Reprint"}),e.jsx("div",{style:{width:`${u.scrapBreakdown.lamination/u.grossLinearMeters*100}%`},className:"bg-blue-500",title:"Laminación"}),e.jsx("div",{style:{width:`${u.scrapBreakdown.variable/u.grossLinearMeters*100}%`},className:"bg-amber-500",title:"Variable"}),e.jsx("div",{className:"flex-1 bg-emerald-500 opacity-20"})]}),e.jsxs("div",{className:"text-[10px] text-slate-300 grid grid-cols-2 gap-x-2 gap-y-1 group-hover:text-white",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-slate-400 mr-1.5"})," Ajuste Imp: ",u.scrapBreakdown.startup,"m"]}),u.scrapBreakdown.reprint>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-purple-500 mr-1.5"})," Reprint: ",u.scrapBreakdown.reprint,"m"]}),u.scrapBreakdown.lamination>0&&e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mr-1.5"})," Laminación: ",u.scrapBreakdown.lamination,"m"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500 mr-1.5"})," Variable: ",u.scrapBreakdown.variable,"m"]})]}),e.jsxs("div",{className:"text-right text-xs font-bold text-slate-400 mt-2 border-t border-slate-700 pt-1 group-hover:text-brand-300",children:["Total Merma: ",u.scrapMeters,"m ",E&&"(Manual)"]})]}),e.jsxs("div",{className:"border-t border-slate-700 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"block text-xs text-slate-500 uppercase",children:["Máximo (+",s,"%)"]}),e.jsxs("span",{className:"block text-lg font-bold",children:[u.maxLinearMetersWithTolerance.toLocaleString()," m"]})]}),e.jsxs("div",{className:"flex items-center bg-slate-800 p-2 rounded border border-slate-600",children:[e.jsx("input",{type:"checkbox",id:"useTolerance",checked:h,onChange:m=>P(m.target.checked),className:"w-4 h-4 text-brand-600 rounded bg-slate-700 border-slate-500 focus:ring-brand-500"}),e.jsx("label",{htmlFor:"useTolerance",className:"ml-2 text-xs font-bold text-slate-300 cursor-pointer select-none",children:"Usar Máx."})]})]}),e.jsxs("div",{className:"bg-slate-800/50 p-2 rounded",children:[e.jsx("span",{className:"block text-xs text-slate-500 uppercase",children:"Pedido Neto"}),e.jsxs("span",{className:"block text-md font-bold text-emerald-400",children:[u.requiredLinearMeters.toLocaleString()," m"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:[e.jsxs("h3",{className:"font-bold text-slate-800 mb-4 flex items-center uppercase text-sm",children:[e.jsx(js,{size:16,className:"mr-2"})," Insumos Estimados ",h&&"(Max)"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[e.jsx("span",{className:"text-slate-600",children:"Tintas Total"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[h?u.maxInkKg:u.inkKg," Kg"]})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-2",children:[e.jsx("span",{className:"text-slate-600",children:"Adhesivos"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[h?u.maxAdhesiveKg:u.adhesiveKg," Kg"]})]}),e.jsxs("div",{className:"flex justify-between pt-2",children:[e.jsx("span",{className:"text-brand-600 font-bold",children:"Peso Total Orden"}),e.jsxs("span",{className:"font-bold text-xl text-brand-700",children:[((L.layer1.requiredRealKg||u.layer1Kg)+(b.layer2?L.layer2.requiredRealKg||u.layer2Kg:0)+(b.layer3?L.layer3.requiredRealKg||u.layer3Kg:0)+(h?u.maxInkKg:u.inkKg)+(h?u.maxAdhesiveKg:u.adhesiveKg)).toLocaleString()," Kg"]})]})]})]}),e.jsxs("button",{onClick:Ie,disabled:!k.layer1||!!b.layer2&&!k.layer2||!!b.layer3&&!k.layer3,className:"w-full py-4 bg-brand-600 hover:bg-brand-700 disabled:bg-slate-300 disabled:cursor-not-allowed text-white rounded-xl font-bold text-lg shadow-lg transition-all flex justify-center items-center",children:[e.jsx(Ns,{size:24,className:"mr-2"})," Confirmar Producción"]})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("div",{className:"bg-slate-100 rounded-xl p-6 h-full",children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4 flex items-center uppercase text-sm",children:[e.jsx(fe,{size:16,className:"mr-2"})," Asignación de Materiales"]}),e.jsxs("p",{className:"text-xs text-slate-500 mb-6",children:["Seleccione la bobina exacta del inventario para cada capa.",e.jsx("br",{}),e.jsx("span",{className:"text-brand-600 font-bold",children:"Nota:"})," Se muestran solo materiales compatibles (Mismo Tipo, Ancho ",">="," ",b.webWidth,"mm)."]}),e.jsx(xe,{layerKey:"layer1",spec:b.layer1,theoreticalKg:h?u.maxLayer1Kg:u.layer1Kg,analysis:L.layer1}),b.layer2&&e.jsx(xe,{layerKey:"layer2",spec:b.layer2,theoreticalKg:h?u.maxLayer2Kg:u.layer2Kg,analysis:L.layer2}),b.layer3&&e.jsx(xe,{layerKey:"layer3",spec:b.layer3,theoreticalKg:h?u.maxLayer3Kg:u.layer3Kg,analysis:L.layer3})]})})]})]})},xt=()=>{var y,k,J,te;ge();const t=ce(),[a,n]=f.useState("list"),[l,i]=f.useState(be()),[c,d]=f.useState(""),x={type:z.BOPP,thickness:20,width:0},g={format:"BOBINA",tracks:1,inkCoverage:3,adhesiveCoverage:1.8,specificScrapPercent:.05,windingDirection:"A1",layer1:{...x}},[s,C]=f.useState(g),[h,P]=f.useState(!1);f.useEffect(()=>{i(be())},[a]);const p=r=>{C(r),n("form")},v=r=>{confirm("¿Estás seguro de eliminar esta ficha técnica? Se borrará del historial.")&&(Gs(r),i(be()))},N=r=>{if(r.preventDefault(),s.name&&s.clientId&&s.layer1){const K={...s,id:s.id||`p${Date.now()}`};Us(K),P(!0),setTimeout(()=>{P(!1),n("list")},1500)}},o=(r,K)=>{C(b=>({...b,[r]:K}))},E=(r,K,b)=>{C(O=>{const u=O[r]||{...x};return{...O,[r]:{...u,[K]:b}}})},F=(r,K)=>{C(b=>{if(K)return{...b,[r]:{...x}};{const O={...b};return delete O[r],O}})},$=()=>{a==="list"?(C(g),n("form")):n("list")},se=[...["A","B","C","D","E","F","G"].flatMap(r=>[1,2,3,4,5,6].map(K=>`${r}${K}`))],j=l.filter(r=>r.name.toLowerCase().includes(c.toLowerCase())||r.sku.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:a==="list"?"Fichas Técnicas":s.id?"Editar Ficha":"Nueva Ficha Técnica"}),e.jsx("p",{className:"text-sm text-slate-500",children:a==="list"?"Gestiona las recetas de producción":"Define estructura ideal y parámetros"})]}),e.jsx("button",{onClick:$,className:`px-4 py-2 rounded-lg font-medium text-sm flex items-center transition-colors ${a==="list"?"bg-brand-600 text-white hover:bg-brand-700 shadow-md":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:a==="list"?e.jsxs(e.Fragment,{children:[e.jsx(Se,{size:18,className:"mr-2"})," Nueva Ficha"]}):e.jsxs(e.Fragment,{children:[e.jsx(ws,{size:18,className:"mr-2"})," Ver Listado"]})})]}),a==="list"&&e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-100",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx(Qe,{className:"absolute left-3 top-2.5 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Buscar por nombre o SKU...",className:"pl-10 pr-4 py-2 w-full border rounded-lg focus:ring-2 focus:ring-brand-500 outline-none",value:c,onChange:r=>d(r.target.value)})]})}),e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 font-semibold",children:"SKU / Producto"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Estructura"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Dimensiones"}),e.jsx("th",{className:"px-6 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[j.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-slate-400",children:"No hay productos registrados."})}),j.map(r=>{var b,O,u;const K=((b=t.find(H=>H.id===r.clientId))==null?void 0:b.name)||"N/A";return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-slate-800",children:r.name}),e.jsx("div",{className:"text-xs text-slate-500 font-mono",children:r.sku})]}),e.jsx("td",{className:"px-6 py-4 text-slate-600",children:K}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-xs space-y-1",children:[e.jsxs("div",{className:"font-bold text-brand-700",children:[((O=r.layer1)==null?void 0:O.type)||"N/A"," ",((u=r.layer1)==null?void 0:u.thickness)||0,"μ"]}),r.layer2&&e.jsxs("div",{className:"text-slate-600",children:["+ ",r.layer2.type," ",r.layer2.thickness,"μ"]}),r.layer3&&e.jsxs("div",{className:"text-slate-600",children:["+ ",r.layer3.type," ",r.layer3.thickness,"μ"]})]})}),e.jsxs("td",{className:"px-6 py-4 text-slate-600 text-xs space-y-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ze,{size:12,className:"mr-1"})," Ancho Imp: ",r.webWidth,"mm"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(fe,{size:12,className:"mr-1"})," Pistas: ",r.tracks]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{size:12,className:"mr-1"})," Paso: ",r.cutoff,"mm"]})]}),e.jsxs("td",{className:"px-6 py-4 text-right space-x-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>p(r),className:"text-brand-600 hover:bg-brand-50 p-1.5 rounded tooltip",title:"Editar",children:e.jsx(Cs,{size:18})}),e.jsx("button",{onClick:()=>v(r.id),className:"text-red-500 hover:bg-red-50 p-1.5 rounded tooltip",title:"Eliminar",children:e.jsx(je,{size:18})})]})]},r.id)})]})]})]}),a==="form"&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 max-w-5xl mx-auto p-8 animate-fade-in",children:e.jsxs("form",{onSubmit:N,className:"space-y-8",children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-slate-400 mb-4",children:"1. Información Comercial"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Cliente"}),e.jsxs("select",{className:"input-field",required:!0,value:s.clientId,onChange:r=>o("clientId",r.target.value),children:[e.jsx("option",{value:"",children:"Seleccionar..."}),t.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"SKU / Código"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Ej. BOL-500G",value:s.sku||"",onChange:r=>o("sku",r.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Nombre del Producto"}),e.jsx("input",{type:"text",className:"input-field",placeholder:"Ej. Bolsa Arroz 500g Premium",required:!0,value:s.name||"",onChange:r=>o("name",r.target.value)})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-slate-400 mb-4",children:"2. Formato y Dimensiones"}),e.jsxs("div",{className:"flex space-x-4 mb-6",children:[e.jsxs("button",{type:"button",onClick:()=>o("format","BOBINA"),className:`flex items-center px-6 py-3 rounded-lg border-2 transition-all ${s.format==="BOBINA"?"border-brand-500 bg-brand-50 text-brand-700":"border-slate-200 text-slate-500 hover:border-slate-300"}`,children:[e.jsx(ks,{className:"mr-2",size:20})," Bobina (Reel)"]}),e.jsxs("button",{type:"button",onClick:()=>o("format","BOLSA"),className:`flex items-center px-6 py-3 rounded-lg border-2 transition-all ${s.format==="BOLSA"?"border-brand-500 bg-brand-50 text-brand-700":"border-slate-200 text-slate-500 hover:border-slate-300"}`,children:[e.jsx(Be,{className:"mr-2",size:20})," Bolsa (Bag)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 bg-slate-50 p-6 rounded-lg border border-slate-200",children:[s.format==="BOBINA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-brand-600",children:"Ancho Final Bobina (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:s.finalReelWidth||"",onChange:r=>o("finalReelWidth",Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-brand-600",children:"Paso / Cutoff (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:s.cutoff||"",onChange:r=>o("cutoff",Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Sentido Bobinado"}),e.jsx("select",{className:"input-field",value:s.windingDirection,onChange:r=>o("windingDirection",r.target.value),children:se.map(r=>e.jsx("option",{value:r,children:r},r))})]})]}),s.format==="BOLSA"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-brand-600",children:"Ancho Bolsa / Paso (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:s.bagWidth||"",onChange:r=>{o("bagWidth",Number(r.target.value)),o("cutoff",Number(r.target.value))}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text text-slate-600",children:"Alto / Largo (mm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:s.bagHeight||"",onChange:r=>{o("bagHeight",Number(r.target.value))}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Fuelle (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"0",value:s.gusset||"",onChange:r=>o("gusset",Number(r.target.value))})]})]}),e.jsxs("div",{className:"border-l border-slate-300 pl-6 md:col-span-1 col-span-2",children:[e.jsx("label",{className:"label-text text-slate-900 font-bold",children:"Ingeniería"}),e.jsxs("div",{className:"space-y-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Pistas (Montaje)"}),e.jsx("input",{type:"number",className:"input-field py-1",min:"1",required:!0,value:s.tracks||1,onChange:r=>o("tracks",Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-slate-500",children:"Desarrollo Cilindro (mm)"}),e.jsx("input",{type:"number",className:"input-field py-1",required:!0,value:s.cylinder||"",onChange:r=>o("cylinder",Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-brand-600 font-bold",children:"Ancho Impreso (mm)"}),e.jsx("input",{type:"number",className:"input-field py-1 border-brand-300 bg-white",required:!0,value:s.webWidth||"",onChange:r=>o("webWidth",Number(r.target.value))})]})]})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-slate-400 mb-4",children:"3. Estructura y Receta Ideal"}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Define el material ideal. La calculadora buscará el stock que mejor se ajuste."}),e.jsxs("div",{className:"space-y-6 p-6 bg-slate-50 rounded-xl border border-slate-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-start",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"label-text text-brand-700 font-bold",children:"Capa 1 (Impresión)"}),e.jsx("select",{className:"input-field font-bold",value:((y=s.layer1)==null?void 0:y.type)||z.BOPP,onChange:r=>E("layer1","type",r.target.value),children:Object.values(z).map(r=>e.jsx("option",{value:r,children:r},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Espesor (μm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:"20",required:!0,value:((k=s.layer1)==null?void 0:k.thickness)||"",onChange:r=>E("layer1","thickness",Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Ancho Ideal (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:((s.webWidth||0)+20).toString(),value:((J=s.layer1)==null?void 0:J.width)||"",onChange:r=>E("layer1","width",Number(r.target.value))}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"Vacío = Ancho Impreso + 20mm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Tinta (g/m²)"}),e.jsx("input",{type:"number",step:"0.1",className:"input-field",value:s.inkCoverage,onChange:r=>o("inkCoverage",Number(r.target.value))})]}),s.webWidth&&((te=s.layer1)==null?void 0:te.width)&&s.layer1.width<s.webWidth&&e.jsxs("div",{className:"md:col-span-4 bg-red-50 text-red-700 p-2 rounded text-xs flex items-center",children:[e.jsx(ve,{size:14,className:"mr-2"}),"El ancho del material (",s.layer1.width,"mm) es MENOR al ancho impreso (",s.webWidth,"mm)."]})]}),e.jsxs("div",{className:"relative border-t border-slate-200 pt-4 mt-2",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"hasLayer2",className:"mr-2",checked:!!s.layer2,onChange:r=>F("layer2",r.target.checked)}),e.jsx("label",{htmlFor:"hasLayer2",className:"text-sm font-bold text-slate-700 select-none cursor-pointer",children:"Capa 2 (Laminación)"})]}),s.layer2&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-start animate-fade-in",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx("select",{className:"input-field",value:s.layer2.type,onChange:r=>E("layer2","type",r.target.value),children:Object.values(z).map(r=>e.jsx("option",{value:r,children:r},r))})}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Espesor (μm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:s.layer2.thickness,onChange:r=>E("layer2","thickness",Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Ancho Ideal (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:((s.webWidth||0)+20).toString(),value:s.layer2.width||"",onChange:r=>E("layer2","width",Number(r.target.value))}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"Vacío = Ancho Impreso + 20mm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Adhesivo (g/m²)"}),e.jsx("input",{type:"number",step:"0.1",className:"input-field",value:s.adhesiveCoverage,onChange:r=>o("adhesiveCoverage",Number(r.target.value))})]}),s.webWidth&&s.layer2.width&&s.layer2.width<s.webWidth&&e.jsxs("div",{className:"md:col-span-4 bg-red-50 text-red-700 p-2 rounded text-xs flex items-center",children:[e.jsx(ve,{size:14,className:"mr-2"}),"El ancho del material (",s.layer2.width,"mm) es MENOR al ancho impreso (",s.webWidth,"mm)."]})]})]}),e.jsxs("div",{className:"relative border-t border-slate-200 pt-4 mt-2",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"hasLayer3",className:"mr-2",checked:!!s.layer3,onChange:r=>F("layer3",r.target.checked)}),e.jsx("label",{htmlFor:"hasLayer3",className:"text-sm font-bold text-slate-700 select-none cursor-pointer",children:"Capa 3 (Trilaminado)"})]}),s.layer3&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-start animate-fade-in",children:[e.jsx("div",{className:"md:col-span-1",children:e.jsx("select",{className:"input-field",value:s.layer3.type,onChange:r=>E("layer3","type",r.target.value),children:Object.values(z).map(r=>e.jsx("option",{value:r,children:r},r))})}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Espesor (μm)"}),e.jsx("input",{type:"number",className:"input-field",required:!0,value:s.layer3.thickness,onChange:r=>E("layer3","thickness",Number(r.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label-text",children:"Ancho Ideal (mm)"}),e.jsx("input",{type:"number",className:"input-field",placeholder:((s.webWidth||0)+20).toString(),value:s.layer3.width||"",onChange:r=>E("layer3","width",Number(r.target.value))}),e.jsx("span",{className:"text-[10px] text-slate-400",children:"Vacío = Ancho Impreso + 20mm"})]}),s.webWidth&&s.layer3.width&&s.layer3.width<s.webWidth&&e.jsxs("div",{className:"md:col-span-4 bg-red-50 text-red-700 p-2 rounded text-xs flex items-center",children:[e.jsx(ve,{size:14,className:"mr-2"}),"El ancho del material (",s.layer3.width,"mm) es MENOR al ancho impreso (",s.webWidth,"mm)."]})]})]})]})]}),e.jsxs("div",{className:"pt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>n("list"),className:"px-6 py-3 rounded-lg font-medium text-slate-600 hover:bg-slate-100",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"flex items-center bg-brand-600 hover:bg-brand-700 text-white px-8 py-3 rounded-lg font-bold shadow-lg transition-all hover:scale-105",children:[e.jsx(Ne,{className:"mr-2"})," Guardar Ficha Técnica"]})]}),h&&e.jsx("div",{className:"p-4 bg-green-50 text-green-700 rounded-lg text-center font-medium border border-green-200 animate-bounce",children:"¡Ficha técnica guardada exitosamente!"})]})}),e.jsx("style",{children:`
        .label-text { display: block; font-size: 0.875rem; font-weight: 500; color: #475569; margin-bottom: 0.25rem; }
        .input-field { width: 100%; border-radius: 0.5rem; border: 1px solid #cbd5e1; padding: 0.625rem; outline: none; transition: border-color 0.2s; }
        .input-field:focus { border-color: #0ea5e9; ring: 2px; ring-color: #0ea5e9; }
      `})]})},ht=()=>{const[t,a]=f.useState(ce()),[n,l]=f.useState(!1),[i,c]=f.useState({}),d=()=>a(ce()),x=s=>{s.preventDefault(),i.name&&(Vs({id:i.id||`c${Date.now()}`,name:i.name,contact:i.contact||"",email:i.email||"",phone:i.phone||""}),l(!1),c({}),d())},g=s=>{confirm("¿Estás seguro de eliminar este cliente?")&&(Js(s),d())};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(Ve,{className:"mr-2 text-brand-600"})," Gestión de Clientes"]}),e.jsxs("button",{onClick:()=>{c({}),l(!0)},className:"bg-brand-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-brand-700 transition-colors",children:[e.jsx(Se,{size:18,className:"mr-1"})," Nuevo Cliente"]})]}),n&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-brand-200 mb-6",children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4",children:[i.id?"Editar":"Crear"," Cliente"]}),e.jsxs("form",{onSubmit:x,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Razón Social"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.name||"",onChange:s=>c({...i,name:s.target.value}),required:!0,placeholder:"Ej. Alimentos SAS"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Contacto"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.contact||"",onChange:s=>c({...i,contact:s.target.value}),placeholder:"Nombre del encargado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Email"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.email||"",onChange:s=>c({...i,email:s.target.value}),placeholder:"contacto@cliente.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Teléfono"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.phone||"",onChange:s=>c({...i,phone:s.target.value}),placeholder:"+57 ..."})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-6 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 flex items-center",children:[e.jsx(Ne,{size:18,className:"mr-2"})," Guardar"]})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Nombre"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Contacto"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Email"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Teléfono"}),e.jsx("th",{className:"px-6 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-slate-400",children:"No hay clientes registrados"})}),t.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-3 font-medium text-slate-800",children:s.name}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.contact}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.email||"-"}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.phone||"-"}),e.jsxs("td",{className:"px-6 py-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>{c(s),l(!0)},className:"text-brand-600 hover:text-brand-800 font-medium",children:"Editar"}),e.jsx("button",{onClick:()=>g(s.id),className:"text-red-500 hover:text-red-700",children:e.jsx(je,{size:18})})]})]},s.id))]})]})})]})},ut=()=>{const[t,a]=f.useState(ge()),[n,l]=f.useState(ue()),[i,c]=f.useState(!1),[d,x]=f.useState({}),[g,s]=f.useState(""),C=()=>{a(ge()),l(ue())};f.useEffect(()=>{i&&l(ue())},[i]);const h=o=>{o.preventDefault(),d.name&&d.internalCode&&(Zs({id:d.id||`m${Date.now()}`,internalCode:d.internalCode,name:d.name,supplier:d.supplier,type:d.type||z.BOPP,thickness:Number(d.thickness)||0,density:Number(d.density)||0,width:Number(d.width)||0,currentStockKg:Number(d.currentStockKg)||0,costPerKg:Number(d.costPerKg)||0}),c(!1),x({}),C())},P=o=>{confirm("¿Eliminar material? Esto podría afectar recetas existentes.")&&(Ys(o),C())},p=o=>{x({...d,type:o,density:De[o]})},v=t.filter(o=>o.name.toLowerCase().includes(g.toLowerCase())||o.internalCode.toLowerCase().includes(g.toLowerCase())),N=["BOPP Transparente","BOPP Mate","BOPP Metalizado","BOPP Blanco","BOPP Perlado","PET Transparente","PET Metalizado","PET DT","PET PVDC","PEBD Transparente","PEBD Blanco","CPP Transparente","CPP Metalizado","BOPP DT","BOPA (Nylon)"];return e.jsxs("div",{className:"space-y-6 animate-fade-in relative",children:[e.jsx("datalist",{id:"material-names",children:N.map(o=>e.jsx("option",{value:o},o))}),e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(Ke,{className:"mr-2 text-brand-600"})," Gestión de Inventario"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Administra bobinas, anchos y existencias"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Qe,{className:"absolute left-3 top-2.5 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Buscar código o nombre...",className:"pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-brand-500 outline-none w-64",value:g,onChange:o=>s(o.target.value)})]}),e.jsxs("button",{onClick:()=>{x({type:z.BOPP,density:.91}),c(!0)},className:"bg-brand-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-brand-700 transition-colors shadow-md",children:[e.jsx(Se,{size:18,className:"mr-1"})," Ingresar Material"]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-2xl border border-brand-200 w-full max-w-4xl max-h-[90vh] overflow-y-auto animate-fade-in relative",children:[e.jsx("button",{onClick:()=>c(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:e.jsx(Fe,{size:24})}),e.jsxs("h3",{className:"font-bold text-slate-700 mb-6 text-xl border-b pb-2 flex items-center",children:[e.jsx(Ke,{className:"mr-2 text-brand-600"}),d.id?"Editar":"Ingresar"," Bobina al Inventario"]}),e.jsxs("form",{onSubmit:h,className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Código Interno"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none font-mono bg-slate-50",value:d.internalCode||"",onChange:o=>x({...d,internalCode:o.target.value}),required:!0,placeholder:"Ej. MP-1023",autoFocus:!0})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Descripción"}),e.jsx("input",{list:"material-names",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.name||"",onChange:o=>x({...d,name:o.target.value}),required:!0,placeholder:"Ej. BOPP Metalizado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Proveedor"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{className:"absolute left-2 top-2 text-slate-400",size:16}),e.jsxs("select",{className:"w-full border p-2 pl-8 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.supplier||"",onChange:o=>x({...d,supplier:o.target.value}),children:[e.jsx("option",{value:"",children:"Seleccionar Proveedor..."}),n.map(o=>e.jsx("option",{value:o.name,children:o.name},o.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Tipo"}),e.jsx("select",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.type,onChange:o=>p(o.target.value),children:Object.values(z).map(o=>e.jsx("option",{value:o,children:o},o))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Espesor (μm)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.thickness||"",onChange:o=>x({...d,thickness:Number(o.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 mb-1",children:"Densidad (g/cm³)"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none bg-slate-50",value:d.density||"",onChange:o=>x({...d,density:Number(o.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-brand-600 mb-1",children:"Ancho Bobina (mm)"}),e.jsx("input",{type:"number",className:"w-full border-2 border-brand-100 p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:d.width||"",onChange:o=>x({...d,width:Number(o.target.value)}),required:!0,placeholder:"Ancho real"})]}),e.jsxs("div",{className:"bg-emerald-50 p-2 rounded border border-emerald-100 md:col-start-4",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-emerald-700 mb-1",children:"Stock Actual (Kg)"}),e.jsx("input",{type:"number",step:"0.1",className:"w-full border border-emerald-300 p-2 rounded focus:ring-2 focus:ring-emerald-500 outline-none text-emerald-800 font-bold",value:d.currentStockKg||"",onChange:o=>x({...d,currentStockKg:Number(o.target.value)}),required:!0,placeholder:"0.00"})]}),e.jsxs("div",{className:"md:col-span-4 flex justify-end space-x-3 mt-4 pt-4 border-t border-slate-100",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-6 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 flex items-center shadow-lg",children:[e.jsx(Ne,{size:18,className:"mr-2"})," Guardar en Inventario"]})]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Código"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Material"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Prov."}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Ancho"}),e.jsx("th",{className:"px-4 py-3 font-semibold",children:"Micras"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:"Stock (Kg)"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[v.map(o=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors group",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-slate-500 text-xs",children:o.internalCode}),e.jsxs("td",{className:"px-4 py-3 font-medium text-slate-800",children:[o.name,e.jsxs("span",{className:"block text-xs text-slate-400",children:[o.type," | Dens: ",o.density]})]}),e.jsx("td",{className:"px-4 py-3 text-slate-600 text-xs",children:o.supplier||"-"}),e.jsxs("td",{className:"px-4 py-3 text-slate-700 font-medium",children:[o.width," mm"]}),e.jsxs("td",{className:"px-4 py-3 text-slate-600",children:[o.thickness," μ"]}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("span",{className:`font-bold px-2 py-1 rounded ${o.currentStockKg<100?"bg-red-100 text-red-700":"bg-emerald-50 text-emerald-700"}`,children:[o.currentStockKg.toLocaleString()," Kg"]})}),e.jsxs("td",{className:"px-4 py-3 text-right space-x-2 opacity-60 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>{x(o),c(!0)},className:"text-brand-600 hover:text-brand-800 font-medium p-1 hover:bg-brand-50 rounded",children:"Editar"}),e.jsx("button",{onClick:()=>P(o.id),className:"text-red-500 hover:text-red-700 p-1 hover:bg-red-50 rounded",children:e.jsx(je,{size:16})})]})]},o.id)),v.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-slate-400",children:"No se encontraron materiales con ese criterio."})})]})]})})]})},bt=()=>{const[t,a]=f.useState(ue()),[n,l]=f.useState(!1),[i,c]=f.useState({}),d=()=>a(ue()),x=s=>{s.preventDefault(),i.name&&(Hs({id:i.id||`s${Date.now()}`,name:i.name,contact:i.contact||"",email:i.email||"",phone:i.phone||"",origin:i.origin||"Nacional"}),l(!1),c({}),d())},g=s=>{confirm("¿Estás seguro de eliminar este proveedor?")&&(Qs(s),d())};return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(Ge,{className:"mr-2 text-brand-600"})," Gestión de Proveedores"]}),e.jsxs("button",{onClick:()=>{c({}),l(!0)},className:"bg-brand-600 text-white px-4 py-2 rounded-lg flex items-center hover:bg-brand-700 transition-colors",children:[e.jsx(Se,{size:18,className:"mr-1"})," Nuevo Proveedor"]})]}),n&&e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-brand-200 mb-6",children:[e.jsxs("h3",{className:"font-bold text-slate-700 mb-4",children:[i.id?"Editar":"Crear"," Proveedor"]}),e.jsxs("form",{onSubmit:x,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Razón Social"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.name||"",onChange:s=>c({...i,name:s.target.value}),required:!0,placeholder:"Ej. Oben Holding"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Origen"}),e.jsxs("select",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.origin||"Nacional",onChange:s=>c({...i,origin:s.target.value}),children:[e.jsx("option",{value:"Nacional",children:"Nacional"}),e.jsx("option",{value:"Importado",children:"Importado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Contacto"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.contact||"",onChange:s=>c({...i,contact:s.target.value}),placeholder:"Nombre del encargado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Email"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.email||"",onChange:s=>c({...i,email:s.target.value}),placeholder:"ventas@proveedor.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-500 mb-1",children:"Teléfono"}),e.jsx("input",{className:"w-full border p-2 rounded focus:ring-2 focus:ring-brand-500 outline-none",value:i.phone||"",onChange:s=>c({...i,phone:s.target.value}),placeholder:"+57 ..."})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end space-x-3 mt-2",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-6 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 flex items-center",children:[e.jsx(Ne,{size:18,className:"mr-2"})," Guardar"]})]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200 text-slate-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Nombre"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Origen"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Contacto"}),e.jsx("th",{className:"px-6 py-3 font-semibold",children:"Teléfono"}),e.jsx("th",{className:"px-6 py-3 font-semibold text-right",children:"Acciones"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-100",children:[t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-8 text-center text-slate-400",children:"No hay proveedores registrados"})}),t.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-3 font-medium text-slate-800",children:s.name}),e.jsx("td",{className:"px-6 py-3",children:e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${s.origin==="Importado"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:s.origin})}),e.jsxs("td",{className:"px-6 py-3 text-slate-600",children:[e.jsx("div",{children:s.contact}),e.jsx("div",{className:"text-xs text-slate-400",children:s.email})]}),e.jsx("td",{className:"px-6 py-3 text-slate-600",children:s.phone||"-"}),e.jsxs("td",{className:"px-6 py-3 text-right space-x-2",children:[e.jsx("button",{onClick:()=>{c(s),l(!0)},className:"text-brand-600 hover:text-brand-800 font-medium",children:"Editar"}),e.jsx("button",{onClick:()=>g(s.id),className:"text-red-500 hover:text-red-700",children:e.jsx(je,{size:18})})]})]},s.id))]})]})})]})},pt=()=>{const[t,a]=f.useState("Impresión"),[n,l]=f.useState([]),[i,c]=f.useState(!1),[d,x]=f.useState(null),g=["Impresión","Reimpresión","Laminación","Trilaminado","Refilado","Confección (Bolsera)"];f.useEffect(()=>{const v=de().filter(N=>N.status==="En Producción"&&(N.currentStage===t||!N.currentStage&&t==="Impresión"));l(v)},[t]);const s=(p,v)=>{x(v),p.dataTransfer.effectAllowed="move";const N=document.createElement("div");N.textContent="Moviendo...",N.style.background="#fff",N.style.padding="10px",N.style.border="1px solid #ccc",document.body.appendChild(N),p.dataTransfer.setDragImage(N,0,0),setTimeout(()=>document.body.removeChild(N),0)},C=(p,v)=>{if(p.preventDefault(),d===null||d===v)return;const N=[...n],o=N[d];N.splice(d,1),N.splice(v,0,o),l(N),x(v)},h=()=>{x(null),tt(n)},P=()=>{c(!0),setTimeout(()=>{const p=document.getElementById("queue-printable-area");if(!p)return;const v=document.createElement("div");v.style.position="fixed",v.style.top="0",v.style.left="0",v.style.width="100vw",v.style.zIndex="999999",v.style.background="#ffffff";const N=p.cloneNode(!0);N.classList.remove("hidden"),N.style.width="100%",v.appendChild(N),document.body.appendChild(v);const o={margin:10,filename:`Planilla_${t}_${new Date().toISOString().split("T")[0]}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"mm",format:"a4",orientation:"landscape"}};window.html2pdf().set(o).from(N).save().then(()=>{document.body.removeChild(v),c(!1)})},100)};return e.jsxs("div",{className:"h-full flex flex-col animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-slate-800 flex items-center",children:[e.jsx(Pe,{className:"mr-2 text-brand-600"}),"Fila de Producción"]}),e.jsx("p",{className:"text-sm text-slate-500",children:"Organiza y prioriza las órdenes en curso"})]}),e.jsxs("button",{onClick:P,disabled:i,className:"bg-slate-800 text-white px-4 py-2 rounded-lg flex items-center hover:bg-slate-700 transition-colors",children:[i?e.jsx(Ye,{size:18,className:"mr-2 animate-spin"}):e.jsx(He,{size:18,className:"mr-2"}),"Descargar Planilla (PDF)"]})]}),e.jsx("div",{className:"flex space-x-1 mb-6 overflow-x-auto pb-2",children:g.map(p=>e.jsx("button",{onClick:()=>a(p),className:`px-5 py-2.5 rounded-lg font-bold text-sm transition-all whitespace-nowrap
                    ${t===p?"bg-brand-600 text-white shadow-md":"bg-white text-slate-600 border border-slate-200 hover:bg-slate-50"}`,children:p},p))}),e.jsx("div",{className:"flex-1 bg-slate-100 rounded-xl p-6 border border-slate-200 overflow-y-auto min-h-[500px]",children:n.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-slate-400",children:[e.jsx(Xe,{size:48,className:"mb-4 opacity-50"}),e.jsxs("p",{className:"font-medium",children:["No hay órdenes en la etapa de ",t]}),e.jsx("p",{className:"text-sm",children:'Ve al Dashboard y marca órdenes como "En Producción" en esta etapa.'})]}):e.jsx("div",{className:"space-y-3 max-w-4xl mx-auto",children:n.map((p,v)=>e.jsxs("div",{draggable:!0,onDragStart:N=>s(N,v),onDragOver:N=>C(N,v),onDragEnd:h,className:`bg-white rounded-lg p-4 shadow-sm border border-slate-200 flex items-center group hover:shadow-md transition-all
                            ${d===v?"opacity-50 scale-95":"opacity-100"}`,children:[e.jsxs("div",{className:"mr-4 cursor-grab active:cursor-grabbing text-slate-400 hover:text-brand-500",children:[e.jsx(Ss,{size:24}),e.jsx("span",{className:"text-xs font-bold text-center block mt-1 w-6",children:v+1})]}),e.jsxs("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-4 gap-4 items-center",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs("div",{className:"flex items-center mb-1",children:[e.jsx("span",{className:"bg-slate-100 text-slate-600 text-[10px] font-bold px-1.5 py-0.5 rounded mr-2",children:p.orderCode}),e.jsx("span",{className:"text-brand-700 font-bold text-lg",children:p.productName})]}),e.jsx("div",{className:"text-sm text-slate-500 flex items-center",children:e.jsx("span",{className:"font-bold text-slate-700 mr-2",children:p.clientName})})]}),e.jsxs("div",{className:"flex flex-col justify-center text-sm border-l border-slate-100 pl-4",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Pedido"}),e.jsxs("span",{className:"font-bold text-slate-800 text-lg",children:[p.quantityRequested.toLocaleString()," ",p.unit==="Unidades"?"Ud":"Kg"]}),e.jsxs("span",{className:"text-xs text-slate-500",children:["Total: ",p.calculationSnapshot.totalWeightKg.toLocaleString()," Kg"]})]}),e.jsxs("div",{className:"flex flex-col justify-center text-sm border-l border-slate-100 pl-4",children:[e.jsx("span",{className:"text-slate-400 text-xs uppercase font-bold",children:"Técnico"}),e.jsxs("span",{className:"text-slate-700 font-mono",children:["Ancho: ",e.jsx("strong",{children:p.technicalDetails.webWidth})," mm"]}),e.jsxs("span",{className:"text-slate-700 font-mono",children:["Cilindro: ",e.jsx("strong",{children:p.technicalDetails.cylinder})," mm"]})]})]}),e.jsxs("div",{className:"ml-4 pl-4 border-l border-slate-200 text-right",children:[e.jsxs("div",{className:"bg-emerald-50 text-emerald-700 border border-emerald-200 px-3 py-1.5 rounded-lg flex items-center text-xs font-bold whitespace-nowrap",children:[e.jsx(ye,{size:14,className:"mr-1.5"}),"En ",p.currentStage||"Proceso"]}),e.jsxs("div",{className:"mt-1 text-[10px] text-slate-400 flex items-center justify-end",children:[e.jsx(Ps,{size:10,className:"mr-1"})," ",p.date]})]})]},p.id))})}),e.jsxs("div",{id:"queue-printable-area",className:"hidden bg-white p-8",children:[e.jsxs("div",{className:"border-b-2 border-black pb-4 mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold uppercase",children:"PCP Multipack"}),e.jsxs("p",{className:"text-lg text-gray-600",children:["Planilla de Programación: ",e.jsx("span",{className:"font-bold text-black uppercase",children:t})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold",children:"Fecha Impresión:"}),e.jsx("p",{className:"font-mono",children:new Date().toLocaleString()})]})]}),e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100 border-y-2 border-black text-sm uppercase",children:[e.jsx("th",{className:"p-3 w-12 text-center",children:"#"}),e.jsx("th",{className:"p-3",children:"OP"}),e.jsx("th",{className:"p-3",children:"Cliente / Producto"}),e.jsx("th",{className:"p-3 text-right",children:"Cantidad"}),e.jsx("th",{className:"p-3 text-center",children:"Ancho"}),e.jsx("th",{className:"p-3 text-center",children:"Desarrollo"}),e.jsx("th",{className:"p-3 text-center",children:"Estado"}),e.jsx("th",{className:"p-3 w-32",children:"Observaciones"})]})}),e.jsx("tbody",{children:n.map((p,v)=>e.jsxs("tr",{className:"border-b border-gray-300 text-sm",children:[e.jsx("td",{className:"p-3 text-center font-bold text-lg",children:v+1}),e.jsx("td",{className:"p-3 font-mono font-bold",children:p.orderCode}),e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-bold text-black text-base",children:p.productName}),e.jsx("div",{className:"text-gray-600 text-xs",children:p.clientName})]}),e.jsxs("td",{className:"p-3 text-right font-bold",children:[p.quantityRequested.toLocaleString()," ",p.unit==="Unidades"?"Ud":"Kg"]}),e.jsxs("td",{className:"p-3 text-center",children:[p.technicalDetails.webWidth," mm"]}),e.jsxs("td",{className:"p-3 text-center",children:[p.technicalDetails.cylinder," mm"]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:"bg-gray-100 border border-gray-300 px-2 py-1 rounded text-xs font-bold uppercase",children:p.currentStage})}),e.jsx("td",{className:"p-3 border-l border-gray-200"})]},p.id))})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t-2 border-black flex justify-between text-xs uppercase font-bold text-gray-500",children:[e.jsx("div",{children:"Supervisor de Turno"}),e.jsx("div",{children:"Firma Recibido"})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-[10px] text-gray-400",children:"Software enigma.com.uy"})})]})]})},ft=()=>{const[t,a]=f.useState(ts()),[n,l]=f.useState(!1),i=f.useRef(null),c=x=>{x.preventDefault(),lt(t),l(!0),setTimeout(()=>l(!1),2e3)},d=async x=>{x.target.files&&x.target.files[0]&&(await it(x.target.files[0])&&(alert("Base de datos restaurada correctamente. La página se recargará."),window.location.reload()),i.current&&(i.current.value=""))};return e.jsxs("div",{className:"max-w-2xl mx-auto animate-fade-in space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8",children:[e.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"bg-slate-100 p-3 rounded-full mr-4",children:e.jsx(pe,{className:"text-slate-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Parámetros de Producción"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Variables globales para el cálculo de merma y metraje"})]})]}),e.jsxs("form",{onSubmit:c,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste Impresión"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Metros fijos perdidos en arranque de impresión."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:t.fixedStartupMeters,onChange:x=>a({...t,fixedStartupMeters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste Reprint (DT)"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Extra si el material es tipo DT (Reimpresión)."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:t.reprintMeters||0,onChange:x=>a({...t,reprintMeters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste 1° Laminado"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Extra si la ficha tiene Capa 2."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:t.lamination1Meters||0,onChange:x=>a({...t,lamination1Meters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"Ajuste 2° Laminado"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Extra si la ficha tiene Capa 3."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none",value:t.lamination2Meters||0,onChange:x=>a({...t,lamination2Meters:Number(x.target.value)})}),e.jsx("span",{className:"ml-2 text-slate-600 font-medium text-xs",children:"m"})]})]})]}),e.jsxs("div",{className:"border-t border-slate-100 pt-4",children:[e.jsx("label",{className:"block font-medium text-slate-700 mb-2",children:"% Merma Variable (Proceso)"}),e.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Porcentaje de seguridad sobre el metraje neto (ej. 0.05 = 5%)."}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",step:"0.01",className:"w-full border border-slate-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-brand-500 outline-none max-w-xs",value:t.variableScrapPercent,onChange:x=>a({...t,variableScrapPercent:Number(x.target.value)})}),e.jsx("span",{className:"ml-3 text-slate-600 font-medium",children:"factor (0.1 = 10%)"})]})]}),e.jsxs("div",{className:"pt-4 flex items-center justify-between",children:[n?e.jsx("span",{className:"text-green-600 font-medium text-sm animate-pulse",children:"¡Guardado correctamente!"}):e.jsx("span",{}),e.jsxs("button",{type:"submit",className:"bg-brand-600 text-white px-6 py-2 rounded-lg hover:bg-brand-700 transition-colors flex items-center",children:[e.jsx(Ne,{className:"mr-2",size:18})," Guardar Cambios"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-8",children:[e.jsxs("div",{className:"flex items-center mb-6 pb-4 border-b border-slate-100",children:[e.jsx("div",{className:"bg-emerald-100 p-3 rounded-full mr-4",children:e.jsx(Es,{className:"text-emerald-600",size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Base de Datos (Sincronización)"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Guarda y carga tu información para usar en otros equipos"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border border-slate-100",children:[e.jsxs("div",{className:"text-slate-600 text-sm max-w-xs",children:[e.jsx("strong",{children:"Reporte Excel (.xlsx)"}),e.jsx("br",{}),"Tablas de Clientes, Materiales y Fichas legibles para humanos."]}),e.jsxs("button",{onClick:rt,className:"bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition-colors flex items-center shadow",children:[e.jsx(Re,{className:"mr-2",size:18})," Excel"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"text-blue-800 text-sm mb-3 font-bold flex items-center",children:[e.jsx(Ds,{className:"mr-2",size:16})," 1. Guardar (Backup)"]}),e.jsx("p",{className:"text-xs text-blue-600 mb-3",children:"Descarga el archivo JSON. Guárdalo en tu Google Drive para llevarlo a otra PC."}),e.jsxs("button",{onClick:nt,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center shadow text-sm",children:[e.jsx(Re,{className:"mr-2",size:16})," Descargar DB"]})]}),e.jsxs("div",{className:"p-4 bg-amber-50 rounded-lg border border-amber-100",children:[e.jsxs("div",{className:"text-amber-800 text-sm mb-3 font-bold flex items-center",children:[e.jsx(qe,{className:"mr-2",size:16})," 2. Restaurar (Importar)"]}),e.jsx("p",{className:"text-xs text-amber-600 mb-3",children:"Carga el archivo JSON desde tu PC o Drive para recuperar tus datos."}),e.jsx("input",{type:"file",accept:".json",ref:i,className:"hidden",onChange:d}),e.jsxs("button",{onClick:()=>{var x;return(x=i.current)==null?void 0:x.click()},className:"w-full bg-amber-600 text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition-colors flex items-center justify-center shadow text-sm",children:[e.jsx(qe,{className:"mr-2",size:16})," Cargar DB"]})]})]})]})]})]})},Me=({order:t,onSelect:a,onStatusChange:n,onDelete:l})=>{const i={Pendiente:"border-l-4 border-l-amber-400","En Producción":"border-l-4 border-l-blue-500",Terminado:"border-l-4 border-l-emerald-500 opacity-75"};return e.jsxs("div",{onClick:()=>a(t),className:`bg-white rounded-lg shadow-sm p-4 mb-4 border border-slate-200 ${i[t.status]||"border-l-4 border-l-slate-400"} hover:shadow-md hover:scale-[1.01] transition-all cursor-pointer relative`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1 pr-2",children:[e.jsxs("span",{className:"text-xs font-bold text-slate-400 block",children:[t.orderCode," | ",t.date]}),e.jsx("h4",{className:"font-bold text-slate-800 text-base leading-tight mb-1",children:t.clientName}),e.jsx("p",{className:"text-sm text-slate-600 leading-snug",children:t.productName})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsxs("span",{className:"block font-bold text-slate-800",children:[t.quantityRequested.toLocaleString()," ",t.unit==="Unidades"?"Ud":t.unit==="Metros"?"m":"Kg"]}),e.jsx("span",{className:"text-xs bg-slate-100 px-2 py-0.5 rounded text-slate-500",children:t.technicalDetails.format})]})]}),t.status==="En Producción"&&t.currentStage&&e.jsxs("div",{className:"my-2 text-xs font-bold text-blue-700 bg-blue-50 px-2 py-1 rounded border border-blue-100 flex items-center",children:[e.jsx(Pe,{size:12,className:"mr-1.5"}),"Etapa: ",t.currentStage]}),e.jsxs("div",{className:"bg-slate-50 rounded p-2 my-3 text-xs space-y-1 border border-slate-100",children:[e.jsxs("div",{className:"flex items-center text-slate-600",children:[e.jsx(Ze,{size:12,className:"mr-1.5"}),e.jsxs("span",{children:["Ancho: ",e.jsxs("strong",{children:[t.technicalDetails.webWidth,"mm"]})," | Cutoff: ",e.jsxs("strong",{children:[t.technicalDetails.cutoff,"mm"]})]})]}),e.jsxs("div",{className:"flex items-center text-slate-600",children:[e.jsx(fe,{size:12,className:"mr-1.5"}),e.jsx("span",{children:t.technicalDetails.layers.join(" + ")})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-3 pt-2 border-t border-slate-100",children:[e.jsxs("div",{className:"text-xs text-brand-600 font-medium",children:["Req: ",t.calculationSnapshot.grossLinearMeters.toLocaleString(),"m"]}),e.jsxs("div",{className:"flex space-x-1",children:[t.status==="Pendiente"&&e.jsx("button",{onClick:c=>n(t.id,"En Producción",c),className:"p-1.5 text-blue-600 hover:bg-blue-50 rounded tooltip",title:"Iniciar",children:e.jsx(pe,{size:16})}),t.status==="En Producción"&&e.jsx("button",{onClick:c=>n(t.id,"Terminado",c),className:"p-1.5 text-emerald-600 hover:bg-emerald-50 rounded tooltip",title:"Finalizar",children:e.jsx(ye,{size:16})}),e.jsx("button",{onClick:c=>l(t.id,c),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 rounded",children:e.jsx(je,{size:16})})]})]})]})},gt=()=>{const[t,a]=f.useState([]),[n,l]=f.useState({active:0,materials:0,clients:0}),[i,c]=f.useState(null);f.useEffect(()=>{const s=de();a(s),l({active:s.filter(C=>C.status!=="Terminado").length,materials:ge().length,clients:ce().length})},[]);const d=(s,C,h)=>{h.stopPropagation(),et(s,C);const P=de();a(P),i&&i.id===s&&c(P.find(p=>p.id===s)||null)},x=(s,C)=>{C.stopPropagation(),confirm("¿Eliminar historial de orden?")&&(at(s),a(de()),(i==null?void 0:i.id)===s&&c(null))},g=({order:s,onClose:C})=>{const[h,P]=f.useState(!1),[p,v]=f.useState(s.currentStage),N=ce(),o=be(),E=s.clientId?N.find(j=>j.id===s.clientId):null,F=o.find(j=>j.id===s.productId);if(!s)return null;const $=j=>{if(h)return;v(j),st(s.id,j);const y=de();a(y)},se=()=>{P(!0),setTimeout(()=>{const j=document.getElementById("printable-order-content");if(!j){P(!1);return}const y=document.createElement("div");y.style.position="fixed",y.style.top="0",y.style.left="0",y.style.width="100vw",y.style.height="auto",y.style.minHeight="100vh",y.style.zIndex="999999",y.style.background="#ffffff",y.style.display="flex",y.style.justifyContent="center",y.style.padding="20px";const k=j.cloneNode(!0);k.style.maxHeight="none",k.style.boxShadow="none",k.style.width="100%",k.style.maxWidth="1000px",k.style.overflow="visible",y.appendChild(k),document.body.appendChild(y),window.scrollTo(0,0);const J={margin:[10,10,10,10],filename:`Orden_${s.orderCode}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0,logging:!1,scrollY:0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"},pagebreak:{mode:["css","legacy"]}};window.html2pdf&&window.html2pdf().set(J).from(k).save().then(()=>{document.body.removeChild(y),P(!1)}).catch(te=>{console.error(te),document.body.removeChild(y),P(!1),alert("Error generando PDF")})},200)};return e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fade-in",children:e.jsxs("div",{id:"printable-order-content",className:`bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto relative ${h?"border-none p-8":""}`,children:[e.jsxs("div",{className:`justify-between items-center border-b-2 border-black pb-4 mb-6 ${h?"flex":"hidden"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Pe,{size:48,className:"mr-4 text-black"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold uppercase tracking-wide text-black",children:"PCP"}),e.jsx("p",{className:"text-base font-medium text-gray-600",children:"Orden de Producción / Hoja de Ruta"})]})]}),e.jsxs("div",{className:"text-right text-black",children:[e.jsx("div",{className:"text-4xl font-bold font-mono mb-1",children:s.orderCode}),e.jsxs("div",{className:"text-sm font-medium",children:["Fecha: ",s.date]}),e.jsxs("div",{className:"flex items-center justify-end mt-2",children:[e.jsx(Os,{size:24,className:"mr-1"}),e.jsx("span",{className:"text-xs tracking-[0.2em]",children:"||| |||| || |||||"})]})]})]}),e.jsxs("div",{className:`bg-slate-900 text-white p-6 flex justify-between items-start sticky top-0 z-10 ${h?"hidden":"flex"}`,children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h2",{className:"text-2xl font-bold",children:s.orderCode}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider
                  ${s.status==="Pendiente"?"bg-amber-400 text-amber-900":s.status==="En Producción"?"bg-blue-500 text-white":"bg-emerald-500 text-white"}`,children:s.status})]}),e.jsx("p",{className:"text-slate-400 mt-1 font-medium",children:s.productName})]}),e.jsx("button",{onClick:C,className:"text-slate-400 hover:text-white p-1 bg-slate-800 rounded hover:bg-slate-700 transition-colors",children:e.jsx(Fe,{size:24})})]}),e.jsxs("div",{className:`p-6 space-y-6 ${h?"text-black":""}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 avoid-break",children:[e.jsxs("div",{className:`bg-slate-50 p-5 rounded-lg border border-slate-200 ${h?"bg-white border-2 border-black":""}`,children:[e.jsxs("div",{className:"flex items-center mb-3 border-b border-slate-200 pb-2",children:[e.jsx(We,{size:18,className:"mr-2 text-slate-500"}),e.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500",children:"Datos del Cliente"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900 leading-tight",children:s.clientName}),e.jsxs("p",{className:"text-xs text-slate-500",children:["ID: ",s.clientId]})]}),E?e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mt-2",children:[e.jsxs("div",{className:"flex items-center text-slate-700",children:[e.jsx(We,{size:14,className:"mr-1.5 text-slate-400"})," ",E.contact]}),e.jsxs("div",{className:"flex items-center text-slate-700",children:[e.jsx(Ls,{size:14,className:"mr-1.5 text-slate-400"})," ",E.phone||"N/A"]}),e.jsxs("div",{className:"col-span-2 flex items-center text-slate-700",children:[e.jsx(As,{size:14,className:"mr-1.5 text-slate-400"})," ",E.email||"N/A"]})]}):e.jsx("p",{className:"text-sm text-slate-400 italic",children:"Información detallada no disponible"})]})]}),e.jsxs("div",{className:`bg-slate-50 p-5 rounded-lg border border-slate-200 ${h?"bg-white border-2 border-black":""}`,children:[e.jsxs("div",{className:"flex items-center mb-3 border-b border-slate-200 pb-2",children:[e.jsx(Be,{size:18,className:"mr-2 text-slate-500"}),e.jsx("h3",{className:"text-sm font-bold uppercase text-slate-500",children:"Ficha Técnica"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xl font-bold text-slate-900 leading-tight",children:s.productName}),e.jsxs("p",{className:"text-sm font-mono font-bold text-brand-700 mt-1",children:["SKU: ",(F==null?void 0:F.sku)||"N/A"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mt-2",children:[e.jsxs("div",{className:"bg-white px-2 py-1 rounded border border-slate-100",children:[e.jsx("span",{className:"text-xs text-slate-400 block",children:"Formato"}),e.jsx("span",{className:"font-bold text-slate-800",children:s.technicalDetails.format})]}),e.jsxs("div",{className:"bg-white px-2 py-1 rounded border border-slate-100",children:[e.jsx("span",{className:"text-xs text-slate-400 block",children:"Pedido"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[s.quantityRequested," ",s.unit]})]}),e.jsxs("div",{className:`bg-blue-50 px-2 py-1 rounded border border-blue-100 text-center ${h?"bg-gray-100 border border-black":""}`,children:[e.jsx("span",{className:`text-xs text-blue-600 block font-bold uppercase ${h?"text-black":""}`,children:"Metros Producción"}),e.jsxs("span",{className:"font-bold text-lg text-blue-800",children:[s.calculationSnapshot.grossLinearMeters.toLocaleString()," m"]})]}),e.jsxs("div",{className:`bg-emerald-50 px-2 py-1 rounded border border-emerald-100 text-center ${h?"bg-gray-100 border border-black":""}`,children:[e.jsx("span",{className:`text-xs text-emerald-600 block font-bold uppercase ${h?"text-black":""}`,children:"Peso Total"}),e.jsxs("span",{className:"font-bold text-lg text-emerald-800",children:[s.calculationSnapshot.totalWeightKg.toLocaleString()," Kg"]})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 avoid-break",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase border-b-2 border-slate-200 pb-2 mb-4 flex items-center",children:[e.jsx(pe,{size:16,className:"mr-2"})," Especificaciones de Máquina"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Pistas / Montaje"}),e.jsx("span",{className:"font-bold text-slate-800",children:s.technicalDetails.tracks})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Desarrollo (Cilindro)"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[s.technicalDetails.cylinder," mm"]})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Paso (Cutoff)"}),e.jsxs("span",{className:"font-bold text-slate-800",children:[s.technicalDetails.cutoff," mm"]})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Ancho Bobina Impresión"}),e.jsxs("span",{className:"font-bold text-brand-600 text-black text-lg",children:[s.technicalDetails.webWidth," mm"]})]}),s.technicalDetails.windingDirection&&e.jsxs("div",{className:"flex justify-between border-b border-slate-100 pb-1",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Sentido Bobinado"}),e.jsx("span",{className:"font-bold text-slate-800",children:s.technicalDetails.windingDirection})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase border-b-2 border-slate-200 pb-2 mb-4 flex items-center",children:[e.jsx($e,{size:16,className:"mr-2"})," Ruta de Proceso",e.jsx("span",{className:`ml-2 text-xs font-normal lowercase text-slate-400 ${h?"hidden":"inline"}`,children:"(Click para marcar etapa)"})]}),e.jsx("div",{className:"space-y-2",children:s.requiredStages.map((j,y)=>e.jsxs("div",{onClick:()=>$(j),className:`flex items-center justify-between p-3 rounded cursor-pointer transition-all ${p===j?"bg-brand-600 text-white shadow-md transform scale-[1.02]":"bg-slate-50 hover:bg-slate-100 text-slate-700"} ${h?"bg-white border border-black py-2 mb-2 text-black":""}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`h-6 w-6 rounded-full flex items-center justify-center text-xs font-bold mr-3 
                                   ${h?"bg-black text-white border border-black":p===j?"bg-white text-brand-600":"bg-brand-100 text-brand-600"}`,children:y+1}),e.jsx("span",{className:`font-bold uppercase text-xs ${p===j?"text-white":"text-slate-700"} ${h?"text-black":""}`,children:j})]}),h&&e.jsx("div",{className:"h-4 w-4 border border-black"}),p===j&&!h&&e.jsx(ye,{size:16,className:"text-white"})]},y))})]})]}),e.jsxs("div",{className:"avoid-break",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase border-b-2 border-slate-200 pb-2 mb-4 flex items-center",children:[e.jsx(fe,{size:16,className:"mr-2"})," Lista de Materiales (Picking List)"]}),s.materialRequirements&&s.materialRequirements.length>0?e.jsx("div",{className:`border rounded-lg overflow-hidden ${h?"border-2 border-black":"border-slate-200"}`,children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:`bg-slate-100 text-slate-600 uppercase text-xs ${h?"bg-gray-100 text-black border-b-2 border-black":""}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Uso"}),e.jsx("th",{className:"px-4 py-2",children:"Código"}),e.jsx("th",{className:"px-4 py-2",children:"Descripción Material"}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Ancho"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Cantidad"}),h&&e.jsx("th",{className:"px-4 py-2 text-center w-16",children:"OK"})]})}),e.jsxs("tbody",{className:`divide-y ${h?"divide-black":"divide-slate-100"}`,children:[s.materialRequirements.map((j,y)=>{const k=j.isSubstitute;return e.jsxs("tr",{className:k?h?"bg-white":"bg-amber-50":"",children:[e.jsxs("td",{className:"px-4 py-2 font-bold text-slate-700",children:[j.layer,k&&e.jsx("span",{className:`ml-2 text-[10px] bg-amber-200 text-amber-800 px-1.5 py-0.5 rounded uppercase ${h?"border border-black bg-white text-black":""}`,children:"Sustituto"})]}),e.jsx("td",{className:"px-4 py-2 font-mono text-brand-600 font-bold text-black",children:j.internalCode}),e.jsx("td",{className:"px-4 py-2",children:j.materialName}),e.jsxs("td",{className:"px-4 py-2 text-center font-bold",children:[j.width," mm"]}),e.jsxs("td",{className:"px-4 py-2 text-right font-bold",children:[j.requiredKg.toLocaleString()," Kg"]}),h&&e.jsx("td",{className:"border-l border-black"})]},y)}),e.jsxs("tr",{className:`bg-slate-50 ${h?"bg-white border-t-2 border-black":""}`,children:[e.jsx("td",{colSpan:4,className:"px-4 py-2 text-right font-bold text-slate-500 uppercase text-xs text-black",children:"Total Sustratos"}),e.jsxs("td",{className:"px-4 py-2 text-right font-bold",children:[(s.calculationSnapshot.layer1Kg+s.calculationSnapshot.layer2Kg+s.calculationSnapshot.layer3Kg).toLocaleString()," Kg"]}),h&&e.jsx("td",{})]}),e.jsxs("tr",{children:[e.jsx("td",{colSpan:4,className:"px-4 py-2 text-right font-bold text-slate-500 uppercase text-xs text-black",children:"Insumos (Tinta/Adh)"}),e.jsxs("td",{className:"px-4 py-2 text-right font-medium",children:[(s.calculationSnapshot.inkKg+s.calculationSnapshot.adhesiveKg).toLocaleString()," Kg"]}),h&&e.jsx("td",{})]})]})]})}):e.jsx("div",{className:"bg-amber-50 p-4 text-amber-800 rounded-lg text-sm",children:e.jsx("p",{children:"Datos detallados no disponibles para esta orden histórica."})})]}),e.jsxs("div",{className:`mt-6 pt-4 border-t-2 border-black ${h?"block":"hidden"}`,children:[e.jsx("h3",{className:"text-lg font-bold uppercase mb-6 text-center border-b border-black pb-2",children:"Control de Calidad en Planta"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"border-2 border-black p-4 avoid-break mb-4",children:[e.jsx("h4",{className:"font-bold uppercase bg-gray-100 border-b border-black p-2 text-sm mb-3",children:"1. Impresión (Prensa)"}),e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Operador / Turno:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Viscosidad Inicial:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})," ",e.jsx("span",{className:"w-32 font-bold ml-4",children:"Velocidad (m/min):"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Registro Color"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Tono vs Muestra"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Adherencia (Test)"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Limpieza"]})]}),e.jsx("div",{className:"border border-dashed border-gray-400 p-2 mt-2 h-16 text-gray-500",children:"Observaciones..."})]})]}),s.technicalDetails.layers.length>1&&e.jsxs("div",{className:"border-2 border-black p-4 avoid-break mb-4",children:[e.jsx("h4",{className:"font-bold uppercase bg-gray-100 border-b border-black p-2 text-sm mb-3",children:"2. Laminación / Solvente"}),e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Operador:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Gramaje (g/m²):"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})," ",e.jsx("span",{className:"w-32 font-bold ml-4",children:"Temperatura de Calandras:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Apariencia"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Ancho Adhesivo"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Tensiones"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Sin Burbujas"]})]})]})]}),e.jsxs("div",{className:"border-2 border-black p-4 avoid-break mb-4",children:[e.jsxs("h4",{className:"font-bold uppercase bg-gray-100 border-b border-black p-2 text-sm mb-3",children:["3. ",s.technicalDetails.format==="BOLSA"?"Bolsera (Confección)":"Refilado (Corte)"]}),e.jsxs("div",{className:"space-y-4 text-xs",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Operador:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsx("span",{className:"w-32 font-bold",children:"Cajas/Bobinas:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})," ",e.jsx("span",{className:"w-32 font-bold ml-4",children:"Cant. Rechazada:"})," ",e.jsx("div",{className:"border-b border-black flex-1 h-4"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Medidas OK"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," ",s.technicalDetails.format==="BOLSA"?"Resistencia de sellos":"Corte Limpio"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Aspecto visual"]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-5 h-5 border border-black mr-2"})," Embalaje"]})]})]})]}),e.jsxs("div",{className:"border-2 border-black p-4 bg-gray-50 avoid-break flex justify-between items-center",children:[e.jsxs("div",{className:"w-2/3",children:[e.jsx("h4",{className:"font-bold uppercase mb-2 text-sm",children:"Liberación Final de Calidad"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Certifico que este lote cumple con las especificaciones de la ficha técnica."})]}),e.jsxs("div",{className:"w-1/3 border-l-2 border-black pl-4 text-center",children:[e.jsx("div",{className:"h-16 border-b border-black mb-1"}),e.jsx("div",{className:"text-[10px] uppercase font-bold",children:"Firma Supervisor / Calidad"})]})]})]})]})]}),e.jsxs("div",{className:`bg-slate-50 p-4 border-t border-slate-200 flex justify-end space-x-3 ${h?"hidden":"flex"}`,children:[e.jsx("button",{onClick:C,className:"px-4 py-2 text-slate-600 hover:bg-slate-200 rounded-lg font-medium",children:"Cerrar"}),e.jsx("button",{type:"button",onClick:se,disabled:h,className:"px-4 py-2 bg-brand-600 text-white hover:bg-brand-700 rounded-lg font-medium flex items-center shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:h?e.jsxs(e.Fragment,{children:[e.jsx(Ye,{size:18,className:"mr-2 animate-spin"})," Generando PDF..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:18,className:"mr-2"})," Guardar Hoja de Ruta (PDF)"]})})]})]})})};return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Órdenes Activas"}),e.jsx("p",{className:"text-2xl font-bold text-brand-600",children:n.active})]}),e.jsx("div",{className:"bg-brand-50 p-2 rounded-full",children:e.jsx($e,{className:"text-brand-500"})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Materiales"}),e.jsx("p",{className:"text-2xl font-bold text-slate-800",children:n.materials})]}),e.jsx("div",{className:"bg-slate-50 p-2 rounded-full",children:e.jsx(fe,{className:"text-slate-500"})})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Clientes"}),e.jsx("p",{className:"text-2xl font-bold text-slate-800",children:n.clients})]}),e.jsx("div",{className:"bg-slate-50 p-2 rounded-full",children:e.jsx(Is,{className:"text-slate-500"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-full",children:[e.jsxs("div",{className:"bg-slate-100 rounded-xl p-4 h-min min-h-[500px]",children:[e.jsxs("h3",{className:"font-bold text-slate-600 mb-4 flex items-center",children:[e.jsx(Xe,{size:18,className:"mr-2"})," Pendientes",e.jsx("span",{className:"ml-2 bg-slate-200 text-slate-600 px-2 py-0.5 rounded-full text-xs",children:t.filter(s=>s.status==="Pendiente").length})]}),t.filter(s=>s.status==="Pendiente").length===0&&e.jsx("p",{className:"text-sm text-slate-400 text-center mt-10",children:"No hay órdenes pendientes"}),t.filter(s=>s.status==="Pendiente").map(s=>e.jsx(Me,{order:s,onSelect:c,onStatusChange:d,onDelete:x},s.id))]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 h-min min-h-[500px]",children:[e.jsxs("h3",{className:"font-bold text-blue-800 mb-4 flex items-center",children:[e.jsx(pe,{size:18,className:"mr-2"})," En Producción",e.jsx("span",{className:"ml-2 bg-blue-200 text-blue-800 px-2 py-0.5 rounded-full text-xs",children:t.filter(s=>s.status==="En Producción").length})]}),t.filter(s=>s.status==="En Producción").length===0&&e.jsx("p",{className:"text-sm text-blue-300 text-center mt-10",children:"Máquinas detenidas"}),t.filter(s=>s.status==="En Producción").map(s=>e.jsx(Me,{order:s,onSelect:c,onStatusChange:d,onDelete:x},s.id))]}),e.jsxs("div",{className:"bg-emerald-50 rounded-xl p-4 h-min min-h-[500px]",children:[e.jsxs("h3",{className:"font-bold text-emerald-800 mb-4 flex items-center",children:[e.jsx(ye,{size:18,className:"mr-2"})," Historial Reciente"]}),t.filter(s=>s.status==="Terminado").length===0&&e.jsx("p",{className:"text-sm text-emerald-300 text-center mt-10",children:"Sin historial"}),t.filter(s=>s.status==="Terminado").slice(0,5).map(s=>e.jsx(Me,{order:s,onSelect:c,onStatusChange:d,onDelete:x},s.id)),t.filter(s=>s.status==="Terminado").length>5&&e.jsx("div",{className:"text-center mt-4",children:e.jsx("p",{className:"text-xs text-emerald-600 italic",children:"Mostrando 5 más recientes"})})]})]}),i&&e.jsx(g,{order:i,onClose:()=>c(null)})]})},jt=()=>{const[t,a]=f.useState("dashboard");return e.jsxs("div",{className:"flex min-h-screen bg-slate-50 font-sans",children:[e.jsx(dt,{activeTab:t,setActiveTab:a}),e.jsx("main",{className:"flex-1 ml-64 p-8 overflow-y-auto h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("header",{className:"mb-8 flex justify-between items-center",children:e.jsx("h1",{className:"text-3xl font-bold text-slate-800 capitalize",children:t==="settings"?"Configuración":t==="queue"?"Programación":t.replace("-"," ")})}),t==="dashboard"&&e.jsx(gt,{}),t==="queue"&&e.jsx(pt,{}),t==="calculator"&&e.jsx(mt,{}),t==="products"&&e.jsx(xt,{}),t==="materials"&&e.jsx(ut,{}),t==="suppliers"&&e.jsx(bt,{}),t==="clients"&&e.jsx(ht,{}),t==="settings"&&e.jsx(ft,{})]})})]})},as=document.getElementById("root");if(!as)throw new Error("Could not find root element to mount to");const Nt=ze.createRoot(as);Nt.render(e.jsx(ds.StrictMode,{children:e.jsx(jt,{})}));
